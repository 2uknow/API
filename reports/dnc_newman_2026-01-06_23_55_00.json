{
  "collection": {
    "_": {
      "postman_id": "ad14dfb9-75d7-4a97-85bf-8665f83ae3c1",
      "exporter_id": "24140936",
      "collection_link": "https://red-escape-704404.postman.co/workspace/Team-Workspace~a1f4d6b2-7a17-4360-8a8d-46313f959e2b/collection/24140936-ad14dfb9-75d7-4a97-85bf-8665f83ae3c1?action=share&source=collection_link&creator=24140936"
    },
    "item": [
      {
        "id": "c247f49c-48d0-41be-9c84-4f41ae3064fa",
        "name": "CP 및 정기결제 요청 전송",
        "item": [
          {
            "id": "2b39483c-3bde-4db6-8fd0-dc4df3260482",
            "name": "READY - BATCH",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/x-www-form-urlencoded; charset=UTF-8"
                }
              ],
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "1fac9792-ac4b-475d-918c-72dca168f7d4",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "// 파싱 및 개별 디코딩\r",
                    "const parsed = parseQueryString(result);\r",
                    "const startUrlDecoded = safeDecodeURIComponent(parsed.STARTURL);\r",
                    "console.log(\"STARTURL(디코딩):\", startUrlDecoded);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메시지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"정기결제 초기인증 표준페이지 시작 URL(STARTURL) 정상출력\", function () {\r",
                    "    pm.expect(startUrlDecoded).to.eql(\"https://checkout.teledit.com/creditcard_recurring/web\")\r",
                    "})\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "});\r",
                    "\r",
                    "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"위 표준페이지 시작 URL 전송 파라미터(STARTPARAMS) 정상출력\", function () {\r",
                    "    pm.expect(parsed.STARTPARAMS).to.not.be.undefined;\r",
                    "    pm.expect(parsed.STARTPARAMS).to.not.be.empty;\r",
                    "    pm.expect(parsed.STARTPARAMS).to.not.be.null;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"결제금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "c648994c-1d33-4aa2-a8b2-b7328549c9a6"
                }
              },
              {
                "listen": "prerequest",
                "script": {
                  "id": "2083bfb5-da14-458c-a230-3ba3dfd53411",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    ITEMNAME: 'apiautotest',\r",
                    "    AMOUNT: '301',\r",
                    "    CURRENCY: '410',\r",
                    "    USERID: 'hnkim',\r",
                    "    USERAGENT: 'PC',\r",
                    "    TXTYPE: 'AUTH',\r",
                    "    SERVICETYPE: 'BATCH',\r",
                    "    CANCELURL: 'https://paytest.teledit.com:888/clientdemo/oneapi/returnFail.php',\r",
                    "    RETURNURL: 'https://paytest.teledit.com:888/clientdemo/oneapi/returnFail.php',\r",
                    "    ISBILL: 'Y',\r",
                    "    ISNOTI: 'N'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "604e4df0-72c7-40bc-ba15-860d0f1eec44"
                }
              }
            ]
          },
          {
            "id": "9039e9be-4170-4443-8654-568d0b427cd3",
            "name": "READY - DANALCARD",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/x-www-form-urlencoded; charset=UTF-8"
                }
              ],
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "dada1b29-076d-4030-b81d-ce353f0c421b",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "// 파싱 및 개별 디코딩\r",
                    "const parsed = parseQueryString(result);\r",
                    "const startUrlDecoded = safeDecodeURIComponent(parsed.STARTURL);\r",
                    "console.log(\"STARTURL(디코딩):\", startUrlDecoded);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메시지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"정기결제 초기인증 표준페이지 시작 URL(STARTURL) 정상출력\", function () {\r",
                    "    pm.expect(startUrlDecoded).to.eql(\"https://checkout.teledit.com/creditcard_std/web\")\r",
                    "})\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "});\r",
                    "\r",
                    "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"위 표준페이지 시작 URL 전송 파라미터(STARTPARAMS) 정상출력\", function () {\r",
                    "    pm.expect(parsed.STARTPARAMS).to.not.be.undefined;\r",
                    "    pm.expect(parsed.STARTPARAMS).to.not.be.empty;\r",
                    "    pm.expect(parsed.STARTPARAMS).to.not.be.null;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"결제금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "0b3e886b-f035-4003-bcbb-c834d30e6533"
                }
              },
              {
                "listen": "prerequest",
                "script": {
                  "id": "af79d22c-6be4-431c-b50f-b50d9bcb534a",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    ITEMNAME: 'apiautotest',\r",
                    "    AMOUNT: '301',\r",
                    "    CURRENCY: '410',\r",
                    "    USERID: 'hnkim',\r",
                    "    USERAGENT: 'PC',\r",
                    "    TXTYPE: 'AUTH',\r",
                    "    SERVICETYPE: 'DANALCARD',\r",
                    "    CANCELURL: 'https://paytest.teledit.com:888/clientdemo/oneapi/returnFail.php',\r",
                    "    RETURNURL: 'https://paytest.teledit.com:888/clientdemo/oneapi/returnFail.php',\r",
                    "    ISBILL: 'Y',\r",
                    "    ISNOTI: 'N'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "d7b59cfb-3cbd-45c6-8935-5d20cf7bcc89"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "4c51de37-e718-4ce4-bbbe-b79495cfa0a9",
        "name": "초기 인증 결제 요청",
        "item": [
          {
            "id": "4c04b8f7-7b16-4497-9192-a956028afa1a",
            "name": "ISSUEBILLKEY",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/x-www-form-urlencoded; charset=UTF-8"
                }
              ],
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "c3079f94-338d-475b-8698-1b78cc1491fd",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    AMOUNT: '301',\r",
                    "    TID: pm.environment.get('TID'),\r",
                    "    TXTYPE: 'ISSUEBILLKEY',\r",
                    "    SERVICETYPE: 'BATCH'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "c7cc3e75-1d72-456b-9e24-755be8cf6fb9"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "63736d6d-9b85-449f-a80a-bef51b6fd267",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "// 파싱 및 개별 디코딩\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) : 1104 출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"1104\")\r",
                    "});\r",
                    "\r",
                    "// \"존재하지 않는 거래 입니다.\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) : 존재하지 않는 거래입니다. 출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%C1%B8%C0%E7%C7%CF%C1%F6+%BE%CA%B4%C2+%B0%C5%B7%A1+%C0%D4%B4%CF%B4%D9.\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "92f59cf5-8df2-43a6-934a-b771404c769e"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "9c531685-0a4a-4af8-b1fc-6120bb95e515",
        "name": "삼성카드",
        "item": [
          {
            "id": "210f1ae8-b449-4b46-9320-a25e2861cd04",
            "name": "정기결제 요청 (OTBILL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/x-www-form-urlencoded; charset=UTF-8"
                }
              ],
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "bd8cc440-a031-4b3e-80b5-cf3c8f06d3f7",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    ITEMNAME: 'apiautotest',\r",
                    "    AMOUNT: '301',\r",
                    "    CURRENCY: '410',\r",
                    "    USERID: 'hnkim',\r",
                    "    USERAGENT: 'ONLINE',\r",
                    "    TXTYPE: 'OTBILL',\r",
                    "    SERVICETYPE: 'BATCH',\r",
                    "    ISREBILL: 'Y',\r",
                    "    BILLINFO: 'DC250730151749FFCAA0',\r",
                    "    USERNAME: '김하늘',\r",
                    "    USERPHONE: '01085402697',\r",
                    "    ORDERID: '01234567'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "f87b8ce4-4477-423d-a221-297014e9b202"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "30821a64-995d-4248-acd9-930d4b9d4059",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDCODE).to.eql(\"0500\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.USERPHONE).to.eql(\"01085402697\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                    "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                    "  // 현재 시간 선언\r",
                    "  const now = new Date();\r",
                    "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                    "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                    "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                    "  const t = parsed.TRANTIME;\r",
                    "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                    "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                    "\r",
                    "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                    "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TRANTIME 저장\r",
                    "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TID 저장\r",
                    "pm.environment.set(\"TID\", parsed.TID);\r",
                    "\r",
                    "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.ORDERID).to.eql(\"01234567\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNO).to.eql(\"512028******7294\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                    "});\r",
                    "\r",
                    "// \"삼성카드\" 검증\r",
                    "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNAME).to.eql(\"%BB%EF%BC%BA%C4%AB%B5%E5\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERNAME).to.eql(\"%EA%B9%3F%3F%3F%3F%3F\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "62831437-484c-41aa-86d8-48760a35caab"
                }
              }
            ]
          },
          {
            "id": "3887b742-e516-4009-998f-c93a2787dc41",
            "name": "카드 승인 취소 (BILLCANCEL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "137db39f-e41c-41de-9c0c-484a6e24d711",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                    "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "// 매출 발생시간과 비교 검증\r",
                    "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                    "});\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "a8db36f1-6efb-404b-8459-ab8f110ffbf7"
                }
              },
              {
                "listen": "prerequest",
                "script": {
                  "id": "a751a53a-08db-4a45-9f35-6d0741a234da",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    AMOUNT: '301',\r",
                    "    TID: pm.environment.get(\"TID\"),\r",
                    "    CANCELTYPE: 'C',\r",
                    "    TXTYPE: 'CANCEL',\r",
                    "    SERVICETYPE: 'DANALCARD'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "62f798ca-6e98-4e37-bbe9-cd1a2894f4df"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "cc6fd918-ccc9-4ae9-905e-bc609a3946fc",
        "name": "현대카드",
        "item": [
          {
            "id": "f924bf79-05b5-4d1c-8627-14c0c421d7bb",
            "name": "정기결제 요청 (OTBILL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "b5f56f70-e987-4ae9-b22a-d7f6b4a6fdb6",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    ITEMNAME: 'apiautotest',\r",
                    "    AMOUNT: '301',\r",
                    "    CURRENCY: '410',\r",
                    "    USERID: 'hnkim',\r",
                    "    USERAGENT: 'ONLINE',\r",
                    "    TXTYPE: 'OTBILL',\r",
                    "    SERVICETYPE: 'BATCH',\r",
                    "    ISREBILL: 'Y',\r",
                    "    BILLINFO: 'DC221222165535557F38'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "a41ee836-028a-4b14-96b4-c8700fb53498"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "7382d275-0c13-4598-b629-a22a37111fea",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDCODE).to.eql(\"0400\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                    "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                    "  // 현재 시간 선언\r",
                    "  const now = new Date();\r",
                    "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                    "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                    "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                    "  const t = parsed.TRANTIME;\r",
                    "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                    "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                    "\r",
                    "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                    "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TRANTIME 저장\r",
                    "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TID 저장\r",
                    "pm.environment.set(\"TID\", parsed.TID);\r",
                    "\r",
                    "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNO).to.eql(\"403293******4003\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                    "});\r",
                    "\r",
                    "// \"현대카드\" 검증\r",
                    "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNAME).to.eql(\"%C7%F6%B4%EB%C4%AB%B5%E5\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                    "})\r",
                    "\r",
                    "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "c958f7dc-67d5-41d5-a883-5b8dec698d97"
                }
              }
            ]
          },
          {
            "id": "73039d21-1d98-47e9-a6e5-f242b914b1b3",
            "name": "카드 승인 취소 (BILLCANCEL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "c91a86ff-4b46-43bb-bd50-8c32f196dc12",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    AMOUNT: '301',\r",
                    "    TID: pm.environment.get(\"TID\"),\r",
                    "    CANCELTYPE: 'C',\r",
                    "    TXTYPE: 'CANCEL',\r",
                    "    SERVICETYPE: 'DANALCARD'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "7c4231e8-6666-4f04-8c64-59c065726abc"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "ce7f762c-34d1-4581-bbdb-5ea23e153340",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                    "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "// 매출 발생시간과 비교 검증\r",
                    "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                    "});\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "6f2cd4d0-7752-4948-a963-6bcdfca630e4"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "8a506aa8-d479-492b-9315-2643d6418550",
        "name": "신한카드",
        "item": [
          {
            "id": "255608f1-1a42-451b-873e-dd5cea8a59f5",
            "name": "정기결제 요청 (OTBILL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "97fe69bc-f4ae-4ab1-a07d-372093885524",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    ITEMNAME: 'apiautotest',\r",
                    "    AMOUNT: '301',\r",
                    "    CURRENCY: '410',\r",
                    "    USERID: 'hnkim',\r",
                    "    USERAGENT: 'ONLINE',\r",
                    "    TXTYPE: 'OTBILL',\r",
                    "    SERVICETYPE: 'BATCH',\r",
                    "    ISREBILL: 'Y',\r",
                    "    BILLINFO: 'DC2507311547242F2CD0'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "f324bca2-550b-483e-8ffe-70ec3c9016bc"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "f64ceeab-436b-4068-9fa4-b83eb642df45",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDCODE).to.eql(\"0100\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                    "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                    "  // 현재 시간 선언\r",
                    "  const now = new Date();\r",
                    "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                    "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                    "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                    "  const t = parsed.TRANTIME;\r",
                    "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                    "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                    "\r",
                    "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                    "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TRANTIME 저장\r",
                    "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TID 저장\r",
                    "pm.environment.set(\"TID\", parsed.TID);\r",
                    "\r",
                    "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNO).to.eql(\"451842******5446\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                    "});\r",
                    "\r",
                    "// \"신한카드\" 검증\r",
                    "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNAME).to.eql(\"%BD%C5%C7%D1%C4%AB%B5%E5\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "e2326c79-0952-4962-808f-03568fcba329"
                }
              }
            ]
          },
          {
            "id": "c99464ba-79a9-4a3b-a15e-f8992ec51686",
            "name": "카드 승인 취소 (BILLCANCEL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "0bd8a104-ffee-43e7-bd31-3894530a5329",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    AMOUNT: '301',\r",
                    "    TID: pm.environment.get(\"TID\"),\r",
                    "    CANCELTYPE: 'C',\r",
                    "    TXTYPE: 'CANCEL',\r",
                    "    SERVICETYPE: 'DANALCARD'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "4d25daee-ba92-4676-a13f-d02df817f855"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "e1665029-2944-4786-bbc4-0fbe31f00a45",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                    "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "// 매출 발생시간과 비교 검증\r",
                    "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                    "});\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "772d9a38-f4ac-4df2-92ba-b672293b48e4"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "8594c56a-e8ea-43ae-b788-aef5c1f29385",
        "name": "농협카드",
        "item": [
          {
            "id": "1df155f2-1f5d-4f5f-92b6-ec9e5c1d50d3",
            "name": "정기결제 요청 (OTBILL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "de465096-5021-4a0b-9a56-1d3551cbac47",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    ITEMNAME: 'apiautotest',\r",
                    "    AMOUNT: '301',\r",
                    "    CURRENCY: '410',\r",
                    "    USERID: 'hnkim',\r",
                    "    USERAGENT: 'ONLINE',\r",
                    "    TXTYPE: 'OTBILL',\r",
                    "    SERVICETYPE: 'BATCH',\r",
                    "    ISREBILL: 'Y',\r",
                    "    BILLINFO: 'DC2512151528144A426D'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "d15fba87-9fd5-44cc-a150-c1ba44e68fd1"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "33ee4b20-3a48-419d-9bd0-145fba7dfaae",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDCODE).to.eql(\"0800\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                    "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                    "  // 현재 시간 선언\r",
                    "  const now = new Date();\r",
                    "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                    "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                    "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                    "  const t = parsed.TRANTIME;\r",
                    "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                    "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                    "\r",
                    "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                    "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TRANTIME 저장\r",
                    "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TID 저장\r",
                    "pm.environment.set(\"TID\", parsed.TID);\r",
                    "\r",
                    "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNO).to.eql(\"542586******3820\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                    "});\r",
                    "// \"NH농협카드\" 검증\r",
                    "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNAME).to.eql(\"NH%B3%F3%C7%F9%C4%AB%B5%E5\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "fa7e3dd7-25af-4b33-9b7e-9716713487be"
                }
              }
            ]
          },
          {
            "id": "ceb3098d-3291-4f29-9d1b-b75fc73f1939",
            "name": "카드 승인 취소 (BILLCANCEL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "60e62c37-57d7-4d9c-a837-fdfcd6f1361b",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    AMOUNT: '301',\r",
                    "    TID: pm.environment.get(\"TID\"),\r",
                    "    CANCELTYPE: 'C',\r",
                    "    TXTYPE: 'CANCEL',\r",
                    "    SERVICETYPE: 'DANALCARD'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "8852a17a-c67a-421d-97f4-525ac1291178"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "1d556d7e-e431-4211-b0e9-91f44561adb8",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                    "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "// 매출 발생시간과 비교 검증\r",
                    "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                    "});\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "7b4ba37c-5e11-4922-bacd-85a139200012"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "b5095b1a-3e40-427c-9dbe-3542fc8a03ea",
        "name": "국민카드",
        "item": [
          {
            "id": "fd2dcf9f-af25-465a-9df4-073847ddf2e7",
            "name": "정기결제 요청 (OTBILL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "ebdb6682-d35a-4007-8ef8-03b5fbbf564d",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    ITEMNAME: 'apiautotest',\r",
                    "    AMOUNT: '301',\r",
                    "    CURRENCY: '410',\r",
                    "    USERID: 'hnkim',\r",
                    "    USERAGENT: 'ONLINE',\r",
                    "    TXTYPE: 'OTBILL',\r",
                    "    SERVICETYPE: 'BATCH',\r",
                    "    ISREBILL: 'Y',\r",
                    "    BILLINFO: 'DC250804165745DBD04E'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "228dd815-eedf-4bfd-9eab-36a22f5574ca"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "d7c458db-7b60-4474-9f72-e08985004e52",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDCODE).to.eql(\"0300\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                    "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                    "  // 현재 시간 선언\r",
                    "  const now = new Date();\r",
                    "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                    "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                    "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                    "  const t = parsed.TRANTIME;\r",
                    "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                    "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                    "\r",
                    "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                    "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TRANTIME 저장\r",
                    "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TID 저장\r",
                    "pm.environment.set(\"TID\", parsed.TID);\r",
                    "\r",
                    "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNO).to.eql(\"540926******6041\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                    "});\r",
                    "\r",
                    "// \"국민카드\" 검증\r",
                    "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNAME).to.eql(\"KB%B1%B9%B9%CE%C4%AB%B5%E5\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "590599e2-cdc0-4ce6-b5aa-fb5e81acad4b"
                }
              }
            ]
          },
          {
            "id": "72f04035-28a5-4c1f-8bc3-2d8250163890",
            "name": "카드 승인 취소 (BILLCANCEL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "a1a0489c-9745-4aad-85c3-55c3ff2283a2",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    AMOUNT: '301',\r",
                    "    TID: pm.environment.get(\"TID\"),\r",
                    "    CANCELTYPE: 'C',\r",
                    "    TXTYPE: 'CANCEL',\r",
                    "    SERVICETYPE: 'DANALCARD'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "86d5935c-eaf7-4f32-b45e-6a9b21b6493e"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "2681b930-c73f-414b-9204-7370ac359985",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                    "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "// 매출 발생시간과 비교 검증\r",
                    "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                    "});\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "7adcd1e6-fd99-4189-8e5a-46f702831840"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
        "name": "우리BC카드",
        "item": [
          {
            "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
            "name": "정기결제 요청 (OTBILL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    ITEMNAME: 'apiautotest',\r",
                    "    AMOUNT: '301',\r",
                    "    CURRENCY: '410',\r",
                    "    USERID: 'hnkim',\r",
                    "    USERAGENT: 'ONLINE',\r",
                    "    TXTYPE: 'OTBILL',\r",
                    "    SERVICETYPE: 'BATCH',\r",
                    "    ISREBILL: 'Y',\r",
                    "    BILLINFO: 'DC25080416595836B04B'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                    "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                    "  // 현재 시간 선언\r",
                    "  const now = new Date();\r",
                    "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                    "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                    "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                    "  const t = parsed.TRANTIME;\r",
                    "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                    "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                    "\r",
                    "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                    "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TRANTIME 저장\r",
                    "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TID 저장\r",
                    "pm.environment.set(\"TID\", parsed.TID);\r",
                    "\r",
                    "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                    "});\r",
                    "\r",
                    "// \"삼성카드\" 검증\r",
                    "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                }
              }
            ]
          },
          {
            "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
            "name": "카드 승인 취소 (BILLCANCEL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    AMOUNT: '301',\r",
                    "    TID: pm.environment.get(\"TID\"),\r",
                    "    CANCELTYPE: 'C',\r",
                    "    TXTYPE: 'CANCEL',\r",
                    "    SERVICETYPE: 'DANALCARD'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                    "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "// 매출 발생시간과 비교 검증\r",
                    "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                    "});\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "e4d520d6-c9ef-44fa-b691-d4fa9cf4015d",
        "name": "우리독자카드",
        "item": [
          {
            "id": "fdce8072-d7d0-4a32-9c82-e7db14f56287",
            "name": "정기결제 요청 (OTBILL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "c1519496-0a1b-4576-a02f-b0e258e4f4ef",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    ITEMNAME: 'apiautotest',\r",
                    "    AMOUNT: '301',\r",
                    "    CURRENCY: '410',\r",
                    "    USERID: 'hnkim',\r",
                    "    USERAGENT: 'ONLINE',\r",
                    "    TXTYPE: 'OTBILL',\r",
                    "    SERVICETYPE: 'BATCH',\r",
                    "    ISREBILL: 'Y',\r",
                    "    BILLINFO: 'DC251215145003CEDD72'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "afa23430-048b-4c91-974c-d32e1d631e1e"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "28aae2d8-4337-49f7-8c50-bfa635db450f",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDCODE).to.eql(\"0907\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                    "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                    "  // 현재 시간 선언\r",
                    "  const now = new Date();\r",
                    "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                    "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                    "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                    "  const t = parsed.TRANTIME;\r",
                    "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                    "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                    "\r",
                    "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                    "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TRANTIME 저장\r",
                    "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TID 저장\r",
                    "pm.environment.set(\"TID\", parsed.TID);\r",
                    "\r",
                    "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNO).to.eql(\"624404******8380\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                    "});\r",
                    "\r",
                    "// \"롯데카드\" 검증\r",
                    "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AE%C4%AB%B5%E5\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "4051c384-dbc4-442a-b26c-5c7d50b3cdbd"
                }
              }
            ]
          },
          {
            "id": "eb18c1f3-8027-4d97-8b56-63cd51106c3f",
            "name": "카드 승인 취소 (BILLCANCEL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "2ce0446a-bd2a-48cb-8cda-95a7bc50ff23",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    AMOUNT: '301',\r",
                    "    TID: pm.environment.get(\"TID\"),\r",
                    "    CANCELTYPE: 'C',\r",
                    "    TXTYPE: 'CANCEL',\r",
                    "    SERVICETYPE: 'DANALCARD'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "967a321c-207e-433d-a9b0-5a7a74e58a50"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "bf94c695-8ea4-46ec-b2bf-17fff95e9b67",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                    "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "// 매출 발생시간과 비교 검증\r",
                    "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                    "});\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "c2b6adb9-0c0d-4f44-8ca2-95ffeabdffec"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "018030ec-d8ad-4415-a337-6b0a225cc4c6",
        "name": "Kbank카드",
        "item": [
          {
            "id": "dc9f9937-00de-4540-b447-2dbfc52dc976",
            "name": "정기결제 요청 (OTBILL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "de0ade1e-9508-4069-a64c-9d2c2b6b68c9",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    ITEMNAME: 'apiautotest',\r",
                    "    AMOUNT: '301',\r",
                    "    CURRENCY: '410',\r",
                    "    USERID: 'hnkim',\r",
                    "    USERAGENT: 'ONLINE',\r",
                    "    TXTYPE: 'OTBILL',\r",
                    "    SERVICETYPE: 'BATCH',\r",
                    "    ISREBILL: 'Y',\r",
                    "    BILLINFO: 'DC25121515231344D775'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "145b5742-9ea9-4c92-80b5-dbfff2f9616d"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "b17031d0-5d0e-45fb-b0d7-0f715860ec04",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDCODE).to.eql(\"0921\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                    "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                    "  // 현재 시간 선언\r",
                    "  const now = new Date();\r",
                    "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                    "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                    "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                    "  const t = parsed.TRANTIME;\r",
                    "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                    "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                    "\r",
                    "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                    "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TRANTIME 저장\r",
                    "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TID 저장\r",
                    "pm.environment.set(\"TID\", parsed.TID);\r",
                    "\r",
                    "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNO).to.eql(\"485462******0767\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                    "});\r",
                    "\r",
                    "// \"삼성카드\" 검증\r",
                    "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNAME).to.eql(\"%C4%C9%C0%CC%B9%F0%C5%A9%C4%AB%B5%E5\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "b2ef3b55-65ca-4fa4-839d-4afb298decd6"
                }
              }
            ]
          },
          {
            "id": "d4a0107d-8d2a-4e04-b627-fad65ea23b0a",
            "name": "카드 승인 취소 (BILLCANCEL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "9e064d58-d2ab-4f80-9fd8-d154fc61e281",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    AMOUNT: '301',\r",
                    "    TID: pm.environment.get(\"TID\"),\r",
                    "    CANCELTYPE: 'C',\r",
                    "    TXTYPE: 'CANCEL',\r",
                    "    SERVICETYPE: 'DANALCARD'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "ccf81d91-716e-4aad-8932-cdc13d3587e7"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "96208ba8-439c-4017-966d-546d8704962a",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                    "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "// 매출 발생시간과 비교 검증\r",
                    "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                    "});\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "6eb2f005-3ede-423d-b3cf-c3aeb2b4d225"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "7eba991b-3d86-4bc6-ba6c-f5a2d722cbc9",
        "name": "롯데카드",
        "item": [
          {
            "id": "600fc975-e106-4be8-8c9c-1abe776705c7",
            "name": "정기결제 요청 (OTBILL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "b8e44806-4fc9-43e8-a08a-d42e00d0041a",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    ITEMNAME: 'apiautotest',\r",
                    "    AMOUNT: '301',\r",
                    "    CURRENCY: '410',\r",
                    "    USERID: 'hnkim',\r",
                    "    USERAGENT: 'ONLINE',\r",
                    "    TXTYPE: 'OTBILL',\r",
                    "    SERVICETYPE: 'BATCH',\r",
                    "    ISREBILL: 'Y',\r",
                    "    BILLINFO: 'DC2512151453119224E3'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "27343864-c219-4e1f-9c4b-262bdfbbdeea"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "18d9da3a-d705-4913-a0ed-154c858a2972",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDCODE).to.eql(\"0700\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                    "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                    "  // 현재 시간 선언\r",
                    "  const now = new Date();\r",
                    "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                    "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                    "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                    "  const t = parsed.TRANTIME;\r",
                    "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                    "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                    "\r",
                    "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                    "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TRANTIME 저장\r",
                    "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TID 저장\r",
                    "pm.environment.set(\"TID\", parsed.TID);\r",
                    "\r",
                    "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNO).to.eql(\"513792******3380\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                    "});\r",
                    "\r",
                    "// \"롯데카드\" 검증\r",
                    "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNAME).to.eql(\"%B7%D4%B5%A5%C4%AB%B5%E5\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "bebae3e1-c957-4966-a200-083ef93a2862"
                }
              }
            ]
          },
          {
            "id": "2f29d6cd-a7af-4456-9eca-993414d84b4f",
            "name": "카드 승인 취소 (BILLCANCEL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "8f5aacad-52f0-49aa-bf17-3ed4f3f4adf6",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    AMOUNT: '301',\r",
                    "    TID: pm.environment.get(\"TID\"),\r",
                    "    CANCELTYPE: 'C',\r",
                    "    TXTYPE: 'CANCEL',\r",
                    "    SERVICETYPE: 'DANALCARD'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "6672df75-398d-4dbb-b2d0-7841874afcec"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "bdc31cd0-689a-4fc4-b23f-de399a2f30e5",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                    "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "// 매출 발생시간과 비교 검증\r",
                    "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                    "});\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "514b7379-e6c3-4c41-a0b7-26124fe1d943"
                }
              }
            ]
          }
        ],
        "event": []
      }
    ],
    "event": [],
    "variable": [],
    "info": {
      "_postman_id": "ad14dfb9-75d7-4a97-85bf-8665f83ae3c1",
      "name": "Danal_CreditRebill_v1.0",
      "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
    }
  },
  "environment": {
    "_": {
      "postman_variable_scope": "environment",
      "postman_exported_at": "2025-08-18T05:02:37.387Z",
      "postman_exported_using": "Postman/11.58.5"
    },
    "id": "6094ec42-451a-414a-8cd4-1d771ed4e797",
    "name": "Danal_CreditRebill_v1.0",
    "values": [
      {
        "type": "any",
        "value": "https://tx-creditcard.danalpay.com/credit/",
        "key": "tx-credit"
      },
      {
        "type": "any",
        "value": "8kvDIwvdID7NWcBMND4uDR%2BQxCiuep3i78rRqQAAoRmVkwrAWNRM%2BBk5ZR7A09pOnARoU2UEPJDoq1UO%2BXO8Ia6PG1mCMkSpRnvG5SeHMxw1J515p1Fb7Zr1DdNC76cF",
        "key": "encryptedData"
      },
      {
        "type": "any",
        "value": "RETURNCODE=0000&RETURNMSG=%BC%BA%B0%F8&BALANCE=0&O_TID=202601062355283582654400&TID=202601062355297742674400&TRANTIME=235529&TRANDATE=20260106&AMOUNT=301&DEPOSIT_AMT=0",
        "key": "decryptedResponse"
      },
      {
        "type": "any",
        "value": "",
        "key": "startUrlDecoded"
      },
      {
        "type": "any",
        "value": "202601062355283582654400",
        "key": "TID"
      },
      {
        "type": "any",
        "value": "",
        "key": "TRANDATE"
      },
      {
        "type": "any",
        "value": "235529",
        "key": "TRANTIME"
      }
    ]
  },
  "globals": {
    "id": "f0617853-4db7-46e5-8a20-02a0e86c3db8",
    "values": []
  },
  "run": {
    "stats": {
      "iterations": {
        "total": 1,
        "pending": 0,
        "failed": 0
      },
      "items": {
        "total": 21,
        "pending": 0,
        "failed": 0
      },
      "scripts": {
        "total": 42,
        "pending": 0,
        "failed": 0
      },
      "prerequests": {
        "total": 21,
        "pending": 0,
        "failed": 0
      },
      "requests": {
        "total": 21,
        "pending": 0,
        "failed": 0
      },
      "tests": {
        "total": 21,
        "pending": 0,
        "failed": 0
      },
      "assertions": {
        "total": 250,
        "pending": 0,
        "failed": 25
      },
      "testScripts": {
        "total": 21,
        "pending": 0,
        "failed": 0
      },
      "prerequestScripts": {
        "total": 21,
        "pending": 0,
        "failed": 0
      }
    },
    "timings": {
      "responseAverage": 1144.5238095238096,
      "responseMin": 23,
      "responseMax": 1601,
      "responseSd": 519.8325388822112,
      "dnsAverage": 36.06299999728799,
      "dnsMin": 36.06299999728799,
      "dnsMax": 36.06299999728799,
      "dnsSd": 0,
      "firstByteAverage": 1139.9816857143528,
      "firstByteMin": 21.564899999648333,
      "firstByteMax": 1599.4781999997795,
      "firstByteSd": 526.4485960520458,
      "started": 1767711303024,
      "completed": 1767711330472
    },
    "executions": [
      {
        "cursor": {
          "position": 0,
          "iteration": 0,
          "length": 21,
          "cycles": 1,
          "empty": false,
          "eof": false,
          "bof": true,
          "cr": false,
          "ref": "f674f6b5-2e44-4939-ba6e-b3e4197a8736",
          "httpRequestId": "4ef94b00-819f-46e6-8884-6b4520f4559d"
        },
        "item": {
          "id": "2b39483c-3bde-4db6-8fd0-dc4df3260482",
          "name": "READY - BATCH",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded; charset=UTF-8"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "1fac9792-ac4b-475d-918c-72dca168f7d4",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "// 파싱 및 개별 디코딩\r",
                  "const parsed = parseQueryString(result);\r",
                  "const startUrlDecoded = safeDecodeURIComponent(parsed.STARTURL);\r",
                  "console.log(\"STARTURL(디코딩):\", startUrlDecoded);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메시지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"정기결제 초기인증 표준페이지 시작 URL(STARTURL) 정상출력\", function () {\r",
                  "    pm.expect(startUrlDecoded).to.eql(\"https://checkout.teledit.com/creditcard_recurring/web\")\r",
                  "})\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"위 표준페이지 시작 URL 전송 파라미터(STARTPARAMS) 정상출력\", function () {\r",
                  "    pm.expect(parsed.STARTPARAMS).to.not.be.undefined;\r",
                  "    pm.expect(parsed.STARTPARAMS).to.not.be.empty;\r",
                  "    pm.expect(parsed.STARTPARAMS).to.not.be.null;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"결제금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});"
                ],
                "_lastExecutionId": "c648994c-1d33-4aa2-a8b2-b7328549c9a6"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "2083bfb5-da14-458c-a230-3ba3dfd53411",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'PC',\r",
                  "    TXTYPE: 'AUTH',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    CANCELURL: 'https://paytest.teledit.com:888/clientdemo/oneapi/returnFail.php',\r",
                  "    RETURNURL: 'https://paytest.teledit.com:888/clientdemo/oneapi/returnFail.php',\r",
                  "    ISBILL: 'Y',\r",
                  "    ISNOTI: 'N'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "604e4df0-72c7-40bc-ba15-860d0f1eec44"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "wcpoTy27mkzR%2FoCmuhu%2BEL1VevUN6wQgs96fAg0NJdKChw9Ccm7hXXJcj%2FUGj%2Bb8z5dq8TvydwIj3RXPjUXi4PJAgyNbIM2hLz3kcfuDNAuCqSPVhBCpg6V8SYW3jJ%2FZIfE36F%2BlYYpMSgxO77gr%2BDwLH0n%2BtJG7ZAyj6rsqbDI3wCKhX4bzlTMTVKd8c%2BGAYmpCZ3i8%2BtXuuBm6g2NRznUDXGC09xQFVhQa4p6tQyOn5eKksesgLSgIMzKa6kDqC5%2BLzMcAl8IF7qCGgIqWAazfqDqnE0a5U%2BZ8p2HIn%2FENLsoKdJRXIlRiPnCOj5yDVfIQWasCSQLbccOu1NheelnZWQGZ5rGm%2FTC5F8i9Vs5%2BjHsIKtlMOIqeb%2BdxblE4thUJb9NDu3NPdadnhpnr9g%3D%3D"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "Content-Type",
              "value": "application/x-www-form-urlencoded; charset=UTF-8"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "de185f49-ff26-4da1-a32d-2e51f8fb6b5f",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "e85adb1d-33b2-42c6-8c5a-a432a107be9b",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Set-Cookie",
              "value": "SCOUTER=z2n8upl40jfhop; Expires=Sun, 24-Jan-2094 18:09:10 GMT; Path=/"
            },
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "791"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 14:55:03 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              85,
              80,
              100,
              37,
              50,
              66,
              75,
              48,
              72,
              110,
              79,
              120,
              87,
              84,
              105,
              75,
              82,
              70,
              102,
              111,
              72,
              107,
              98,
              104,
              52,
              52,
              88,
              117,
              70,
              111,
              37,
              50,
              70,
              49,
              89,
              70,
              101,
              52,
              51,
              115,
              114,
              82,
              81,
              52,
              79,
              74,
              79,
              120,
              104,
              76,
              115,
              57,
              53,
              86,
              65,
              114,
              97,
              53,
              115,
              37,
              50,
              70,
              86,
              83,
              76,
              107,
              122,
              50,
              101,
              99,
              73,
              53,
              113,
              81,
              80,
              49,
              74,
              68,
              55,
              70,
              105,
              68,
              56,
              48,
              56,
              115,
              55,
              72,
              105,
              80,
              100,
              52,
              55,
              88,
              107,
              74,
              49,
              78,
              110,
              116,
              73,
              71,
              72,
              71,
              55,
              122,
              115,
              99,
              119,
              57,
              120,
              106,
              37,
              50,
              66,
              90,
              102,
              68,
              37,
              50,
              66,
              117,
              75,
              49,
              105,
              54,
              112,
              85,
              75,
              84,
              90,
              102,
              70,
              119,
              71,
              37,
              50,
              70,
              66,
              101,
              37,
              50,
              66,
              79,
              114,
              88,
              69,
              78,
              85,
              120,
              118,
              121,
              50,
              85,
              76,
              81,
              83,
              104,
              112,
              118,
              115,
              83,
              103,
              113,
              90,
              105,
              111,
              65,
              101,
              67,
              48,
              102,
              70,
              75,
              98,
              113,
              120,
              66,
              122,
              49,
              56,
              69,
              88,
              112,
              102,
              109,
              78,
              48,
              82,
              108,
              73,
              98,
              119,
              105,
              87,
              114,
              73,
              87,
              67,
              106,
              120,
              105,
              72,
              103,
              49,
              49,
              120,
              87,
              78,
              120,
              99,
              120,
              105,
              51,
              82,
              66,
              105,
              120,
              37,
              50,
              70,
              67,
              71,
              37,
              50,
              66,
              117,
              90,
              76,
              98,
              73,
              110,
              37,
              50,
              70,
              70,
              101,
              111,
              80,
              54,
              119,
              101,
              121,
              109,
              104,
              80,
              72,
              107,
              78,
              121,
              37,
              50,
              70,
              53,
              101,
              98,
              87,
              75,
              118,
              79,
              78,
              85,
              118,
              113,
              80,
              78,
              67,
              120,
              116,
              81,
              87,
              66,
              72,
              102,
              113,
              87,
              90,
              100,
              72,
              83,
              54,
              72,
              78,
              120,
              119,
              50,
              75,
              69,
              75,
              107,
              80,
              114,
              65,
              55,
              74,
              119,
              121,
              120,
              37,
              50,
              70,
              102,
              102,
              116,
              80,
              102,
              81,
              87,
              99,
              78,
              74,
              89,
              88,
              50,
              49,
              98,
              122,
              103,
              55,
              98,
              108,
              100,
              86,
              98,
              37,
              50,
              66,
              52,
              69,
              66,
              37,
              50,
              66,
              79,
              57,
              53,
              37,
              50,
              70,
              100,
              71,
              72,
              113,
              106,
              71,
              109,
              81,
              68,
              111,
              78,
              111,
              51,
              50,
              119,
              88,
              86,
              117,
              88,
              82,
              54,
              110,
              106,
              111,
              53,
              110,
              68,
              98,
              115,
              72,
              117,
              79,
              54,
              104,
              52,
              50,
              77,
              70,
              110,
              107,
              112,
              37,
              50,
              66,
              112,
              98,
              107,
              68,
              103,
              79,
              67,
              107,
              67,
              110,
              104,
              83,
              103,
              97,
              66,
              86,
              65,
              90,
              97,
              65,
              105,
              104,
              74,
              85,
              102,
              56,
              80,
              84,
              50,
              52,
              72,
              57,
              100,
              54,
              109,
              85,
              89,
              100,
              70,
              114,
              106,
              37,
              50,
              66,
              118,
              73,
              107,
              108,
              98,
              83,
              111,
              115,
              37,
              50,
              66,
              84,
              75,
              122,
              108,
              88,
              86,
              55,
              89,
              118,
              75,
              99,
              85,
              71,
              53,
              76,
              114,
              83,
              48,
              56,
              115,
              121,
              50,
              104,
              90,
              110,
              67,
              97,
              85,
              116,
              105,
              84,
              37,
              50,
              66,
              50,
              77,
              68,
              51,
              54,
              117,
              107,
              71,
              53,
              70,
              90,
              100,
              50,
              72,
              69,
              82,
              48,
              108,
              100,
              118,
              87,
              108,
              79,
              80,
              116,
              113,
              122,
              119,
              111,
              116,
              99,
              83,
              57,
              57,
              108,
              114,
              103,
              49,
              107,
              78,
              65,
              119,
              108,
              85,
              108,
              80,
              113,
              80,
              50,
              112,
              49,
              65,
              37,
              50,
              66,
              74,
              37,
              50,
              66,
              37,
              50,
              66,
              37,
              50,
              66,
              56,
              50,
              100,
              73,
              116,
              121,
              48,
              112,
              83,
              67,
              52,
              57,
              81,
              68,
              56,
              116,
              107,
              82,
              51,
              102,
              101,
              100,
              116,
              98,
              84,
              121,
              111,
              50,
              53,
              72,
              110,
              69,
              77,
              79,
              113,
              116,
              120,
              52,
              71,
              112,
              111,
              115,
              79,
              78,
              67,
              67,
              90,
              98,
              102,
              113,
              81,
              122,
              110,
              48,
              79,
              103,
              37,
              50,
              70,
              106,
              49,
              118,
              87,
              88,
              88,
              111,
              66,
              113,
              98,
              71,
              51,
              52,
              55,
              86,
              52,
              75,
              104,
              49,
              51,
              88,
              65,
              99,
              99,
              121,
              105,
              115,
              119,
              54,
              65,
              97,
              97,
              52,
              121,
              116,
              65,
              111,
              113,
              113,
              89,
              87,
              112,
              88,
              111,
              114,
              103,
              67,
              110,
              48,
              105,
              97,
              71,
              87,
              98,
              105,
              99,
              72,
              116,
              99,
              109,
              48,
              89,
              51,
              108,
              100,
              116,
              70,
              120,
              98,
              88,
              122,
              109,
              48,
              83,
              109,
              69,
              48,
              76,
              101,
              113,
              111,
              85,
              76,
              122,
              118,
              105,
              51,
              65,
              56,
              90,
              74,
              56,
              90,
              115,
              51,
              121,
              57,
              103,
              110,
              89,
              85,
              70,
              109,
              111,
              102,
              117,
              49,
              119,
              48,
              65,
              104,
              122,
              105,
              111,
              113,
              104,
              99,
              71,
              37,
              50,
              70,
              107,
              56,
              37,
              50,
              66,
              49,
              116,
              57,
              105,
              108,
              67,
              52,
              54,
              114,
              108,
              121,
              121,
              110,
              103,
              37,
              51,
              68,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 112,
          "responseSize": 791
        },
        "id": "2b39483c-3bde-4db6-8fd0-dc4df3260482",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메시지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "정기결제 초기인증 표준페이지 시작 URL(STARTURL) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "가맹점 주문번호(ORDERID) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "위 표준페이지 시작 URL 전송 파라미터(STARTPARAMS) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결제금액(AMOUNT) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "d3911a6e-ca85-45f9-809f-739d138650ef",
          "length": 21,
          "cycles": 1,
          "position": 1,
          "iteration": 0,
          "httpRequestId": "b4bcb50a-1df7-41a9-bd19-9a244a48b2ac"
        },
        "item": {
          "id": "9039e9be-4170-4443-8654-568d0b427cd3",
          "name": "READY - DANALCARD",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded; charset=UTF-8"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "dada1b29-076d-4030-b81d-ce353f0c421b",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "// 파싱 및 개별 디코딩\r",
                  "const parsed = parseQueryString(result);\r",
                  "const startUrlDecoded = safeDecodeURIComponent(parsed.STARTURL);\r",
                  "console.log(\"STARTURL(디코딩):\", startUrlDecoded);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메시지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"정기결제 초기인증 표준페이지 시작 URL(STARTURL) 정상출력\", function () {\r",
                  "    pm.expect(startUrlDecoded).to.eql(\"https://checkout.teledit.com/creditcard_std/web\")\r",
                  "})\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"위 표준페이지 시작 URL 전송 파라미터(STARTPARAMS) 정상출력\", function () {\r",
                  "    pm.expect(parsed.STARTPARAMS).to.not.be.undefined;\r",
                  "    pm.expect(parsed.STARTPARAMS).to.not.be.empty;\r",
                  "    pm.expect(parsed.STARTPARAMS).to.not.be.null;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"결제금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});"
                ],
                "_lastExecutionId": "0b3e886b-f035-4003-bcbb-c834d30e6533"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "af79d22c-6be4-431c-b50f-b50d9bcb534a",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'PC',\r",
                  "    TXTYPE: 'AUTH',\r",
                  "    SERVICETYPE: 'DANALCARD',\r",
                  "    CANCELURL: 'https://paytest.teledit.com:888/clientdemo/oneapi/returnFail.php',\r",
                  "    RETURNURL: 'https://paytest.teledit.com:888/clientdemo/oneapi/returnFail.php',\r",
                  "    ISBILL: 'Y',\r",
                  "    ISNOTI: 'N'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "d7b59cfb-3cbd-45c6-8935-5d20cf7bcc89"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "wcpoTy27mkzR%2FoCmuhu%2BEL1VevUN6wQgs96fAg0NJdKChw9Ccm7hXXJcj%2FUGj%2Bb8z5dq8TvydwIj3RXPjUXi4PJAgyNbIM2hLz3kcfuDNAsCL18rdUmVCzFjEXB9wjgQ82IteFWZK11Um66aaXg9%2BmJBA%2BzStWEMjr0dSocIEm%2Bbu9cYhIHHrFuuMeAbp0%2FaOn9YPjFswBAcVkFCl4MZNYRXi9%2BMiA7xwR%2FFNE00HJ0pC21O5yf5imQNizmVqk2bD03K20FpT3Fs3h%2FUCOJ0UXofslr6lyNGsyvb6DemiNcWC4LE3zCDhJmfdiJa9ITHGb2ToWrxU2XD3B50so4Ru4EZtRrOIrbszRI9doqcDx5dZKeCsMBh%2Ff1PMU0qTPX5ctV%2BHYz%2F289vKWnUu4B9CA%3D%3D"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "Content-Type",
              "value": "application/x-www-form-urlencoded; charset=UTF-8"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "0da3ad77-0475-4d20-a760-dc4b76ee0ea3",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z2n8upl40jfhop",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "14caa90e-511a-48f5-9bc8-9358baa31b4a",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "795"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 14:55:03 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              85,
              80,
              100,
              37,
              50,
              66,
              75,
              48,
              72,
              110,
              79,
              120,
              87,
              84,
              105,
              75,
              82,
              70,
              102,
              111,
              72,
              107,
              98,
              104,
              52,
              52,
              88,
              117,
              70,
              111,
              37,
              50,
              70,
              49,
              89,
              70,
              101,
              52,
              51,
              115,
              114,
              82,
              81,
              52,
              79,
              74,
              79,
              120,
              104,
              76,
              115,
              57,
              53,
              86,
              65,
              114,
              97,
              53,
              115,
              37,
              50,
              70,
              86,
              83,
              76,
              107,
              122,
              50,
              101,
              99,
              73,
              53,
              113,
              81,
              80,
              49,
              74,
              68,
              55,
              70,
              105,
              68,
              56,
              48,
              56,
              115,
              55,
              72,
              105,
              80,
              100,
              52,
              97,
              105,
              70,
              118,
              66,
              106,
              114,
              51,
              113,
              89,
              111,
              122,
              100,
              72,
              81,
              53,
              88,
              122,
              103,
              106,
              53,
              66,
              122,
              90,
              73,
              105,
              75,
              37,
              50,
              70,
              106,
              49,
              74,
              110,
              79,
              89,
              68,
              106,
              102,
              83,
              113,
              37,
              50,
              66,
              85,
              69,
              97,
              87,
              115,
              98,
              52,
              84,
              115,
              102,
              71,
              109,
              68,
              71,
              74,
              81,
              52,
              106,
              86,
              71,
              110,
              108,
              37,
              50,
              70,
              104,
              69,
              76,
              48,
              87,
              112,
              120,
              77,
              121,
              84,
              57,
              79,
              84,
              101,
              52,
              98,
              115,
              106,
              107,
              102,
              97,
              67,
              76,
              83,
              56,
              72,
              69,
              71,
              56,
              79,
              110,
              114,
              77,
              70,
              49,
              80,
              69,
              115,
              37,
              50,
              66,
              37,
              50,
              70,
              116,
              107,
              55,
              37,
              50,
              70,
              37,
              50,
              66,
              111,
              89,
              111,
              49,
              110,
              103,
              80,
              97,
              82,
              76,
              83,
              98,
              122,
              112,
              81,
              116,
              113,
              103,
              104,
              71,
              101,
              103,
              48,
              74,
              37,
              50,
              66,
              76,
              70,
              73,
              109,
              119,
              82,
              54,
              115,
              81,
              82,
              113,
              113,
              53,
              66,
              50,
              71,
              73,
              100,
              50,
              74,
              99,
              51,
              50,
              70,
              68,
              53,
              74,
              75,
              115,
              70,
              70,
              99,
              120,
              76,
              105,
              86,
              55,
              100,
              107,
              76,
              84,
              108,
              99,
              107,
              104,
              82,
              117,
              98,
              86,
              103,
              53,
              71,
              68,
              37,
              50,
              66,
              74,
              55,
              74,
              89,
              57,
              97,
              56,
              105,
              71,
              71,
              105,
              118,
              106,
              48,
              98,
              67,
              98,
              72,
              119,
              88,
              98,
              102,
              100,
              119,
              71,
              55,
              87,
              115,
              72,
              37,
              50,
              66,
              105,
              54,
              73,
              118,
              65,
              55,
              84,
              85,
              48,
              49,
              55,
              119,
              53,
              37,
              50,
              66,
              104,
              56,
              71,
              86,
              68,
              37,
              50,
              70,
              99,
              71,
              67,
              70,
              69,
              104,
              65,
              79,
              119,
              66,
              100,
              82,
              117,
              53,
              115,
              118,
              115,
              37,
              50,
              66,
              102,
              55,
              112,
              50,
              52,
              80,
              74,
              111,
              51,
              48,
              71,
              100,
              73,
              114,
              73,
              114,
              74,
              90,
              113,
              109,
              83,
              99,
              100,
              65,
              99,
              101,
              101,
              122,
              65,
              105,
              105,
              49,
              119,
              56,
              109,
              117,
              100,
              118,
              99,
              54,
              69,
              109,
              78,
              85,
              86,
              70,
              37,
              50,
              70,
              69,
              82,
              104,
              118,
              105,
              101,
              114,
              100,
              82,
              103,
              97,
              71,
              37,
              50,
              70,
              49,
              50,
              122,
              48,
              99,
              83,
              86,
              101,
              98,
              111,
              112,
              122,
              76,
              88,
              119,
              114,
              69,
              115,
              86,
              106,
              119,
              106,
              84,
              55,
              68,
              106,
              55,
              88,
              107,
              111,
              65,
              85,
              73,
              116,
              52,
              48,
              84,
              75,
              71,
              68,
              122,
              114,
              66,
              100,
              67,
              52,
              113,
              56,
              103,
              106,
              37,
              50,
              70,
              49,
              86,
              97,
              54,
              113,
              56,
              71,
              89,
              82,
              87,
              66,
              87,
              74,
              118,
              57,
              107,
              81,
              37,
              50,
              66,
              50,
              71,
              121,
              52,
              73,
              85,
              86,
              54,
              68,
              85,
              78,
              68,
              71,
              80,
              90,
              120,
              75,
              79,
              66,
              116,
              72,
              68,
              55,
              65,
              84,
              78,
              37,
              50,
              70,
              66,
              56,
              57,
              79,
              107,
              104,
              108,
              116,
              102,
              81,
              54,
              77,
              65,
              113,
              110,
              99,
              70,
              69,
              83,
              100,
              74,
              117,
              114,
              82,
              118,
              54,
              79,
              57,
              73,
              51,
              37,
              50,
              70,
              112,
              52,
              79,
              74,
              84,
              78,
              116,
              86,
              86,
              81,
              69,
              37,
              50,
              70,
              119,
              116,
              71,
              112,
              121,
              70,
              55,
              100,
              56,
              103,
              78,
              48,
              98,
              37,
              50,
              70,
              54,
              116,
              107,
              69,
              72,
              84,
              67,
              110,
              52,
              37,
              50,
              66,
              80,
              121,
              97,
              57,
              76,
              83,
              88,
              79,
              116,
              107,
              108,
              98,
              101,
              71,
              102,
              103,
              97,
              86,
              79,
              98,
              54,
              111,
              98,
              119,
              87,
              48,
              117,
              57,
              109,
              71,
              111,
              85,
              76,
              85,
              114,
              56,
              112,
              98,
              37,
              50,
              66,
              110,
              74,
              112,
              56,
              83,
              50,
              87,
              80,
              75,
              90,
              87,
              77,
              80,
              84,
              105,
              54,
              68,
              57,
              120,
              98,
              89,
              111,
              99,
              114,
              83,
              71,
              83,
              80,
              85,
              118,
              105,
              103,
              97,
              37,
              50,
              66,
              116,
              77,
              81,
              53,
              54,
              55,
              104,
              50,
              52,
              119,
              117,
              82,
              79,
              76,
              105,
              79,
              112,
              107,
              98,
              101,
              55,
              74,
              86,
              100,
              114,
              112,
              50,
              67,
              53,
              109,
              55,
              48,
              113,
              99,
              106,
              71,
              79,
              56,
              111,
              120,
              115,
              66,
              97,
              85,
              37,
              50,
              66,
              102,
              81,
              37,
              51,
              68,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 35,
          "responseSize": 795
        },
        "id": "9039e9be-4170-4443-8654-568d0b427cd3",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메시지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "정기결제 초기인증 표준페이지 시작 URL(STARTURL) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "가맹점 주문번호(ORDERID) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "위 표준페이지 시작 URL 전송 파라미터(STARTPARAMS) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결제금액(AMOUNT) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "bd89c824-74d8-488b-abeb-fb40ca1c96a8",
          "length": 21,
          "cycles": 1,
          "position": 2,
          "iteration": 0,
          "httpRequestId": "2a773e89-cb48-4b97-8ec1-9ad45223afd0"
        },
        "item": {
          "id": "4c04b8f7-7b16-4497-9192-a956028afa1a",
          "name": "ISSUEBILLKEY",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded; charset=UTF-8"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "c3079f94-338d-475b-8698-1b78cc1491fd",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get('TID'),\r",
                  "    TXTYPE: 'ISSUEBILLKEY',\r",
                  "    SERVICETYPE: 'BATCH'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "c7cc3e75-1d72-456b-9e24-755be8cf6fb9"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "63736d6d-9b85-449f-a80a-bef51b6fd267",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "// 파싱 및 개별 디코딩\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) : 1104 출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"1104\")\r",
                  "});\r",
                  "\r",
                  "// \"존재하지 않는 거래 입니다.\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) : 존재하지 않는 거래입니다. 출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%C1%B8%C0%E7%C7%CF%C1%F6+%BE%CA%B4%C2+%B0%C5%B7%A1+%C0%D4%B4%CF%B4%D9.\")\r",
                  "});"
                ],
                "_lastExecutionId": "92f59cf5-8df2-43a6-934a-b771404c769e"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "8kvDIwvdID7NWcBMND4uDXHvMUqO25iIdKkD6XH4VkTYfgoBPJqjGpr15Fqq4CCxlzQc11Pn06IJSodR9hnt4%2FgbXDCdFcZ2uADRjw%2Fvh8Q%3D"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "Content-Type",
              "value": "application/x-www-form-urlencoded; charset=UTF-8"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "d5886a65-8c4c-4d68-b0b8-d03adb6067df",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z2n8upl40jfhop",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "0f68f681-466e-4058-a35c-adc6a62a1a19",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "173"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 14:55:04 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              102,
              117,
              54,
              83,
              50,
              114,
              73,
              76,
              75,
              49,
              37,
              50,
              70,
              69,
              48,
              108,
              103,
              69,
              121,
              75,
              71,
              81,
              51,
              97,
              115,
              54,
              107,
              69,
              107,
              75,
              101,
              114,
              56,
              72,
              66,
              109,
              89,
              119,
              80,
              108,
              76,
              84,
              81,
              80,
              113,
              101,
              87,
              101,
              111,
              48,
              116,
              97,
              76,
              106,
              111,
              73,
              113,
              89,
              51,
              110,
              116,
              53,
              77,
              57,
              65,
              105,
              110,
              57,
              37,
              50,
              70,
              100,
              83,
              114,
              110,
              101,
              121,
              53,
              88,
              107,
              55,
              78,
              56,
              114,
              114,
              88,
              101,
              68,
              97,
              116,
              88,
              109,
              88,
              51,
              99,
              66,
              107,
              87,
              56,
              65,
              75,
              37,
              50,
              70,
              104,
              117,
              114,
              49,
              48,
              51,
              74,
              67,
              80,
              107,
              37,
              50,
              70,
              103,
              110,
              72,
              73,
              102,
              103,
              107,
              78,
              117,
              120,
              115,
              73,
              101,
              81,
              70,
              83,
              118,
              73,
              102,
              73,
              37,
              50,
              70,
              72,
              49,
              74,
              84,
              105,
              55,
              116,
              87,
              79,
              111,
              99,
              37,
              50,
              66,
              109,
              103,
              84,
              51,
              100,
              99,
              88,
              65,
              37,
              51,
              68,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 23,
          "responseSize": 173
        },
        "id": "4c04b8f7-7b16-4497-9192-a956028afa1a",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) : 1104 출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) : 존재하지 않는 거래입니다. 출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "3a011b4c-4001-4fae-a463-ec04f09beb77",
          "length": 21,
          "cycles": 1,
          "position": 3,
          "iteration": 0,
          "httpRequestId": "042ce9f8-1c93-436a-8e79-6066e87da069"
        },
        "item": {
          "id": "210f1ae8-b449-4b46-9320-a25e2861cd04",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded; charset=UTF-8"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "bd8cc440-a031-4b3e-80b5-cf3c8f06d3f7",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC250730151749FFCAA0',\r",
                  "    USERNAME: '김하늘',\r",
                  "    USERPHONE: '01085402697',\r",
                  "    ORDERID: '01234567'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "f87b8ce4-4477-423d-a221-297014e9b202"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "30821a64-995d-4248-acd9-930d4b9d4059",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0500\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.eql(\"01085402697\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.eql(\"01234567\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"512028******7294\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BB%EF%BC%BA%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.eql(\"%EA%B9%3F%3F%3F%3F%3F\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "62831437-484c-41aa-86d8-48760a35caab"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "wcpoTy27mkzR%2FoCmuhu%2BEL1VevUN6wQgs96fAg0NJdKChw9Ccm7hXXJcj%2FUGj%2Bb8z5dq8TvydwIj3RXPjUXi4KzQHH0ZG0DZA03Udge2eI0IsrkEsoTSxKLbYyq5iCvbykTt6GhW9hCDbp8fHC1zGJEYvBJNsjEqz2X9zw2JzccrERjqayECmibASVLCFcu3mtMwnyeSqsDkh6Ok0RVNhbkzCgrGZvyWLuE0qblstQgkt2NYUzE21ScHAo%2BsYJOcT3xCtYEislZjbacyD1Wou68o56siY3%2FOkdyV%2FLh5ZjM%3D"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "Content-Type",
              "value": "application/x-www-form-urlencoded; charset=UTF-8"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "7d1610c2-2af5-421d-a241-2176d4e3e62e",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z2n8upl40jfhop",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "0225cf44-ceaf-4514-80bc-0be3fa715a0c",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "483"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 14:55:05 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              85,
              79,
              114,
              84,
              50,
              122,
              98,
              84,
              116,
              90,
              116,
              65,
              104,
              54,
              52,
              50,
              115,
              86,
              101,
              74,
              54,
              83,
              105,
              110,
              122,
              90,
              79,
              117,
              104,
              37,
              50,
              70,
              73,
              90,
              56,
              73,
              52,
              117,
              100,
              113,
              98,
              71,
              72,
              116,
              66,
              107,
              104,
              103,
              100,
              105,
              37,
              50,
              66,
              77,
              100,
              87,
              117,
              68,
              82,
              87,
              57,
              101,
              107,
              115,
              72,
              103,
              87,
              73,
              65,
              106,
              101,
              65,
              77,
              52,
              66,
              55,
              108,
              108,
              87,
              105,
              106,
              90,
              81,
              50,
              50,
              37,
              50,
              66,
              113,
              115,
              99,
              81,
              50,
              71,
              109,
              53,
              103,
              51,
              69,
              80,
              102,
              111,
              85,
              49,
              56,
              77,
              104,
              68,
              118,
              116,
              100,
              37,
              50,
              66,
              122,
              87,
              106,
              104,
              54,
              114,
              78,
              90,
              67,
              119,
              51,
              52,
              104,
              83,
              99,
              52,
              98,
              81,
              48,
              78,
              80,
              49,
              82,
              98,
              97,
              106,
              77,
              57,
              119,
              110,
              71,
              89,
              116,
              109,
              101,
              56,
              99,
              77,
              70,
              114,
              37,
              50,
              70,
              106,
              76,
              79,
              109,
              90,
              52,
              54,
              114,
              105,
              80,
              114,
              102,
              49,
              109,
              104,
              110,
              74,
              113,
              112,
              71,
              90,
              107,
              117,
              87,
              52,
              97,
              98,
              120,
              76,
              103,
              112,
              74,
              52,
              48,
              37,
              50,
              66,
              73,
              79,
              77,
              119,
              37,
              50,
              66,
              85,
              78,
              79,
              52,
              108,
              71,
              37,
              50,
              66,
              85,
              48,
              121,
              100,
              69,
              37,
              50,
              66,
              113,
              110,
              50,
              110,
              79,
              119,
              84,
              53,
              55,
              76,
              110,
              103,
              82,
              115,
              102,
              67,
              86,
              78,
              65,
              37,
              50,
              70,
              50,
              100,
              50,
              105,
              65,
              80,
              122,
              99,
              76,
              88,
              106,
              75,
              118,
              49,
              57,
              37,
              50,
              66,
              74,
              109,
              110,
              111,
              99,
              75,
              109,
              81,
              48,
              55,
              106,
              65,
              84,
              111,
              66,
              76,
              108,
              70,
              51,
              98,
              114,
              90,
              104,
              86,
              56,
              67,
              77,
              118,
              89,
              76,
              121,
              75,
              115,
              67,
              88,
              112,
              57,
              108,
              65,
              102,
              86,
              37,
              50,
              70,
              74,
              103,
              79,
              65,
              90,
              112,
              109,
              37,
              50,
              66,
              75,
              57,
              99,
              115,
              66,
              51,
              78,
              70,
              67,
              109,
              109,
              66,
              74,
              100,
              106,
              68,
              85,
              120,
              99,
              54,
              100,
              113,
              86,
              79,
              52,
              37,
              50,
              66,
              117,
              53,
              49,
              108,
              57,
              101,
              110,
              89,
              109,
              117,
              118,
              86,
              90,
              119,
              117,
              78,
              115,
              82,
              110,
              57,
              87,
              66,
              102,
              108,
              86,
              81,
              66,
              117,
              83,
              120,
              71,
              118,
              117,
              106,
              88,
              88,
              66,
              81,
              57,
              97,
              82,
              52,
              52,
              80,
              55,
              56,
              78,
              115,
              51,
              115,
              81,
              107,
              54,
              51,
              102,
              69,
              65,
              48,
              74,
              98,
              52,
              80,
              66,
              82,
              50,
              122,
              114,
              109,
              85,
              103,
              99,
              109,
              119,
              117,
              115,
              101,
              101,
              116,
              99,
              68,
              86,
              73,
              84,
              118,
              101,
              120,
              118,
              82,
              101,
              50,
              74,
              97,
              110,
              65
            ]
          },
          "cookie": [],
          "responseTime": 1524,
          "responseSize": 483
        },
        "id": "210f1ae8-b449-4b46-9320-a25e2861cd04",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 코드(CARDCODE 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 전화번호(USERPHONE) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "할부 개월 수(QUOTA) 정상출력",
            "skipped": false
          },
          {
            "assertion": "매출 발생시간(TRANTIME) ±5초 이내 검증",
            "skipped": false
          },
          {
            "assertion": "매출 발생일자(TRANDATE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "상품명(ITEMNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "가맹점 주문번호(ORDERID) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "카드번호(CARDNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "거래 승인 번호(CARDAUTHNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 명(CARDNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 이름(USERNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 ID(USERID) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "32f20637-1a10-4114-b5d7-a3023b75f2f7",
          "length": 21,
          "cycles": 1,
          "position": 4,
          "iteration": 0,
          "httpRequestId": "5feec77e-781c-4599-bb3a-5c154245e4f9"
        },
        "item": {
          "id": "3887b742-e516-4009-998f-c93a2787dc41",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "137db39f-e41c-41de-9c0c-484a6e24d711",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "a8db36f1-6efb-404b-8459-ab8f110ffbf7"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "a751a53a-08db-4a45-9f35-6d0741a234da",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "62f798ca-6e98-4e37-bbe9-cd1a2894f4df"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "8kvDIwvdID7NWcBMND4uDd5ydrWLek%2F4l9NaCzu3TbXyHUpTgnBn7Z9zevVD%2FSzRfaWwVwK4dN0W2lZxMM3nCcS%2Fv7AIHivPt8aoOzcqGdFaqngA2kQvup0zMFioiq7I"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "43685264-3b02-4d00-ab54-0c17c9d1e647",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z2n8upl40jfhop",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "445a8896-be24-4fc9-a8b4-589a997aaba5",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "263"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 14:55:07 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              86,
              122,
              104,
              72,
              85,
              53,
              115,
              100,
              101,
              115,
              52,
              48,
              103,
              114,
              118,
              75,
              109,
              122,
              105,
              37,
              50,
              66,
              114,
              88,
              86,
              51,
              108,
              69,
              37,
              50,
              66,
              76,
              122,
              119,
              121,
              53,
              81,
              118,
              83,
              89,
              77,
              67,
              71,
              108,
              109,
              112,
              73,
              54,
              57,
              108,
              119,
              90,
              53,
              37,
              50,
              66,
              56,
              49,
              119,
              57,
              87,
              111,
              55,
              55,
              68,
              109,
              112,
              84,
              83,
              77,
              37,
              50,
              70,
              119,
              117,
              77,
              37,
              50,
              70,
              114,
              121,
              117,
              81,
              109,
              85,
              108,
              79,
              37,
              50,
              70,
              81,
              74,
              70,
              121,
              117,
              57,
              111,
              71,
              109,
              65,
              71,
              122,
              83,
              90,
              117,
              57,
              99,
              120,
              50,
              108,
              118,
              107,
              89,
              112,
              48,
              74,
              105,
              50,
              72,
              57,
              118,
              98,
              104,
              108,
              51,
              102,
              70,
              107,
              97,
              100,
              79,
              72,
              80,
              117,
              109,
              76,
              37,
              50,
              66,
              79,
              37,
              50,
              66,
              76,
              56,
              106,
              122,
              79,
              37,
              50,
              66,
              57,
              85,
              113,
              79,
              110,
              78,
              77,
              69,
              57,
              55,
              81,
              110,
              112,
              80,
              103,
              105,
              51,
              54,
              49,
              48,
              69,
              113,
              77,
              113,
              122,
              108,
              122,
              87,
              114,
              78,
              113,
              86,
              76,
              107,
              84,
              51,
              81,
              120,
              113,
              111,
              121,
              66,
              87,
              89,
              87,
              71,
              68,
              71,
              71,
              116,
              106,
              86,
              73,
              88,
              71,
              102,
              110,
              117,
              104,
              99,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1414,
          "responseSize": 263
        },
        "id": "3887b742-e516-4009-998f-c93a2787dc41",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "취소 후 잔액(BALANCE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 원 거래 키(O_TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생시간(TRANTIME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생일자(TRANDATE)",
            "skipped": false
          },
          {
            "assertion": "승인 취소 금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "f70a4441-2c3a-479f-a6b6-d4e7f8848c9e",
          "length": 21,
          "cycles": 1,
          "position": 5,
          "iteration": 0,
          "httpRequestId": "60f97b45-bf1a-4ce6-b109-03fc6ab1b509"
        },
        "item": {
          "id": "f924bf79-05b5-4d1c-8627-14c0c421d7bb",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "b5f56f70-e987-4ae9-b22a-d7f6b4a6fdb6",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC221222165535557F38'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "a41ee836-028a-4b14-96b4-c8700fb53498"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "7382d275-0c13-4598-b629-a22a37111fea",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0400\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"403293******4003\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"현대카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%C7%F6%B4%EB%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "})\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "c958f7dc-67d5-41d5-a883-5b8dec698d97"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "wcpoTy27mkzR%2FoCmuhu%2BEL1VevUN6wQgs96fAg0NJdKChw9Ccm7hXXJcj%2FUGj%2Bb8z5dq8TvydwIj3RXPjUXi4KzQHH0ZG0DZA03Udge2eI0IsrkEsoTSxKLbYyq5iCvbykTt6GhW9hCDbp8fHC1zGJEYvBJNsjEqz2X9zw2JzceacjSE9wkZ8OEcuyhqS4aTCOgYJsVDSvmkj%2FNDn1RD1w%3D%3D"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "c7ba7129-00b2-480d-9f4c-b8cd29007468",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z2n8upl40jfhop",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "33a4e786-dba3-4c3e-826a-73ce82b2d08d",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "435"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 14:55:08 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              85,
              79,
              114,
              84,
              50,
              122,
              98,
              84,
              116,
              90,
              116,
              65,
              104,
              54,
              52,
              50,
              115,
              86,
              101,
              74,
              54,
              83,
              53,
              70,
              88,
              84,
              104,
              82,
              70,
              68,
              71,
              122,
              97,
              100,
              67,
              102,
              82,
              75,
              111,
              97,
              74,
              107,
              107,
              50,
              55,
              78,
              97,
              109,
              97,
              54,
              87,
              111,
              56,
              52,
              81,
              100,
              84,
              108,
              107,
              83,
              116,
              106,
              99,
              99,
              112,
              83,
              57,
              81,
              114,
              49,
              72,
              89,
              81,
              113,
              85,
              83,
              108,
              73,
              116,
              51,
              73,
              111,
              111,
              99,
              74,
              67,
              68,
              98,
              83,
              80,
              105,
              118,
              110,
              74,
              78,
              50,
              87,
              99,
              65,
              49,
              85,
              108,
              89,
              119,
              71,
              107,
              70,
              49,
              65,
              79,
              52,
              97,
              103,
              69,
              52,
              81,
              76,
              88,
              97,
              109,
              114,
              88,
              50,
              87,
              102,
              57,
              74,
              97,
              83,
              82,
              88,
              74,
              37,
              50,
              66,
              107,
              119,
              54,
              82,
              100,
              74,
              109,
              117,
              105,
              102,
              98,
              101,
              119,
              105,
              69,
              104,
              87,
              113,
              122,
              116,
              57,
              101,
              89,
              103,
              102,
              119,
              79,
              99,
              37,
              50,
              66,
              56,
              103,
              90,
              54,
              120,
              90,
              113,
              88,
              105,
              37,
              50,
              70,
              97,
              87,
              85,
              79,
              113,
              82,
              37,
              50,
              70,
              112,
              81,
              115,
              108,
              79,
              75,
              78,
              87,
              120,
              51,
              81,
              71,
              102,
              52,
              68,
              99,
              121,
              90,
              74,
              102,
              99,
              50,
              97,
              53,
              73,
              76,
              87,
              87,
              78,
              118,
              76,
              86,
              99,
              112,
              78,
              49,
              107,
              77,
              52,
              118,
              109,
              108,
              52,
              105,
              104,
              82,
              88,
              86,
              106,
              71,
              37,
              50,
              70,
              85,
              90,
              77,
              87,
              105,
              104,
              75,
              56,
              57,
              122,
              122,
              89,
              106,
              113,
              66,
              105,
              103,
              84,
              119,
              82,
              57,
              82,
              122,
              49,
              121,
              85,
              85,
              107,
              65,
              69,
              50,
              83,
              78,
              86,
              72,
              70,
              111,
              105,
              67,
              122,
              53,
              111,
              114,
              112,
              76,
              48,
              81,
              99,
              108,
              37,
              50,
              70,
              98,
              68,
              73,
              106,
              50,
              73,
              101,
              74,
              113,
              69,
              57,
              117,
              70,
              74,
              105,
              98,
              100,
              48,
              98,
              56,
              68,
              48,
              74,
              100,
              89,
              87,
              88,
              83,
              85,
              116,
              115,
              68,
              37,
              50,
              70,
              86,
              85,
              117,
              75,
              83,
              53,
              118,
              82,
              104,
              115,
              120,
              51,
              70,
              100,
              53,
              105,
              88,
              118,
              117,
              51,
              90,
              67,
              112,
              82,
              118,
              85,
              102,
              100,
              72,
              106,
              89,
              116,
              98,
              87,
              113,
              99,
              84,
              56,
              112,
              37,
              50,
              66,
              85,
              54,
              48,
              77,
              88,
              77,
              50,
              56,
              109,
              119,
              119,
              37,
              51,
              68,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1292,
          "responseSize": 435
        },
        "id": "f924bf79-05b5-4d1c-8627-14c0c421d7bb",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 코드(CARDCODE 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 전화번호(USERPHONE) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "할부 개월 수(QUOTA) 정상출력",
            "skipped": false
          },
          {
            "assertion": "매출 발생시간(TRANTIME) ±5초 이내 검증",
            "skipped": false
          },
          {
            "assertion": "매출 발생일자(TRANDATE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "상품명(ITEMNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "가맹점 주문번호(ORDERID) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "카드번호(CARDNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "거래 승인 번호(CARDAUTHNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 명(CARDNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 이름(USERNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 ID(USERID) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "f5f51a37-2fc1-4a76-9d82-c48a57a6ad66",
          "length": 21,
          "cycles": 1,
          "position": 6,
          "iteration": 0,
          "httpRequestId": "073f0ea0-c1c6-44ae-af98-315ce0c83ae1"
        },
        "item": {
          "id": "73039d21-1d98-47e9-a6e5-f242b914b1b3",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "c91a86ff-4b46-43bb-bd50-8c32f196dc12",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "7c4231e8-6666-4f04-8c64-59c065726abc"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "ce7f762c-34d1-4581-bbdb-5ea23e153340",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "6f2cd4d0-7752-4948-a963-6bcdfca630e4"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "8kvDIwvdID7NWcBMND4uDXiABVXFVpSLPX52zVa8ivkrsrzitKm94gbCgNwcpWu78auwWgOlB%2BgcFuSTboPVtg%2Fzt%2BnScvhT65WFX48qB0iBF0RhBOOr3%2Fz00mTo0II8"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "96d8c807-7d6d-415b-9f46-b378ec747d6d",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z2n8upl40jfhop",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "02a6a11a-0376-45cb-b465-bf206cff208b",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "259"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 14:55:10 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              86,
              122,
              104,
              72,
              85,
              53,
              115,
              100,
              101,
              115,
              52,
              48,
              103,
              114,
              118,
              75,
              109,
              122,
              105,
              37,
              50,
              66,
              114,
              88,
              86,
              51,
              108,
              69,
              37,
              50,
              66,
              76,
              122,
              119,
              121,
              53,
              81,
              118,
              83,
              89,
              77,
              67,
              71,
              108,
              109,
              112,
              73,
              120,
              87,
              118,
              65,
              80,
              37,
              50,
              66,
              69,
              86,
              108,
              77,
              69,
              106,
              50,
              112,
              117,
              87,
              108,
              117,
              52,
              50,
              71,
              108,
              118,
              79,
              120,
              115,
              65,
              57,
              80,
              112,
              77,
              88,
              101,
              90,
              50,
              99,
              99,
              108,
              84,
              109,
              85,
              106,
              117,
              49,
              78,
              117,
              65,
              102,
              104,
              82,
              104,
              108,
              80,
              98,
              80,
              83,
              103,
              107,
              101,
              116,
              89,
              102,
              97,
              69,
              80,
              112,
              107,
              79,
              117,
              82,
              101,
              85,
              88,
              78,
              57,
              69,
              54,
              57,
              90,
              52,
              79,
              75,
              89,
              120,
              37,
              50,
              66,
              90,
              114,
              65,
              101,
              49,
              56,
              108,
              102,
              37,
              50,
              66,
              118,
              67,
              88,
              48,
              115,
              68,
              53,
              56,
              110,
              71,
              85,
              115,
              86,
              97,
              98,
              109,
              107,
              85,
              112,
              100,
              107,
              110,
              52,
              52,
              88,
              66,
              86,
              71,
              104,
              79,
              107,
              109,
              70,
              106,
              115,
              85,
              72,
              109,
              116,
              50,
              104,
              54,
              111,
              82,
              48,
              57,
              112,
              37,
              50,
              66,
              103,
              69,
              68,
              48,
              74,
              37,
              50,
              66,
              106,
              81,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1287,
          "responseSize": 259
        },
        "id": "73039d21-1d98-47e9-a6e5-f242b914b1b3",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "취소 후 잔액(BALANCE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 원 거래 키(O_TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생시간(TRANTIME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생일자(TRANDATE)",
            "skipped": false
          },
          {
            "assertion": "승인 취소 금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "8bf4779c-5d72-4bbd-a444-8bf647bdba54",
          "length": 21,
          "cycles": 1,
          "position": 7,
          "iteration": 0,
          "httpRequestId": "b4ae09c1-93b8-46f7-8373-a4a9a2c2c144"
        },
        "item": {
          "id": "255608f1-1a42-451b-873e-dd5cea8a59f5",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "97fe69bc-f4ae-4ab1-a07d-372093885524",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC2507311547242F2CD0'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "f324bca2-550b-483e-8ffe-70ec3c9016bc"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "f64ceeab-436b-4068-9fa4-b83eb642df45",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0100\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"451842******5446\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"신한카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BD%C5%C7%D1%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "e2326c79-0952-4962-808f-03568fcba329"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "wcpoTy27mkzR%2FoCmuhu%2BEL1VevUN6wQgs96fAg0NJdKChw9Ccm7hXXJcj%2FUGj%2Bb8z5dq8TvydwIj3RXPjUXi4KzQHH0ZG0DZA03Udge2eI0IsrkEsoTSxKLbYyq5iCvbykTt6GhW9hCDbp8fHC1zGJEYvBJNsjEqz2X9zw2JzcfXTTxRRh%2BjuC1%2BxTb3aJM2weIs3zf7UG56%2FZflpkMYeg%3D%3D"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "e19d0281-a138-4bc4-9ec4-fae34ce8a6eb",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z2n8upl40jfhop",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "7802eb2a-e50a-4f82-9aa5-d58cb1accd4e",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "441"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 14:55:11 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              85,
              79,
              114,
              84,
              50,
              122,
              98,
              84,
              116,
              90,
              116,
              65,
              104,
              54,
              52,
              50,
              115,
              86,
              101,
              74,
              54,
              83,
              70,
              68,
              83,
              99,
              115,
              89,
              118,
              103,
              52,
              89,
              99,
              121,
              83,
              76,
              37,
              50,
              66,
              53,
              78,
              76,
              86,
              78,
              116,
              103,
              97,
              106,
              73,
              108,
              119,
              105,
              83,
              103,
              73,
              89,
              99,
              82,
              80,
              37,
              50,
              66,
              90,
              51,
              53,
              81,
              53,
              57,
              50,
              51,
              66,
              56,
              66,
              84,
              70,
              110,
              117,
              100,
              76,
              82,
              80,
              118,
              84,
              90,
              99,
              52,
              56,
              111,
              98,
              53,
              72,
              51,
              37,
              50,
              66,
              119,
              57,
              97,
              56,
              57,
              70,
              117,
              51,
              80,
              116,
              97,
              53,
              106,
              69,
              106,
              98,
              111,
              106,
              69,
              67,
              88,
              82,
              48,
              117,
              97,
              119,
              56,
              90,
              48,
              112,
              85,
              110,
              97,
              109,
              55,
              65,
              49,
              55,
              121,
              105,
              51,
              76,
              76,
              74,
              48,
              118,
              105,
              109,
              120,
              74,
              84,
              109,
              102,
              70,
              100,
              68,
              72,
              48,
              37,
              50,
              66,
              65,
              54,
              87,
              37,
              50,
              70,
              120,
              82,
              122,
              67,
              99,
              78,
              67,
              81,
              85,
              79,
              85,
              85,
              89,
              74,
              115,
              57,
              72,
              52,
              90,
              119,
              116,
              105,
              57,
              71,
              112,
              75,
              56,
              48,
              103,
              73,
              55,
              84,
              82,
              101,
              97,
              107,
              102,
              50,
              119,
              113,
              111,
              109,
              86,
              99,
              83,
              37,
              50,
              66,
              112,
              122,
              89,
              104,
              79,
              81,
              50,
              78,
              102,
              109,
              55,
              55,
              122,
              77,
              97,
              119,
              88,
              99,
              102,
              89,
              78,
              74,
              66,
              111,
              70,
              115,
              110,
              101,
              49,
              104,
              69,
              81,
              53,
              54,
              52,
              109,
              106,
              106,
              83,
              49,
              69,
              56,
              102,
              101,
              114,
              73,
              66,
              50,
              75,
              100,
              110,
              106,
              54,
              80,
              85,
              100,
              69,
              115,
              117,
              86,
              81,
              115,
              67,
              109,
              83,
              97,
              106,
              67,
              73,
              101,
              37,
              50,
              70,
              111,
              83,
              104,
              97,
              103,
              67,
              120,
              37,
              50,
              70,
              56,
              73,
              121,
              71,
              102,
              105,
              88,
              109,
              53,
              103,
              102,
              77,
              89,
              56,
              112,
              57,
              66,
              83,
              116,
              51,
              50,
              98,
              48,
              110,
              107,
              70,
              55,
              72,
              115,
              116,
              83,
              67,
              85,
              97,
              90,
              54,
              54,
              65,
              116,
              108,
              76,
              77,
              48,
              80,
              73,
              88,
              101,
              88,
              102,
              86,
              99,
              90,
              72,
              120,
              118,
              97,
              65,
              100,
              117,
              87,
              48,
              102,
              66,
              100,
              110,
              82,
              98,
              72,
              116,
              50,
              37,
              50,
              66,
              113,
              89,
              88,
              52,
              37,
              50,
              70,
              37,
              50,
              66,
              57,
              68,
              103,
              97,
              79,
              113,
              89,
              84,
              80,
              103,
              37,
              51,
              68,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1454,
          "responseSize": 441
        },
        "id": "255608f1-1a42-451b-873e-dd5cea8a59f5",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 코드(CARDCODE 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 전화번호(USERPHONE) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "할부 개월 수(QUOTA) 정상출력",
            "skipped": false
          },
          {
            "assertion": "매출 발생시간(TRANTIME) ±5초 이내 검증",
            "skipped": false
          },
          {
            "assertion": "매출 발생일자(TRANDATE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "상품명(ITEMNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "가맹점 주문번호(ORDERID) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "카드번호(CARDNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "거래 승인 번호(CARDAUTHNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 명(CARDNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 이름(USERNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 ID(USERID) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "c7e8e76e-9c0e-443c-a5dc-5545b9abe3c2",
          "length": 21,
          "cycles": 1,
          "position": 8,
          "iteration": 0,
          "httpRequestId": "839ba534-d425-41bd-90e6-d0608f3c4cad"
        },
        "item": {
          "id": "c99464ba-79a9-4a3b-a15e-f8992ec51686",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "0bd8a104-ffee-43e7-bd31-3894530a5329",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "4d25daee-ba92-4676-a13f-d02df817f855"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "e1665029-2944-4786-bbc4-0fbe31f00a45",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "772d9a38-f4ac-4df2-92ba-b672293b48e4"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "8kvDIwvdID7NWcBMND4uDWOzWuQuomEOMXVH%2Bti9rG1jPjlHU%2B0nAZUOQT1AgLlGEX9uezCDy9ky9%2FmnTyOOXuqjVpxKnmVyDbscVBmUNCrdpIwtXPjc0kGi7j4TGJN2"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "fe7adc5b-d27a-4747-a804-ba17f4856367",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z2n8upl40jfhop",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "ce2b97e9-98fb-47dc-a904-8445f2ff2df7",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "257"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 14:55:12 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              86,
              122,
              104,
              72,
              85,
              53,
              115,
              100,
              101,
              115,
              52,
              48,
              103,
              114,
              118,
              75,
              109,
              122,
              105,
              37,
              50,
              66,
              114,
              88,
              86,
              51,
              108,
              69,
              37,
              50,
              66,
              76,
              122,
              119,
              121,
              53,
              81,
              118,
              83,
              89,
              77,
              67,
              71,
              108,
              109,
              112,
              73,
              56,
              48,
              97,
              80,
              88,
              109,
              115,
              53,
              68,
              111,
              56,
              97,
              116,
              105,
              69,
              117,
              99,
              105,
              67,
              121,
              102,
              89,
              88,
              51,
              80,
              48,
              110,
              85,
              103,
              37,
              50,
              70,
              111,
              87,
              118,
              74,
              88,
              100,
              54,
              78,
              77,
              116,
              118,
              55,
              76,
              79,
              113,
              79,
              37,
              50,
              70,
              105,
              115,
              105,
              90,
              106,
              90,
              55,
              89,
              71,
              82,
              104,
              104,
              86,
              85,
              103,
              112,
              66,
              114,
              90,
              86,
              68,
              83,
              76,
              67,
              56,
              115,
              78,
              55,
              50,
              72,
              53,
              118,
              54,
              113,
              51,
              112,
              121,
              87,
              37,
              50,
              66,
              102,
              52,
              74,
              48,
              116,
              117,
              84,
              49,
              78,
              122,
              87,
              53,
              57,
              48,
              78,
              79,
              111,
              70,
              49,
              100,
              99,
              82,
              79,
              100,
              104,
              80,
              54,
              48,
              121,
              69,
              110,
              100,
              55,
              107,
              65,
              49,
              112,
              71,
              109,
              119,
              50,
              100,
              77,
              49,
              65,
              66,
              116,
              54,
              48,
              68,
              106,
              89,
              69,
              69,
              67,
              99,
              37,
              50,
              66,
              72,
              69,
              87,
              53,
              115,
              87,
              73,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1352,
          "responseSize": 257
        },
        "id": "c99464ba-79a9-4a3b-a15e-f8992ec51686",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "취소 후 잔액(BALANCE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 원 거래 키(O_TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생시간(TRANTIME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생일자(TRANDATE)",
            "skipped": false
          },
          {
            "assertion": "승인 취소 금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "9fe9c5fe-3340-44fb-8763-955abf16765f",
          "length": 21,
          "cycles": 1,
          "position": 9,
          "iteration": 0,
          "httpRequestId": "57f0e9c8-8390-423e-97b1-bfa5eb333bdf"
        },
        "item": {
          "id": "1df155f2-1f5d-4f5f-92b6-ec9e5c1d50d3",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "de465096-5021-4a0b-9a56-1d3551cbac47",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC2512151528144A426D'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "d15fba87-9fd5-44cc-a150-c1ba44e68fd1"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "33ee4b20-3a48-419d-9bd0-145fba7dfaae",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0800\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"542586******3820\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "// \"NH농협카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"NH%B3%F3%C7%F9%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "fa7e3dd7-25af-4b33-9b7e-9716713487be"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "wcpoTy27mkzR%2FoCmuhu%2BEL1VevUN6wQgs96fAg0NJdKChw9Ccm7hXXJcj%2FUGj%2Bb8z5dq8TvydwIj3RXPjUXi4KzQHH0ZG0DZA03Udge2eI0IsrkEsoTSxKLbYyq5iCvbykTt6GhW9hCDbp8fHC1zGJEYvBJNsjEqz2X9zw2JzcfqMk1YAIjfTKOzEfoXN7bENBxmDICbQksXQP2fAKPCnw%3D%3D"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "68bb5fe1-8ee5-46c7-a120-be6343bd4f53",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z2n8upl40jfhop",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "4f95dfe1-e431-4dd4-a900-5926686a4cad",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "443"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 14:55:14 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              85,
              79,
              114,
              84,
              50,
              122,
              98,
              84,
              116,
              90,
              116,
              65,
              104,
              54,
              52,
              50,
              115,
              86,
              101,
              74,
              54,
              83,
              99,
              76,
              50,
              56,
              105,
              65,
              113,
              66,
              53,
              66,
              111,
              70,
              106,
              117,
              107,
              121,
              103,
              65,
              54,
              55,
              109,
              85,
              67,
              50,
              70,
              48,
              53,
              68,
              66,
              80,
              70,
              70,
              68,
              122,
              82,
              81,
              118,
              69,
              37,
              50,
              70,
              84,
              113,
              106,
              37,
              50,
              66,
              83,
              90,
              37,
              50,
              70,
              105,
              103,
              108,
              90,
              82,
              121,
              89,
              52,
              79,
              112,
              88,
              88,
              97,
              90,
              73,
              97,
              56,
              57,
              51,
              49,
              85,
              78,
              37,
              50,
              66,
              48,
              105,
              97,
              52,
              99,
              108,
              82,
              114,
              115,
              74,
              70,
              111,
              52,
              48,
              70,
              103,
              81,
              81,
              106,
              104,
              115,
              88,
              101,
              54,
              86,
              70,
              55,
              107,
              107,
              85,
              75,
              65,
              79,
              56,
              106,
              79,
              68,
              122,
              99,
              82,
              97,
              84,
              66,
              117,
              113,
              112,
              84,
              82,
              71,
              118,
              111,
              72,
              106,
              74,
              81,
              90,
              77,
              67,
              107,
              68,
              69,
              73,
              82,
              103,
              100,
              111,
              50,
              108,
              111,
              102,
              48,
              73,
              80,
              81,
              65,
              66,
              88,
              110,
              56,
              97,
              66,
              87,
              53,
              87,
              70,
              53,
              86,
              37,
              50,
              66,
              75,
              102,
              71,
              80,
              110,
              66,
              122,
              81,
              79,
              122,
              85,
              109,
              88,
              74,
              50,
              113,
              120,
              97,
              54,
              50,
              73,
              119,
              71,
              101,
              78,
              89,
              105,
              55,
              49,
              74,
              90,
              116,
              85,
              85,
              69,
              102,
              51,
              83,
              70,
              86,
              56,
              117,
              83,
              115,
              119,
              105,
              99,
              49,
              87,
              116,
              105,
              83,
              48,
              88,
              117,
              105,
              108,
              37,
              50,
              66,
              77,
              108,
              84,
              116,
              97,
              57,
              100,
              71,
              109,
              121,
              119,
              114,
              37,
              50,
              70,
              88,
              107,
              67,
              78,
              110,
              72,
              55,
              80,
              107,
              68,
              90,
              49,
              73,
              113,
              88,
              79,
              74,
              77,
              73,
              68,
              37,
              50,
              70,
              100,
              99,
              69,
              100,
              115,
              77,
              68,
              71,
              119,
              56,
              89,
              37,
              50,
              66,
              88,
              89,
              114,
              75,
              119,
              49,
              114,
              80,
              104,
              103,
              68,
              81,
              106,
              72,
              111,
              75,
              116,
              103,
              83,
              100,
              79,
              50,
              84,
              120,
              122,
              55,
              118,
              53,
              74,
              113,
              69,
              78,
              70,
              86,
              37,
              50,
              66,
              84,
              110,
              88,
              114,
              84,
              97,
              37,
              50,
              66,
              54,
              71,
              79,
              85,
              51,
              121,
              120,
              100,
              73,
              78,
              121,
              73,
              100,
              88,
              85,
              100,
              99,
              101,
              77,
              54,
              52,
              67,
              49,
              110,
              88,
              72,
              108,
              54,
              37,
              50,
              66,
              67,
              50,
              101,
              113,
              51,
              112,
              110,
              48,
              117,
              81,
              37,
              51,
              68,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1538,
          "responseSize": 443
        },
        "id": "1df155f2-1f5d-4f5f-92b6-ec9e5c1d50d3",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 코드(CARDCODE 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 전화번호(USERPHONE) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "할부 개월 수(QUOTA) 정상출력",
            "skipped": false
          },
          {
            "assertion": "매출 발생시간(TRANTIME) ±5초 이내 검증",
            "skipped": false
          },
          {
            "assertion": "매출 발생일자(TRANDATE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "상품명(ITEMNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "가맹점 주문번호(ORDERID) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "카드번호(CARDNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "거래 승인 번호(CARDAUTHNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 명(CARDNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 이름(USERNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 ID(USERID) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "8d767643-5d96-4fcf-86d8-6616adecc733",
          "length": 21,
          "cycles": 1,
          "position": 10,
          "iteration": 0,
          "httpRequestId": "fdaed051-148f-47a3-84c1-b3ed583a40d5"
        },
        "item": {
          "id": "ceb3098d-3291-4f29-9d1b-b75fc73f1939",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "60e62c37-57d7-4d9c-a837-fdfcd6f1361b",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "8852a17a-c67a-421d-97f4-525ac1291178"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "1d556d7e-e431-4211-b0e9-91f44561adb8",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "7b4ba37c-5e11-4922-bacd-85a139200012"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "8kvDIwvdID7NWcBMND4uDeSyKjNkKDD4QnCd8T7%2FtWlT93S22YHjaAvU7BH%2BdE1ahJAik4cvWVVPr8DUztjsw7AKUes%2FlvhhGWtZV3jr7HYmJuiutB0hywauCFFC6w8D"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "9220bda0-dda8-4535-b943-b137770223a9",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z2n8upl40jfhop",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "2971bdd2-7af9-45c8-bd74-838b599e349c",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "259"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 14:55:16 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              86,
              122,
              104,
              72,
              85,
              53,
              115,
              100,
              101,
              115,
              52,
              48,
              103,
              114,
              118,
              75,
              109,
              122,
              105,
              37,
              50,
              66,
              114,
              88,
              86,
              51,
              108,
              69,
              37,
              50,
              66,
              76,
              122,
              119,
              121,
              53,
              81,
              118,
              83,
              89,
              77,
              67,
              71,
              108,
              109,
              112,
              73,
              53,
              76,
              112,
              111,
              100,
              83,
              97,
              103,
              108,
              103,
              37,
              50,
              66,
              113,
              48,
              118,
              115,
              103,
              76,
              114,
              110,
              120,
              49,
              66,
              114,
              116,
              103,
              103,
              80,
              86,
              105,
              120,
              51,
              55,
              82,
              100,
              82,
              77,
              117,
              37,
              50,
              70,
              114,
              70,
              66,
              111,
              102,
              66,
              48,
              88,
              88,
              52,
              69,
              105,
              89,
              67,
              83,
              104,
              120,
              111,
              90,
              79,
              101,
              54,
              37,
              50,
              70,
              117,
              67,
              118,
              110,
              81,
              79,
              105,
              86,
              56,
              51,
              53,
              77,
              120,
              68,
              69,
              85,
              76,
              113,
              88,
              87,
              51,
              52,
              114,
              102,
              84,
              121,
              109,
              74,
              56,
              78,
              80,
              106,
              81,
              70,
              75,
              106,
              116,
              98,
              109,
              53,
              55,
              83,
              81,
              109,
              86,
              122,
              67,
              73,
              112,
              107,
              87,
              83,
              119,
              78,
              122,
              48,
              118,
              53,
              66,
              112,
              37,
              50,
              70,
              79,
              105,
              84,
              113,
              53,
              37,
              50,
              66,
              84,
              55,
              120,
              89,
              87,
              49,
              75,
              97,
              119,
              87,
              110,
              100,
              111,
              69,
              122,
              114,
              117,
              98,
              56,
              49,
              99,
              65,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1366,
          "responseSize": 259
        },
        "id": "ceb3098d-3291-4f29-9d1b-b75fc73f1939",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "취소 후 잔액(BALANCE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 원 거래 키(O_TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생시간(TRANTIME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생일자(TRANDATE)",
            "skipped": false
          },
          {
            "assertion": "승인 취소 금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "a2c0feff-21fc-4369-884c-9f63772e8263",
          "length": 21,
          "cycles": 1,
          "position": 11,
          "iteration": 0,
          "httpRequestId": "d26cd64e-970f-47aa-84e4-fb60541fa3fa"
        },
        "item": {
          "id": "fd2dcf9f-af25-465a-9df4-073847ddf2e7",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "ebdb6682-d35a-4007-8ef8-03b5fbbf564d",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC250804165745DBD04E'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "228dd815-eedf-4bfd-9eab-36a22f5574ca"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "d7c458db-7b60-4474-9f72-e08985004e52",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0300\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"540926******6041\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"국민카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"KB%B1%B9%B9%CE%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "590599e2-cdc0-4ce6-b5aa-fb5e81acad4b"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "wcpoTy27mkzR%2FoCmuhu%2BEL1VevUN6wQgs96fAg0NJdKChw9Ccm7hXXJcj%2FUGj%2Bb8z5dq8TvydwIj3RXPjUXi4KzQHH0ZG0DZA03Udge2eI0IsrkEsoTSxKLbYyq5iCvbykTt6GhW9hCDbp8fHC1zGJEYvBJNsjEqz2X9zw2JzccTXfPyWymzriWFq4iqdmp99Wj2bHxTvGvcdoWGjKzABQ%3D%3D"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "b26262a7-7a99-4f27-adb3-889fb7b48412",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z2n8upl40jfhop",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "1f848cad-7a71-4b4e-a9d4-076d06673d66",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "433"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 14:55:18 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              85,
              79,
              114,
              84,
              50,
              122,
              98,
              84,
              116,
              90,
              116,
              65,
              104,
              54,
              52,
              50,
              115,
              86,
              101,
              74,
              54,
              83,
              109,
              37,
              50,
              66,
              54,
              71,
              66,
              89,
              57,
              107,
              74,
              81,
              114,
              116,
              99,
              83,
              88,
              121,
              89,
              70,
              120,
              69,
              57,
              101,
              122,
              67,
              73,
              71,
              78,
              109,
              49,
              55,
              108,
              119,
              119,
              48,
              48,
              122,
              78,
              50,
              77,
              79,
              110,
              112,
              54,
              86,
              110,
              108,
              77,
              48,
              74,
              57,
              37,
              50,
              66,
              56,
              101,
              48,
              37,
              50,
              66,
              113,
              90,
              81,
              103,
              122,
              117,
              50,
              118,
              75,
              74,
              77,
              79,
              80,
              82,
              79,
              78,
              102,
              112,
              66,
              108,
              119,
              85,
              76,
              76,
              120,
              51,
              53,
              81,
              68,
              53,
              117,
              79,
              80,
              82,
              51,
              84,
              120,
              74,
              102,
              121,
              100,
              116,
              76,
              86,
              115,
              51,
              84,
              51,
              109,
              67,
              116,
              102,
              76,
              53,
              82,
              89,
              86,
              88,
              99,
              48,
              99,
              115,
              121,
              70,
              86,
              121,
              86,
              37,
              50,
              66,
              52,
              86,
              117,
              116,
              104,
              110,
              84,
              106,
              102,
              79,
              84,
              75,
              97,
              56,
              110,
              55,
              120,
              75,
              53,
              86,
              75,
              102,
              84,
              71,
              113,
              73,
              87,
              112,
              115,
              82,
              71,
              56,
              90,
              120,
              75,
              49,
              50,
              104,
              120,
              104,
              50,
              88,
              49,
              80,
              122,
              87,
              77,
              73,
              53,
              55,
              49,
              97,
              81,
              55,
              87,
              48,
              116,
              116,
              99,
              56,
              68,
              67,
              103,
              79,
              52,
              89,
              49,
              104,
              73,
              48,
              119,
              107,
              72,
              111,
              57,
              65,
              114,
              86,
              80,
              82,
              57,
              113,
              115,
              119,
              119,
              99,
              106,
              98,
              83,
              69,
              37,
              50,
              70,
              108,
              102,
              109,
              48,
              49,
              78,
              67,
              90,
              104,
              108,
              97,
              117,
              107,
              75,
              49,
              117,
              56,
              65,
              84,
              72,
              121,
              66,
              97,
              119,
              118,
              84,
              55,
              99,
              86,
              97,
              107,
              114,
              118,
              105,
              77,
              55,
              118,
              99,
              98,
              73,
              54,
              88,
              85,
              72,
              80,
              99,
              108,
              97,
              67,
              106,
              103,
              73,
              88,
              82,
              52,
              118,
              69,
              75,
              121,
              100,
              50,
              69,
              54,
              54,
              90,
              69,
              54,
              110,
              76,
              99,
              113,
              84,
              105,
              111,
              37,
              50,
              66,
              117,
              122,
              101,
              108,
              103,
              67,
              74,
              106,
              109,
              104,
              99,
              117,
              109,
              78,
              105,
              80,
              106,
              113,
              109,
              54,
              112,
              81,
              88,
              100,
              83,
              68,
              77,
              77,
              101,
              104,
              107,
              71,
              84,
              121,
              116,
              86,
              67,
              74,
              115,
              86,
              111,
              70,
              122,
              78,
              74,
              109,
              97,
              105,
              110,
              113,
              37,
              50,
              70,
              105,
              65,
              37,
              51,
              68,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1323,
          "responseSize": 433
        },
        "id": "fd2dcf9f-af25-465a-9df4-073847ddf2e7",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 코드(CARDCODE 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 전화번호(USERPHONE) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "할부 개월 수(QUOTA) 정상출력",
            "skipped": false
          },
          {
            "assertion": "매출 발생시간(TRANTIME) ±5초 이내 검증",
            "skipped": false
          },
          {
            "assertion": "매출 발생일자(TRANDATE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "상품명(ITEMNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "보증금 금액(DEPOSIT_AMT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "가맹점 주문번호(ORDERID) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "카드번호(CARDNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "거래 승인 번호(CARDAUTHNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 명(CARDNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 이름(USERNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 ID(USERID) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "84481aa1-0eea-44ec-8860-d69aec617bcf",
          "length": 21,
          "cycles": 1,
          "position": 12,
          "iteration": 0,
          "httpRequestId": "6fc2ac01-fe76-4beb-9a80-96f7dce9771d"
        },
        "item": {
          "id": "72f04035-28a5-4c1f-8bc3-2d8250163890",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "a1a0489c-9745-4aad-85c3-55c3ff2283a2",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "86d5935c-eaf7-4f32-b45e-6a9b21b6493e"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "2681b930-c73f-414b-9204-7370ac359985",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "7adcd1e6-fd99-4189-8e5a-46f702831840"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "8kvDIwvdID7NWcBMND4uDfygua0QcE6t2Mkxa5yiAhHI8nu4pppwlQq8Cyx%2FfdfLAHhwHx3RqUQmfNqqLSOncTNe2a0FbBhPLnyoR4ArsExBHB8AfRfdjmoALbT0iy9h"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "e8c23590-8039-4d3e-8029-338af396a9c0",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z2n8upl40jfhop",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "1e70a127-298c-4019-a71a-2b1da8ba1797",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "267"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 14:55:19 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              86,
              122,
              104,
              72,
              85,
              53,
              115,
              100,
              101,
              115,
              52,
              48,
              103,
              114,
              118,
              75,
              109,
              122,
              105,
              37,
              50,
              66,
              114,
              88,
              86,
              51,
              108,
              69,
              37,
              50,
              66,
              76,
              122,
              119,
              121,
              53,
              81,
              118,
              83,
              89,
              77,
              67,
              71,
              108,
              109,
              112,
              73,
              54,
              80,
              51,
              66,
              81,
              106,
              112,
              122,
              104,
              117,
              121,
              111,
              108,
              115,
              106,
              108,
              100,
              49,
              48,
              81,
              106,
              80,
              57,
              72,
              57,
              48,
              119,
              76,
              67,
              51,
              71,
              100,
              71,
              109,
              67,
              72,
              106,
              78,
              98,
              110,
              78,
              106,
              113,
              81,
              105,
              37,
              50,
              70,
              51,
              115,
              67,
              75,
              65,
              110,
              55,
              50,
              119,
              52,
              87,
              66,
              66,
              52,
              48,
              119,
              117,
              115,
              84,
              107,
              77,
              70,
              122,
              78,
              104,
              87,
              99,
              77,
              56,
              72,
              115,
              76,
              85,
              117,
              109,
              82,
              56,
              37,
              50,
              70,
              103,
              90,
              52,
              109,
              77,
              113,
              56,
              37,
              50,
              66,
              56,
              71,
              37,
              50,
              66,
              78,
              71,
              98,
              116,
              53,
              101,
              65,
              115,
              89,
              74,
              88,
              37,
              50,
              66,
              77,
              78,
              66,
              117,
              37,
              50,
              70,
              79,
              84,
              83,
              37,
              50,
              70,
              78,
              71,
              106,
              37,
              50,
              70,
              87,
              57,
              77,
              75,
              48,
              117,
              49,
              114,
              65,
              112,
              37,
              50,
              70,
              75,
              75,
              101,
              88,
              113,
              54,
              49,
              75,
              118,
              101,
              67,
              86,
              77,
              48,
              80,
              71,
              83,
              114,
              56,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1483,
          "responseSize": 267
        },
        "id": "72f04035-28a5-4c1f-8bc3-2d8250163890",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "취소 후 잔액(BALANCE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 원 거래 키(O_TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생시간(TRANTIME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생일자(TRANDATE)",
            "skipped": false
          },
          {
            "assertion": "승인 취소 금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "4aaa7604-0d9b-45b1-82b2-929e9752c356",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "d5431ec0-74b8-4d01-9c20-52b0f26109cd"
        },
        "item": {
          "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "wcpoTy27mkzR%2FoCmuhu%2BEL1VevUN6wQgs96fAg0NJdKChw9Ccm7hXXJcj%2FUGj%2Bb8z5dq8TvydwIj3RXPjUXi4KzQHH0ZG0DZA03Udge2eI0IsrkEsoTSxKLbYyq5iCvbykTt6GhW9hCDbp8fHC1zGJEYvBJNsjEqz2X9zw2JzccVRR%2FtepSx6ESumfhyCleVEPVKGpunFtzDUwUlJoNVsg%3D%3D"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "ed08418c-c6fd-48e5-aa7e-18d99f7a60b7",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z2n8upl40jfhop",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "61f31145-e7d6-41ed-8d3f-fed1a501a188",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "191"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 14:55:21 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              52,
              77,
              116,
              51,
              119,
              72,
              70,
              67,
              81,
              114,
              78,
              79,
              107,
              48,
              97,
              87,
              70,
              37,
              50,
              66,
              54,
              103,
              48,
              108,
              76,
              80,
              52,
              72,
              104,
              84,
              87,
              113,
              53,
              79,
              99,
              115,
              101,
              113,
              75,
              107,
              112,
              108,
              111,
              100,
              102,
              69,
              112,
              56,
              108,
              65,
              50,
              100,
              72,
              114,
              70,
              113,
              82,
              84,
              102,
              82,
              50,
              57,
              103,
              86,
              101,
              66,
              67,
              37,
              50,
              70,
              72,
              70,
              54,
              55,
              55,
              83,
              52,
              67,
              111,
              57,
              66,
              66,
              51,
              108,
              71,
              37,
              50,
              70,
              98,
              54,
              107,
              120,
              115,
              48,
              79,
              66,
              54,
              37,
              50,
              66,
              109,
              50,
              82,
              108,
              115,
              90,
              87,
              55,
              87,
              100,
              114,
              83,
              68,
              122,
              72,
              48,
              66,
              56,
              106,
              71,
              74,
              87,
              118,
              104,
              49,
              120,
              86,
              72,
              101,
              77,
              70,
              90,
              73,
              117,
              55,
              110,
              74,
              113,
              49,
              119,
              53,
              56,
              37,
              50,
              70,
              120,
              90,
              98,
              104,
              88,
              65,
              109,
              89,
              107,
              105,
              67,
              110,
              74,
              116,
              98,
              121,
              68,
              57,
              82,
              120,
              104,
              56,
              75,
              37,
              50,
              70,
              49,
              85,
              103,
              67,
              49,
              107,
              77,
              87,
              98,
              105,
              87,
              48,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1485,
          "responseSize": 191
        },
        "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "결과코드(RETURNCODE) 정상출력",
              "message": "expected '3143' to deeply equal '0000'",
              "stack": "AssertionError: expected '3143' to deeply equal '0000'\n   at Object.eval sandbox-script.js:1:14)"
            }
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 1,
              "test": "결과메세지(RETURNMSG) 정상출력",
              "message": "expected '%C4%AB%B5%E5%BB%E7+%B9%AE%C0%C7+%B9%D…' to deeply equal '%BC%BA%B0%F8'",
              "stack": "AssertionError: expected '%C4%AB%B5%E5%BB%E7+%B9%AE%C0%C7+%B9%D…' to deeply equal '%BC%BA%B0%F8'\n   at Object.eval sandbox-script.js:2:14)"
            }
          },
          {
            "assertion": "카드사 코드(CARDCODE 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 2,
              "test": "카드사 코드(CARDCODE 정상출력",
              "message": "expected undefined to deeply equal '0202'",
              "stack": "AssertionError: expected undefined to deeply equal '0202'\n   at Object.eval sandbox-script.js:3:14)"
            }
          },
          {
            "assertion": "구매자 전화번호(USERPHONE) 빈값 확인",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 3,
              "test": "구매자 전화번호(USERPHONE) 빈값 확인",
              "message": ".empty was passed non-string primitive undefined",
              "stack": "AssertionError: .empty was passed non-string primitive undefined\n   at Object.eval sandbox-script.js:4:14)"
            }
          },
          {
            "assertion": "할부 개월 수(QUOTA) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 4,
              "test": "할부 개월 수(QUOTA) 정상출력",
              "message": "expected undefined to deeply equal '00'",
              "stack": "AssertionError: expected undefined to deeply equal '00'\n   at Object.eval sandbox-script.js:5:14)"
            }
          },
          {
            "assertion": "매출 발생시간(TRANTIME) ±5초 이내 검증",
            "skipped": false,
            "error": {
              "name": "TypeError",
              "index": 5,
              "test": "매출 발생시간(TRANTIME) ±5초 이내 검증",
              "message": "Cannot read properties of undefined (reading 'slice')",
              "stack": "TypeError: Cannot read properties of undefined (reading 'slice')\n   at Object.eval sandbox-script.js:6:14)"
            }
          },
          {
            "assertion": "매출 발생일자(TRANDATE) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 6,
              "test": "매출 발생일자(TRANDATE) 정상출력",
              "message": "expected undefined to deeply equal '20260106'",
              "stack": "AssertionError: expected undefined to deeply equal '20260106'\n   at Object.eval sandbox-script.js:7:14)"
            }
          },
          {
            "assertion": "승인금액(AMOUNT) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 7,
              "test": "승인금액(AMOUNT) 정상출력",
              "message": "expected undefined to deeply equal '301'",
              "stack": "AssertionError: expected undefined to deeply equal '301'\n   at Object.eval sandbox-script.js:8:14)"
            }
          },
          {
            "assertion": "상품명(ITEMNAME) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 8,
              "test": "상품명(ITEMNAME) 정상출력",
              "message": "expected undefined to deeply equal 'apiautotest'",
              "stack": "AssertionError: expected undefined to deeply equal 'apiautotest'\n   at Object.eval sandbox-script.js:9:14)"
            }
          },
          {
            "assertion": "보증금 금액(DEPOSIT_AMT) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 9,
              "test": "보증금 금액(DEPOSIT_AMT) 정상출력",
              "message": "expected undefined to deeply equal '0'",
              "stack": "AssertionError: expected undefined to deeply equal '0'\n   at Object.eval sandbox-script.js:10:14)"
            }
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "가맹점 주문번호(ORDERID) 빈값 확인",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 11,
              "test": "가맹점 주문번호(ORDERID) 빈값 확인",
              "message": ".empty was passed non-string primitive undefined",
              "stack": "AssertionError: .empty was passed non-string primitive undefined\n   at Object.eval sandbox-script.js:12:14)"
            }
          },
          {
            "assertion": "카드번호(CARDNO) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 12,
              "test": "카드번호(CARDNO) 정상출력",
              "message": "expected undefined to deeply equal '538920******1226'",
              "stack": "AssertionError: expected undefined to deeply equal '538920******1226'\n   at Object.eval sandbox-script.js:13:14)"
            }
          },
          {
            "assertion": "거래 승인 번호(CARDAUTHNO) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 13,
              "test": "거래 승인 번호(CARDAUTHNO) 정상출력",
              "message": "expected undefined to exist",
              "stack": "AssertionError: expected undefined to exist\n   at Object.eval sandbox-script.js:14:14)"
            }
          },
          {
            "assertion": "카드사 명(CARDNAME) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 14,
              "test": "카드사 명(CARDNAME) 정상출력",
              "message": "expected undefined to deeply equal '%BF%EC%B8%AEBC%C4%AB%B5%E5'",
              "stack": "AssertionError: expected undefined to deeply equal '%BF%EC%B8%AEBC%C4%AB%B5%E5'\n   at Object.eval sandbox-script.js:15:14)"
            }
          },
          {
            "assertion": "구매자 이름(USERNAME) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 15,
              "test": "구매자 이름(USERNAME) 정상출력",
              "message": ".empty was passed non-string primitive undefined",
              "stack": "AssertionError: .empty was passed non-string primitive undefined\n   at Object.eval sandbox-script.js:16:14)"
            }
          },
          {
            "assertion": "구매자 ID(USERID) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 16,
              "test": "구매자 ID(USERID) 정상출력",
              "message": "expected undefined to deeply equal 'hnkim'",
              "stack": "AssertionError: expected undefined to deeply equal 'hnkim'\n   at Object.eval sandbox-script.js:17:14)"
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "939f08d6-5e83-4f85-aff1-a4c78dd3675c",
          "length": 21,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "3f1a4b62-b7ee-4a87-8f4f-997fda7c125b"
        },
        "item": {
          "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "8kvDIwvdID7NWcBMND4uDeLP%2BAXfeWREwcy8%2F025hsM9oC2AahAslwkrxLgW5jk8qXiKKz4zHbIJeYXfjThwg7AEcnmqg50fN4Vu2Q1pMMvawSesRaO5swzAlpFfIlx1"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "2720bca1-e7c3-441b-8a52-60604a788166",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z2n8upl40jfhop",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "b041d2bb-c1aa-433a-a436-b1c375baebee",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "171"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 14:55:21 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              117,
              116,
              54,
              112,
              83,
              71,
              103,
              117,
              114,
              77,
              87,
              72,
              51,
              111,
              50,
              79,
              119,
              103,
              75,
              85,
              116,
              121,
              66,
              108,
              73,
              67,
              74,
              117,
              120,
              67,
              117,
              75,
              109,
              115,
              52,
              55,
              76,
              118,
              79,
              80,
              76,
              51,
              116,
              107,
              73,
              76,
              116,
              76,
              119,
              81,
              100,
              89,
              89,
              77,
              90,
              98,
              70,
              107,
              110,
              67,
              69,
              80,
              119,
              76,
              69,
              68,
              102,
              111,
              37,
              50,
              70,
              78,
              97,
              71,
              37,
              50,
              66,
              116,
              52,
              81,
              114,
              106,
              87,
              99,
              117,
              78,
              110,
              83,
              81,
              48,
              71,
              89,
              71,
              69,
              90,
              117,
              73,
              37,
              50,
              66,
              71,
              69,
              67,
              116,
              116,
              116,
              101,
              89,
              114,
              82,
              65,
              97,
              100,
              110,
              78,
              77,
              97,
              87,
              118,
              100,
              79,
              98,
              112,
              87,
              37,
              50,
              66,
              97,
              52,
              73,
              78,
              118,
              72,
              80,
              83,
              57,
              88,
              102,
              122,
              74,
              102,
              77,
              65,
              119,
              109,
              82,
              72,
              37,
              50,
              70,
              48,
              118,
              51,
              80,
              116,
              85,
              82,
              83,
              105,
              65,
              37,
              51,
              68,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 194,
          "responseSize": 171
        },
        "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "결과코드(RETURNCODE) 정상출력",
              "message": "expected '1117' to deeply equal '0000'",
              "stack": "AssertionError: expected '1117' to deeply equal '0000'\n   at Object.eval sandbox-script.js:1:15)"
            }
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 1,
              "test": "결과메세지(RETURNMSG) 정상출력",
              "message": "expected '%BF%F8%B0%C5%B7%A1%B0%C7%C0%CC+%C1%B8…' to deeply equal '%BC%BA%B0%F8'",
              "stack": "AssertionError: expected '%BF%F8%B0%C5%B7%A1%B0%C7%C0%CC+%C1%B8…' to deeply equal '%BC%BA%B0%F8'\n   at Object.eval sandbox-script.js:2:15)"
            }
          },
          {
            "assertion": "취소 후 잔액(BALANCE) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 2,
              "test": "취소 후 잔액(BALANCE) 정상출력",
              "message": "expected undefined to deeply equal '0'",
              "stack": "AssertionError: expected undefined to deeply equal '0'\n   at Object.eval sandbox-script.js:3:15)"
            }
          },
          {
            "assertion": "다날 원 거래 키(O_TID) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 3,
              "test": "다날 원 거래 키(O_TID) 정상출력",
              "message": "expected undefined not to be undefined",
              "stack": "AssertionError: expected undefined not to be undefined\n   at Object.eval sandbox-script.js:4:15)"
            }
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 4,
              "test": "다날 거래 키(TID) 정상출력",
              "message": "expected undefined not to be undefined",
              "stack": "AssertionError: expected undefined not to be undefined\n   at Object.eval sandbox-script.js:5:15)"
            }
          },
          {
            "assertion": "승인 발생시간(TRANTIME) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 5,
              "test": "승인 발생시간(TRANTIME) 정상출력",
              "message": "expected undefined to deeply equal null",
              "stack": "AssertionError: expected undefined to deeply equal null\n   at Object.eval sandbox-script.js:6:15)"
            }
          },
          {
            "assertion": "승인 발생일자(TRANDATE)",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 6,
              "test": "승인 발생일자(TRANDATE)",
              "message": "expected undefined to deeply equal '20260106'",
              "stack": "AssertionError: expected undefined to deeply equal '20260106'\n   at Object.eval sandbox-script.js:7:15)"
            }
          },
          {
            "assertion": "승인 취소 금액(AMOUNT) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 7,
              "test": "승인 취소 금액(AMOUNT) 정상출력",
              "message": "expected undefined to deeply equal '301'",
              "stack": "AssertionError: expected undefined to deeply equal '301'\n   at Object.eval sandbox-script.js:8:15)"
            }
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 8,
              "test": "컵 보증금(DEPOSIT_AMT) 정상출력",
              "message": "expected undefined to deeply equal '0'",
              "stack": "AssertionError: expected undefined to deeply equal '0'\n   at Object.eval sandbox-script.js:9:15)"
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "66a9285f-9d14-4c83-8d69-cc77ca79db32",
          "length": 21,
          "cycles": 1,
          "position": 15,
          "iteration": 0,
          "httpRequestId": "021487a5-d24b-437b-b32a-552bb876fc7b"
        },
        "item": {
          "id": "fdce8072-d7d0-4a32-9c82-e7db14f56287",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "c1519496-0a1b-4576-a02f-b0e258e4f4ef",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC251215145003CEDD72'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "afa23430-048b-4c91-974c-d32e1d631e1e"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "28aae2d8-4337-49f7-8c50-bfa635db450f",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0907\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"624404******8380\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"롯데카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AE%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "4051c384-dbc4-442a-b26c-5c7d50b3cdbd"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "wcpoTy27mkzR%2FoCmuhu%2BEL1VevUN6wQgs96fAg0NJdKChw9Ccm7hXXJcj%2FUGj%2Bb8z5dq8TvydwIj3RXPjUXi4KzQHH0ZG0DZA03Udge2eI0IsrkEsoTSxKLbYyq5iCvbykTt6GhW9hCDbp8fHC1zGJEYvBJNsjEqz2X9zw2JzcextrJriQhf%2FIUYtULhB8bH62Qdp0SGru%2BMd63vyNOLHA%3D%3D"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "aee60246-1115-4dc0-874c-62cf61aba59a",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z2n8upl40jfhop",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "603f7cfe-acb5-418d-9f48-db4e062e2384",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "439"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 14:55:22 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              85,
              79,
              114,
              84,
              50,
              122,
              98,
              84,
              116,
              90,
              116,
              65,
              104,
              54,
              52,
              50,
              115,
              86,
              101,
              74,
              54,
              83,
              67,
              69,
              86,
              56,
              88,
              48,
              116,
              51,
              118,
              77,
              102,
              108,
              57,
              65,
              84,
              99,
              48,
              69,
              103,
              77,
              86,
              103,
              115,
              37,
              50,
              66,
              83,
              101,
              50,
              37,
              50,
              66,
              77,
              83,
              68,
              103,
              54,
              37,
              50,
              70,
              71,
              37,
              50,
              70,
              104,
              97,
              117,
              48,
              73,
              72,
              66,
              37,
              50,
              66,
              68,
              117,
              66,
              51,
              118,
              97,
              74,
              119,
              53,
              78,
              98,
              103,
              56,
              67,
              49,
              119,
              88,
              121,
              87,
              115,
              112,
              71,
              55,
              56,
              74,
              89,
              75,
              76,
              112,
              101,
              49,
              118,
              99,
              107,
              86,
              120,
              76,
              57,
              110,
              54,
              121,
              98,
              68,
              87,
              102,
              104,
              116,
              119,
              122,
              115,
              112,
              81,
              73,
              57,
              118,
              109,
              48,
              116,
              99,
              80,
              114,
              89,
              106,
              54,
              116,
              69,
              67,
              97,
              90,
              67,
              67,
              87,
              98,
              89,
              82,
              114,
              48,
              115,
              72,
              67,
              65,
              89,
              111,
              65,
              103,
              72,
              66,
              73,
              104,
              114,
              76,
              54,
              75,
              89,
              56,
              87,
              48,
              70,
              90,
              116,
              53,
              99,
              37,
              50,
              70,
              86,
              89,
              76,
              37,
              50,
              70,
              88,
              89,
              56,
              103,
              90,
              120,
              90,
              102,
              52,
              81,
              79,
              73,
              79,
              71,
              106,
              106,
              55,
              98,
              51,
              85,
              82,
              105,
              54,
              76,
              87,
              53,
              56,
              101,
              57,
              103,
              70,
              111,
              100,
              84,
              85,
              74,
              89,
              55,
              53,
              84,
              118,
              99,
              101,
              110,
              100,
              50,
              67,
              109,
              70,
              56,
              84,
              87,
              81,
              103,
              68,
              83,
              50,
              56,
              53,
              51,
              97,
              90,
              68,
              54,
              66,
              100,
              51,
              55,
              117,
              78,
              117,
              111,
              119,
              75,
              121,
              117,
              48,
              72,
              70,
              37,
              50,
              70,
              53,
              68,
              113,
              79,
              83,
              77,
              67,
              56,
              87,
              71,
              56,
              90,
              97,
              115,
              122,
              79,
              73,
              72,
              112,
              77,
              55,
              101,
              83,
              67,
              99,
              115,
              66,
              84,
              106,
              104,
              99,
              79,
              109,
              80,
              78,
              74,
              77,
              99,
              53,
              99,
              100,
              120,
              37,
              50,
              70,
              57,
              120,
              68,
              37,
              50,
              70,
              103,
              81,
              98,
              119,
              83,
              84,
              97,
              76,
              114,
              81,
              106,
              51,
              111,
              54,
              83,
              82,
              54,
              115,
              103,
              81,
              67,
              109,
              86,
              89,
              79,
              85,
              112,
              79,
              84,
              68,
              76,
              48,
              73,
              71,
              102,
              82,
              86,
              76,
              88,
              54,
              118,
              84,
              108,
              98,
              112,
              100,
              66,
              73,
              80,
              110,
              97,
              119,
              82,
              85,
              51,
              53,
              88,
              67,
              117,
              100,
              69,
              116,
              52,
              119,
              37,
              51,
              68,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1282,
          "responseSize": 439
        },
        "id": "fdce8072-d7d0-4a32-9c82-e7db14f56287",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 코드(CARDCODE 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 전화번호(USERPHONE) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "할부 개월 수(QUOTA) 정상출력",
            "skipped": false
          },
          {
            "assertion": "매출 발생시간(TRANTIME) ±5초 이내 검증",
            "skipped": false
          },
          {
            "assertion": "매출 발생일자(TRANDATE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "상품명(ITEMNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "보증금 금액(DEPOSIT_AMT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "가맹점 주문번호(ORDERID) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "카드번호(CARDNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "거래 승인 번호(CARDAUTHNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 명(CARDNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 이름(USERNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 ID(USERID) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "8cbf687c-83a4-4777-a8b6-15f90f70c4fa",
          "length": 21,
          "cycles": 1,
          "position": 16,
          "iteration": 0,
          "httpRequestId": "237a6f10-d818-4202-b91a-f01a8e369b63"
        },
        "item": {
          "id": "eb18c1f3-8027-4d97-8b56-63cd51106c3f",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "2ce0446a-bd2a-48cb-8cda-95a7bc50ff23",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "967a321c-207e-433d-a9b0-5a7a74e58a50"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "bf94c695-8ea4-46ec-b2bf-17fff95e9b67",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "c2b6adb9-0c0d-4f44-8ca2-95ffeabdffec"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "8kvDIwvdID7NWcBMND4uDYrhUTVKkOsKNmhGVn%2B6j%2BgnLd0r972E35HulrNL3kigxYRTjiiM%2BNqrVv33KQwdF%2F08ORbjebSryQcFtJvE0Xcf6zgozJMJ0H6Fy9Yiw%2B%2FA"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "55d07278-0f31-468f-8a70-28e749c724f4",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z2n8upl40jfhop",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "85f72c95-bcd9-45ec-866d-213d90a1460d",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "261"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 14:55:24 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              86,
              122,
              104,
              72,
              85,
              53,
              115,
              100,
              101,
              115,
              52,
              48,
              103,
              114,
              118,
              75,
              109,
              122,
              105,
              37,
              50,
              66,
              114,
              88,
              86,
              51,
              108,
              69,
              37,
              50,
              66,
              76,
              122,
              119,
              121,
              53,
              81,
              118,
              83,
              89,
              77,
              67,
              71,
              108,
              109,
              112,
              73,
              51,
              37,
              50,
              66,
              121,
              100,
              68,
              117,
              89,
              70,
              100,
              97,
              99,
              113,
              113,
              37,
              50,
              66,
              104,
              105,
              78,
              109,
              99,
              107,
              116,
              81,
              52,
              54,
              97,
              68,
              103,
              74,
              71,
              57,
              76,
              103,
              81,
              90,
              56,
              122,
              81,
              108,
              75,
              77,
              87,
              37,
              50,
              66,
              79,
              114,
              117,
              37,
              50,
              70,
              114,
              50,
              74,
              90,
              112,
              50,
              106,
              79,
              37,
              50,
              70,
              89,
              72,
              98,
              108,
              109,
              56,
              76,
              84,
              76,
              84,
              81,
              79,
              69,
              115,
              79,
              87,
              107,
              67,
              72,
              77,
              98,
              97,
              82,
              81,
              71,
              67,
              37,
              50,
              70,
              87,
              85,
              71,
              105,
              53,
              69,
              115,
              104,
              76,
              121,
              77,
              75,
              84,
              54,
              117,
              56,
              50,
              84,
              49,
              97,
              104,
              105,
              77,
              101,
              111,
              121,
              50,
              67,
              115,
              78,
              101,
              98,
              74,
              118,
              109,
              79,
              106,
              66,
              52,
              121,
              110,
              103,
              107,
              108,
              50,
              77,
              82,
              67,
              120,
              105,
              80,
              106,
              87,
              75,
              67,
              109,
              68,
              67,
              49,
              118,
              102,
              71,
              101,
              81,
              117,
              89,
              118,
              73,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1342,
          "responseSize": 261
        },
        "id": "eb18c1f3-8027-4d97-8b56-63cd51106c3f",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "취소 후 잔액(BALANCE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 원 거래 키(O_TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생시간(TRANTIME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생일자(TRANDATE)",
            "skipped": false
          },
          {
            "assertion": "승인 취소 금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "15da92b4-7baf-49af-a2f2-d5b8d3c75c69",
          "length": 21,
          "cycles": 1,
          "position": 17,
          "iteration": 0,
          "httpRequestId": "2dde592b-8d17-4542-bea8-c0389caabb58"
        },
        "item": {
          "id": "dc9f9937-00de-4540-b447-2dbfc52dc976",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "de0ade1e-9508-4069-a64c-9d2c2b6b68c9",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25121515231344D775'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "145b5742-9ea9-4c92-80b5-dbfff2f9616d"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "b17031d0-5d0e-45fb-b0d7-0f715860ec04",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0921\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"485462******0767\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%C4%C9%C0%CC%B9%F0%C5%A9%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "b2ef3b55-65ca-4fa4-839d-4afb298decd6"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "wcpoTy27mkzR%2FoCmuhu%2BEL1VevUN6wQgs96fAg0NJdKChw9Ccm7hXXJcj%2FUGj%2Bb8z5dq8TvydwIj3RXPjUXi4KzQHH0ZG0DZA03Udge2eI0IsrkEsoTSxKLbYyq5iCvbykTt6GhW9hCDbp8fHC1zGJEYvBJNsjEqz2X9zw2JzccQmxP3XnXAnB6A1V7j6yFer%2BQE%2Ba1pl7pMnq93f1iTpw%3D%3D"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "4d3ea2c3-2768-4e45-8227-f2ced9d6808d",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z2n8upl40jfhop",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "49664cab-486e-47c1-b32e-7a7ebd088400",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "435"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 14:55:25 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              85,
              79,
              114,
              84,
              50,
              122,
              98,
              84,
              116,
              90,
              116,
              65,
              104,
              54,
              52,
              50,
              115,
              86,
              101,
              74,
              54,
              83,
              105,
              110,
              68,
              107,
              89,
              110,
              57,
              105,
              111,
              74,
              115,
              68,
              56,
              111,
              102,
              101,
              113,
              105,
              120,
              97,
              90,
              104,
              97,
              102,
              103,
              86,
              122,
              82,
              84,
              70,
              80,
              37,
              50,
              70,
              103,
              67,
              67,
              70,
              120,
              86,
              83,
              37,
              50,
              70,
              109,
              71,
              98,
              65,
              86,
              37,
              50,
              66,
              83,
              72,
              85,
              48,
              114,
              90,
              117,
              65,
              108,
              100,
              117,
              73,
              48,
              88,
              100,
              82,
              72,
              50,
              80,
              53,
              87,
              75,
              110,
              69,
              110,
              83,
              70,
              81,
              109,
              109,
              114,
              122,
              54,
              118,
              50,
              65,
              50,
              85,
              85,
              77,
              72,
              50,
              80,
              117,
              90,
              65,
              72,
              106,
              68,
              122,
              57,
              66,
              82,
              65,
              80,
              75,
              73,
              86,
              67,
              109,
              75,
              69,
              76,
              82,
              115,
              50,
              113,
              77,
              81,
              79,
              102,
              55,
              87,
              107,
              87,
              72,
              101,
              87,
              70,
              79,
              97,
              107,
              103,
              71,
              88,
              54,
              97,
              98,
              100,
              82,
              118,
              112,
              53,
              107,
              78,
              119,
              77,
              89,
              83,
              54,
              103,
              85,
              117,
              111,
              70,
              121,
              111,
              98,
              114,
              57,
              111,
              106,
              118,
              106,
              67,
              109,
              78,
              105,
              75,
              48,
              65,
              117,
              49,
              52,
              83,
              105,
              113,
              101,
              71,
              121,
              56,
              107,
              87,
              75,
              107,
              67,
              104,
              51,
              98,
              88,
              85,
              74,
              49,
              76,
              65,
              113,
              86,
              56,
              114,
              109,
              48,
              116,
              97,
              101,
              80,
              90,
              87,
              111,
              99,
              57,
              106,
              84,
              114,
              68,
              118,
              89,
              108,
              53,
              106,
              111,
              99,
              86,
              51,
              119,
              85,
              52,
              65,
              51,
              88,
              97,
              56,
              48,
              49,
              109,
              78,
              118,
              48,
              50,
              84,
              88,
              122,
              115,
              70,
              118,
              85,
              51,
              105,
              70,
              53,
              81,
              102,
              101,
              83,
              108,
              97,
              106,
              107,
              53,
              105,
              101,
              88,
              86,
              115,
              117,
              108,
              102,
              88,
              121,
              67,
              80,
              56,
              72,
              82,
              50,
              90,
              105,
              120,
              52,
              75,
              107,
              120,
              51,
              75,
              73,
              37,
              50,
              66,
              78,
              51,
              81,
              70,
              78,
              50,
              122,
              113,
              70,
              114,
              90,
              65,
              48,
              111,
              68,
              65,
              85,
              116,
              76,
              48,
              55,
              104,
              72,
              52,
              83,
              112,
              90,
              101,
              68,
              37,
              50,
              70,
              90,
              116,
              90,
              87,
              68,
              76,
              122,
              106,
              116,
              37,
              50,
              66,
              121,
              101,
              57,
              108,
              103,
              121,
              112,
              107,
              53,
              86,
              74,
              117,
              51,
              66,
              88,
              37,
              50,
              70,
              119,
              54,
              37,
              50,
              66,
              55,
              103,
              37,
              51,
              68,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1601,
          "responseSize": 435
        },
        "id": "dc9f9937-00de-4540-b447-2dbfc52dc976",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 코드(CARDCODE 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 전화번호(USERPHONE) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "할부 개월 수(QUOTA) 정상출력",
            "skipped": false
          },
          {
            "assertion": "매출 발생시간(TRANTIME) ±5초 이내 검증",
            "skipped": false
          },
          {
            "assertion": "매출 발생일자(TRANDATE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "상품명(ITEMNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "보증금 금액(DEPOSIT_AMT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "가맹점 주문번호(ORDERID) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "카드번호(CARDNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "거래 승인 번호(CARDAUTHNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 명(CARDNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 이름(USERNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 ID(USERID) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "1da8eb62-bdb1-478c-8528-02e9df57e6ab",
          "length": 21,
          "cycles": 1,
          "position": 18,
          "iteration": 0,
          "httpRequestId": "24e76cbe-5600-4dfb-ad82-3bfaf8861cd2"
        },
        "item": {
          "id": "d4a0107d-8d2a-4e04-b627-fad65ea23b0a",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "9e064d58-d2ab-4f80-9fd8-d154fc61e281",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "ccf81d91-716e-4aad-8932-cdc13d3587e7"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "96208ba8-439c-4017-966d-546d8704962a",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "6eb2f005-3ede-423d-b3cf-c3aeb2b4d225"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "8kvDIwvdID7NWcBMND4uDTt6W9lx1aEoDi2s612zAZLb%2FF8qnyuWNxImTNvwcb9SgY5ElyvN0Xx9No12dBq8BJ1dhHJBjeHMTyvb23%2BVTZnugI7YAamnDjLnvHYJFfEH"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "a2670c3e-83c4-45a7-9e29-f2a588a578b5",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z2n8upl40jfhop",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "91de7453-5191-4477-9b9b-2d72ab8e575f",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "267"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 14:55:28 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              86,
              122,
              104,
              72,
              85,
              53,
              115,
              100,
              101,
              115,
              52,
              48,
              103,
              114,
              118,
              75,
              109,
              122,
              105,
              37,
              50,
              66,
              114,
              88,
              86,
              51,
              108,
              69,
              37,
              50,
              66,
              76,
              122,
              119,
              121,
              53,
              81,
              118,
              83,
              89,
              77,
              67,
              71,
              108,
              109,
              112,
              73,
              37,
              50,
              70,
              68,
              89,
              119,
              90,
              53,
              105,
              121,
              118,
              104,
              49,
              101,
              67,
              108,
              90,
              84,
              105,
              85,
              84,
              99,
              50,
              48,
              75,
              98,
              103,
              51,
              77,
              79,
              49,
              107,
              66,
              48,
              79,
              77,
              57,
              89,
              69,
              80,
              57,
              83,
              65,
              101,
              77,
              37,
              50,
              66,
              104,
              37,
              50,
              66,
              104,
              51,
              86,
              109,
              113,
              85,
              73,
              89,
              114,
              76,
              86,
              105,
              75,
              83,
              69,
              84,
              67,
              117,
              85,
              120,
              98,
              79,
              98,
              97,
              87,
              75,
              68,
              37,
              50,
              70,
              84,
              121,
              99,
              72,
              98,
              89,
              37,
              50,
              70,
              115,
              53,
              67,
              117,
              78,
              85,
              37,
              50,
              70,
              97,
              108,
              52,
              79,
              106,
              115,
              68,
              97,
              83,
              90,
              108,
              51,
              103,
              107,
              122,
              37,
              50,
              70,
              86,
              78,
              89,
              114,
              114,
              55,
              88,
              105,
              106,
              114,
              103,
              101,
              116,
              108,
              87,
              90,
              70,
              115,
              85,
              53,
              84,
              99,
              68,
              51,
              72,
              105,
              49,
              122,
              88,
              120,
              81,
              37,
              50,
              66,
              78,
              52,
              72,
              72,
              74,
              104,
              103,
              67,
              56,
              121,
              49,
              37,
              50,
              70,
              110,
              103,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1343,
          "responseSize": 267
        },
        "id": "d4a0107d-8d2a-4e04-b627-fad65ea23b0a",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "취소 후 잔액(BALANCE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 원 거래 키(O_TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생시간(TRANTIME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생일자(TRANDATE)",
            "skipped": false
          },
          {
            "assertion": "승인 취소 금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "9d746735-3a35-4fa4-b510-776b5be67c66",
          "length": 21,
          "cycles": 1,
          "position": 19,
          "iteration": 0,
          "httpRequestId": "e7566763-43b2-4022-9bc2-f8fe0db6a4eb"
        },
        "item": {
          "id": "600fc975-e106-4be8-8c9c-1abe776705c7",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "b8e44806-4fc9-43e8-a08a-d42e00d0041a",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC2512151453119224E3'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "27343864-c219-4e1f-9c4b-262bdfbbdeea"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "18d9da3a-d705-4913-a0ed-154c858a2972",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0700\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"513792******3380\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"롯데카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%B7%D4%B5%A5%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "bebae3e1-c957-4966-a200-083ef93a2862"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "wcpoTy27mkzR%2FoCmuhu%2BEL1VevUN6wQgs96fAg0NJdKChw9Ccm7hXXJcj%2FUGj%2Bb8z5dq8TvydwIj3RXPjUXi4KzQHH0ZG0DZA03Udge2eI0IsrkEsoTSxKLbYyq5iCvbykTt6GhW9hCDbp8fHC1zGJEYvBJNsjEqz2X9zw2JzcfDPdPuA9czR8Lb0T%2Ba0ODlNEPIdgayTwp7V1JVXixp1g%3D%3D"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "fe6c06ce-1c65-402e-baad-fdaa4b65386c",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z2n8upl40jfhop",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "6bf4fe48-dde7-4f58-88d3-f89abe31326e",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "439"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 14:55:29 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              85,
              79,
              114,
              84,
              50,
              122,
              98,
              84,
              116,
              90,
              116,
              65,
              104,
              54,
              52,
              50,
              115,
              86,
              101,
              74,
              54,
              83,
              116,
              115,
              67,
              83,
              76,
              81,
              114,
              72,
              89,
              56,
              55,
              101,
              99,
              98,
              52,
              66,
              83,
              55,
              77,
              57,
              87,
              79,
              55,
              51,
              68,
              55,
              111,
              100,
              37,
              50,
              66,
              74,
              83,
              119,
              107,
              70,
              110,
              106,
              115,
              76,
              82,
              115,
              110,
              73,
              97,
              79,
              71,
              76,
              82,
              101,
              98,
              84,
              66,
              104,
              121,
              86,
              51,
              78,
              88,
              85,
              50,
              112,
              89,
              66,
              53,
              69,
              119,
              37,
              50,
              70,
              113,
              98,
              76,
              115,
              121,
              86,
              121,
              117,
              78,
              52,
              113,
              67,
              52,
              80,
              105,
              66,
              72,
              52,
              122,
              110,
              113,
              101,
              78,
              84,
              37,
              50,
              70,
              85,
              37,
              50,
              66,
              104,
              108,
              111,
              109,
              100,
              52,
              71,
              100,
              121,
              51,
              111,
              102,
              82,
              107,
              76,
              114,
              71,
              114,
              67,
              56,
              121,
              57,
              102,
              37,
              50,
              66,
              80,
              71,
              98,
              69,
              99,
              98,
              72,
              101,
              86,
              65,
              86,
              104,
              76,
              74,
              121,
              105,
              66,
              100,
              97,
              50,
              52,
              69,
              86,
              111,
              108,
              65,
              82,
              66,
              75,
              79,
              57,
              116,
              120,
              115,
              98,
              80,
              110,
              112,
              77,
              114,
              86,
              88,
              56,
              70,
              66,
              82,
              117,
              98,
              74,
              48,
              80,
              76,
              55,
              109,
              50,
              86,
              88,
              102,
              79,
              74,
              52,
              119,
              37,
              50,
              66,
              89,
              67,
              52,
              69,
              119,
              49,
              97,
              98,
              90,
              71,
              78,
              48,
              112,
              57,
              49,
              73,
              76,
              100,
              37,
              50,
              70,
              68,
              116,
              120,
              54,
              76,
              55,
              83,
              103,
              83,
              107,
              88,
              108,
              50,
              110,
              106,
              78,
              51,
              105,
              121,
              89,
              87,
              72,
              73,
              83,
              115,
              102,
              85,
              78,
              113,
              67,
              122,
              54,
              100,
              90,
              51,
              77,
              65,
              117,
              118,
              110,
              120,
              120,
              86,
              73,
              120,
              110,
              114,
              55,
              53,
              83,
              52,
              57,
              115,
              77,
              57,
              68,
              103,
              69,
              76,
              97,
              48,
              53,
              87,
              57,
              90,
              54,
              115,
              97,
              104,
              52,
              50,
              119,
              100,
              71,
              106,
              100,
              52,
              52,
              98,
              78,
              51,
              107,
              90,
              108,
              71,
              107,
              121,
              53,
              48,
              104,
              117,
              67,
              106,
              101,
              37,
              50,
              70,
              57,
              117,
              56,
              68,
              76,
              55,
              105,
              68,
              108,
              117,
              56,
              85,
              57,
              85,
              108,
              114,
              111,
              66,
              53,
              108,
              72,
              81,
              56,
              122,
              53,
              57,
              87,
              112,
              66,
              48,
              37,
              50,
              70,
              105,
              105,
              113,
              105,
              101,
              71,
              80,
              54,
              90,
              107,
              77,
              72,
              71,
              37,
              50,
              66,
              101,
              89,
              119,
              37,
              51,
              68,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1253,
          "responseSize": 439
        },
        "id": "600fc975-e106-4be8-8c9c-1abe776705c7",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 코드(CARDCODE 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 전화번호(USERPHONE) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "할부 개월 수(QUOTA) 정상출력",
            "skipped": false
          },
          {
            "assertion": "매출 발생시간(TRANTIME) ±5초 이내 검증",
            "skipped": false
          },
          {
            "assertion": "매출 발생일자(TRANDATE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "상품명(ITEMNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "보증금 금액(DEPOSIT_AMT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "가맹점 주문번호(ORDERID) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "카드번호(CARDNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "거래 승인 번호(CARDAUTHNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 명(CARDNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 이름(USERNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 ID(USERID) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "886dd89d-5da5-4684-bdf2-b1bcd53fa1e7",
          "length": 21,
          "cycles": 1,
          "position": 20,
          "iteration": 0,
          "httpRequestId": "9cd08e68-77fc-4deb-bcd1-7e9a1ea5f4d3"
        },
        "item": {
          "id": "2f29d6cd-a7af-4456-9eca-993414d84b4f",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "8f5aacad-52f0-49aa-bf17-3ed4f3f4adf6",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "6672df75-398d-4dbb-b2d0-7841874afcec"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "bdc31cd0-689a-4fc4-b23f-de399a2f30e5",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "514b7379-e6c3-4c41-a0b7-26124fe1d943"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "8kvDIwvdID7NWcBMND4uDR%2BQxCiuep3i78rRqQAAoRmVkwrAWNRM%2BBk5ZR7A09pOnARoU2UEPJDoq1UO%2BXO8Ia6PG1mCMkSpRnvG5SeHMxw1J515p1Fb7Zr1DdNC76cF"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "12003b10-185d-4c07-ab03-ed15da817e1b",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z2n8upl40jfhop",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "cf754473-bf60-43eb-a0e8-f228afdacd2d",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "265"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 14:55:30 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              86,
              122,
              104,
              72,
              85,
              53,
              115,
              100,
              101,
              115,
              52,
              48,
              103,
              114,
              118,
              75,
              109,
              122,
              105,
              37,
              50,
              66,
              114,
              88,
              86,
              51,
              108,
              69,
              37,
              50,
              66,
              76,
              122,
              119,
              121,
              53,
              81,
              118,
              83,
              89,
              77,
              67,
              71,
              108,
              109,
              112,
              73,
              55,
              57,
              67,
              113,
              120,
              112,
              50,
              71,
              73,
              87,
              87,
              53,
              55,
              65,
              110,
              68,
              55,
              52,
              84,
              82,
              120,
              81,
              116,
              57,
              72,
              109,
              88,
              37,
              50,
              66,
              108,
              51,
              54,
              66,
              37,
              50,
              70,
              122,
              105,
              54,
              78,
              76,
              85,
              67,
              50,
              81,
              108,
              37,
              50,
              70,
              109,
              78,
              51,
              76,
              103,
              109,
              65,
              106,
              114,
              88,
              37,
              50,
              70,
              70,
              50,
              78,
              55,
              97,
              72,
              100,
              103,
              53,
              81,
              49,
              121,
              118,
              89,
              88,
              76,
              109,
              110,
              51,
              117,
              116,
              122,
              65,
              106,
              122,
              74,
              107,
              37,
              50,
              66,
              54,
              99,
              85,
              100,
              51,
              48,
              81,
              117,
              67,
              88,
              51,
              75,
              77,
              72,
              112,
              78,
              69,
              78,
              109,
              98,
              83,
              53,
              97,
              97,
              115,
              79,
              74,
              89,
              98,
              72,
              53,
              120,
              98,
              50,
              37,
              50,
              66,
              105,
              74,
              37,
              50,
              70,
              84,
              109,
              80,
              83,
              65,
              55,
              113,
              84,
              89,
              37,
              50,
              70,
              49,
              103,
              77,
              72,
              77,
              114,
              122,
              53,
              57,
              48,
              102,
              112,
              71,
              87,
              57,
              51,
              50,
              73,
              103,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1332,
          "responseSize": 265
        },
        "id": "2f29d6cd-a7af-4456-9eca-993414d84b4f",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "취소 후 잔액(BALANCE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 원 거래 키(O_TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생시간(TRANTIME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생일자(TRANDATE)",
            "skipped": false
          },
          {
            "assertion": "승인 취소 금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false
          }
        ]
      }
    ],
    "transfers": {
      "responseTotal": 7767
    },
    "failures": [
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "결과코드(RETURNCODE) 정상출력",
          "message": "expected '3143' to deeply equal '0000'",
          "stack": "AssertionError: expected '3143' to deeply equal '0000'\n   at Object.eval sandbox-script.js:1:14)",
          "checksum": "39d7afe66119f8ed083fbf2591ba0453",
          "id": "3ba27471-a7cf-4ea4-8d2a-7cddad6b3945",
          "timestamp": 1767711320970,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
              }
            }
          ]
        },
        "parent": {
          "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
          "name": "우리BC카드",
          "item": [
            {
              "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                  }
                }
              ]
            },
            {
              "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "4aaa7604-0d9b-45b1-82b2-929e9752c356",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "d5431ec0-74b8-4d01-9c20-52b0f26109cd",
          "scriptId": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
          "execution": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 1,
          "test": "결과메세지(RETURNMSG) 정상출력",
          "message": "expected '%C4%AB%B5%E5%BB%E7+%B9%AE%C0%C7+%B9%D…' to deeply equal '%BC%BA%B0%F8'",
          "stack": "AssertionError: expected '%C4%AB%B5%E5%BB%E7+%B9%AE%C0%C7+%B9%D…' to deeply equal '%BC%BA%B0%F8'\n   at Object.eval sandbox-script.js:2:14)",
          "checksum": "a36d8cf3892c4f95c75241ad9161cdf5",
          "id": "333df5d1-65fe-499c-b7ac-cdd097a165dc",
          "timestamp": 1767711320971,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 2,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:1 in test-script",
        "source": {
          "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
              }
            }
          ]
        },
        "parent": {
          "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
          "name": "우리BC카드",
          "item": [
            {
              "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                  }
                }
              ]
            },
            {
              "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "4aaa7604-0d9b-45b1-82b2-929e9752c356",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "d5431ec0-74b8-4d01-9c20-52b0f26109cd",
          "scriptId": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
          "execution": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 2,
          "test": "카드사 코드(CARDCODE 정상출력",
          "message": "expected undefined to deeply equal '0202'",
          "stack": "AssertionError: expected undefined to deeply equal '0202'\n   at Object.eval sandbox-script.js:3:14)",
          "checksum": "04102c5be7218d63ffd754d54018692e",
          "id": "1475e145-3dff-4568-a541-8502cc23edde",
          "timestamp": 1767711320972,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 3,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:2 in test-script",
        "source": {
          "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
              }
            }
          ]
        },
        "parent": {
          "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
          "name": "우리BC카드",
          "item": [
            {
              "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                  }
                }
              ]
            },
            {
              "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "4aaa7604-0d9b-45b1-82b2-929e9752c356",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "d5431ec0-74b8-4d01-9c20-52b0f26109cd",
          "scriptId": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
          "execution": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 3,
          "test": "구매자 전화번호(USERPHONE) 빈값 확인",
          "message": ".empty was passed non-string primitive undefined",
          "stack": "AssertionError: .empty was passed non-string primitive undefined\n   at Object.eval sandbox-script.js:4:14)",
          "checksum": "8afb764eee0fab671b701fb5419df6b2",
          "id": "764ae9fb-9c3d-42ab-ab59-b373df7164f8",
          "timestamp": 1767711320973,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 4,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:3 in test-script",
        "source": {
          "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
              }
            }
          ]
        },
        "parent": {
          "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
          "name": "우리BC카드",
          "item": [
            {
              "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                  }
                }
              ]
            },
            {
              "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "4aaa7604-0d9b-45b1-82b2-929e9752c356",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "d5431ec0-74b8-4d01-9c20-52b0f26109cd",
          "scriptId": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
          "execution": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 4,
          "test": "할부 개월 수(QUOTA) 정상출력",
          "message": "expected undefined to deeply equal '00'",
          "stack": "AssertionError: expected undefined to deeply equal '00'\n   at Object.eval sandbox-script.js:5:14)",
          "checksum": "0d5832df7e81d68dde75879e94d30847",
          "id": "cb072a8e-1708-4f56-9d65-c7f6921b67ca",
          "timestamp": 1767711320973,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 5,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:4 in test-script",
        "source": {
          "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
              }
            }
          ]
        },
        "parent": {
          "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
          "name": "우리BC카드",
          "item": [
            {
              "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                  }
                }
              ]
            },
            {
              "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "4aaa7604-0d9b-45b1-82b2-929e9752c356",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "d5431ec0-74b8-4d01-9c20-52b0f26109cd",
          "scriptId": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
          "execution": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
        }
      },
      {
        "error": {
          "name": "TypeError",
          "index": 5,
          "test": "매출 발생시간(TRANTIME) ±5초 이내 검증",
          "message": "Cannot read properties of undefined (reading 'slice')",
          "stack": "TypeError: Cannot read properties of undefined (reading 'slice')\n   at Object.eval sandbox-script.js:6:14)",
          "checksum": "eab3458fb8a7bd36b0e8ad6a235cc2bf",
          "id": "3edb78ab-26b4-4b2e-b846-b173de1598c8",
          "timestamp": 1767711320974,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 6,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:5 in test-script",
        "source": {
          "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
              }
            }
          ]
        },
        "parent": {
          "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
          "name": "우리BC카드",
          "item": [
            {
              "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                  }
                }
              ]
            },
            {
              "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "4aaa7604-0d9b-45b1-82b2-929e9752c356",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "d5431ec0-74b8-4d01-9c20-52b0f26109cd",
          "scriptId": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
          "execution": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 6,
          "test": "매출 발생일자(TRANDATE) 정상출력",
          "message": "expected undefined to deeply equal '20260106'",
          "stack": "AssertionError: expected undefined to deeply equal '20260106'\n   at Object.eval sandbox-script.js:7:14)",
          "checksum": "30b0264d1f52ac0f1dc3e71a8ad1eeb9",
          "id": "75b88c33-0e08-480b-a8d2-52b51573e348",
          "timestamp": 1767711320974,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 7,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:6 in test-script",
        "source": {
          "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
              }
            }
          ]
        },
        "parent": {
          "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
          "name": "우리BC카드",
          "item": [
            {
              "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                  }
                }
              ]
            },
            {
              "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "4aaa7604-0d9b-45b1-82b2-929e9752c356",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "d5431ec0-74b8-4d01-9c20-52b0f26109cd",
          "scriptId": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
          "execution": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 7,
          "test": "승인금액(AMOUNT) 정상출력",
          "message": "expected undefined to deeply equal '301'",
          "stack": "AssertionError: expected undefined to deeply equal '301'\n   at Object.eval sandbox-script.js:8:14)",
          "checksum": "877b95a69b497c92ef65dd0726b13142",
          "id": "7d5b4644-0484-4dd5-87ba-a602ecf22f92",
          "timestamp": 1767711320975,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 8,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:7 in test-script",
        "source": {
          "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
              }
            }
          ]
        },
        "parent": {
          "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
          "name": "우리BC카드",
          "item": [
            {
              "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                  }
                }
              ]
            },
            {
              "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "4aaa7604-0d9b-45b1-82b2-929e9752c356",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "d5431ec0-74b8-4d01-9c20-52b0f26109cd",
          "scriptId": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
          "execution": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 8,
          "test": "상품명(ITEMNAME) 정상출력",
          "message": "expected undefined to deeply equal 'apiautotest'",
          "stack": "AssertionError: expected undefined to deeply equal 'apiautotest'\n   at Object.eval sandbox-script.js:9:14)",
          "checksum": "9ece39081e0b87f92735355a3832bc7e",
          "id": "12b9fc2a-6ee1-47e2-aa66-f4b372679c78",
          "timestamp": 1767711320975,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 9,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:8 in test-script",
        "source": {
          "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
              }
            }
          ]
        },
        "parent": {
          "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
          "name": "우리BC카드",
          "item": [
            {
              "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                  }
                }
              ]
            },
            {
              "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "4aaa7604-0d9b-45b1-82b2-929e9752c356",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "d5431ec0-74b8-4d01-9c20-52b0f26109cd",
          "scriptId": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
          "execution": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 9,
          "test": "보증금 금액(DEPOSIT_AMT) 정상출력",
          "message": "expected undefined to deeply equal '0'",
          "stack": "AssertionError: expected undefined to deeply equal '0'\n   at Object.eval sandbox-script.js:10:14)",
          "checksum": "bc7bd473f6a845d01599f30172e34f19",
          "id": "0f7fe449-3697-4747-a679-4c91329d09af",
          "timestamp": 1767711320976,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 10,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:9 in test-script",
        "source": {
          "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
              }
            }
          ]
        },
        "parent": {
          "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
          "name": "우리BC카드",
          "item": [
            {
              "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                  }
                }
              ]
            },
            {
              "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "4aaa7604-0d9b-45b1-82b2-929e9752c356",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "d5431ec0-74b8-4d01-9c20-52b0f26109cd",
          "scriptId": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
          "execution": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 11,
          "test": "가맹점 주문번호(ORDERID) 빈값 확인",
          "message": ".empty was passed non-string primitive undefined",
          "stack": "AssertionError: .empty was passed non-string primitive undefined\n   at Object.eval sandbox-script.js:12:14)",
          "checksum": "f6865c7f4c66c938f654c12653b00629",
          "id": "a7cdea5d-f11d-4b3e-92f8-f385d425e593",
          "timestamp": 1767711320976,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 12,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:11 in test-script",
        "source": {
          "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
              }
            }
          ]
        },
        "parent": {
          "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
          "name": "우리BC카드",
          "item": [
            {
              "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                  }
                }
              ]
            },
            {
              "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "4aaa7604-0d9b-45b1-82b2-929e9752c356",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "d5431ec0-74b8-4d01-9c20-52b0f26109cd",
          "scriptId": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
          "execution": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 12,
          "test": "카드번호(CARDNO) 정상출력",
          "message": "expected undefined to deeply equal '538920******1226'",
          "stack": "AssertionError: expected undefined to deeply equal '538920******1226'\n   at Object.eval sandbox-script.js:13:14)",
          "checksum": "04cecf0816b1b458b1789beae6dd677e",
          "id": "dbfccf43-6883-4fd5-be1b-8c6e04b11666",
          "timestamp": 1767711320977,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 13,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:12 in test-script",
        "source": {
          "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
              }
            }
          ]
        },
        "parent": {
          "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
          "name": "우리BC카드",
          "item": [
            {
              "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                  }
                }
              ]
            },
            {
              "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "4aaa7604-0d9b-45b1-82b2-929e9752c356",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "d5431ec0-74b8-4d01-9c20-52b0f26109cd",
          "scriptId": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
          "execution": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 13,
          "test": "거래 승인 번호(CARDAUTHNO) 정상출력",
          "message": "expected undefined to exist",
          "stack": "AssertionError: expected undefined to exist\n   at Object.eval sandbox-script.js:14:14)",
          "checksum": "c2a3a9c58df7bedc9e1825e97f7a211a",
          "id": "cd0a50db-3f69-464c-bde1-51f0f5549b1b",
          "timestamp": 1767711320977,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 14,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:13 in test-script",
        "source": {
          "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
              }
            }
          ]
        },
        "parent": {
          "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
          "name": "우리BC카드",
          "item": [
            {
              "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                  }
                }
              ]
            },
            {
              "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "4aaa7604-0d9b-45b1-82b2-929e9752c356",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "d5431ec0-74b8-4d01-9c20-52b0f26109cd",
          "scriptId": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
          "execution": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 14,
          "test": "카드사 명(CARDNAME) 정상출력",
          "message": "expected undefined to deeply equal '%BF%EC%B8%AEBC%C4%AB%B5%E5'",
          "stack": "AssertionError: expected undefined to deeply equal '%BF%EC%B8%AEBC%C4%AB%B5%E5'\n   at Object.eval sandbox-script.js:15:14)",
          "checksum": "94eb2f7a44f776a27ca4e055ce9af35e",
          "id": "84f19689-2fb5-430f-95df-6264742d2c8d",
          "timestamp": 1767711320978,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 15,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:14 in test-script",
        "source": {
          "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
              }
            }
          ]
        },
        "parent": {
          "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
          "name": "우리BC카드",
          "item": [
            {
              "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                  }
                }
              ]
            },
            {
              "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "4aaa7604-0d9b-45b1-82b2-929e9752c356",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "d5431ec0-74b8-4d01-9c20-52b0f26109cd",
          "scriptId": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
          "execution": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 15,
          "test": "구매자 이름(USERNAME) 정상출력",
          "message": ".empty was passed non-string primitive undefined",
          "stack": "AssertionError: .empty was passed non-string primitive undefined\n   at Object.eval sandbox-script.js:16:14)",
          "checksum": "797b6dc46f383bcc5df0d5571c825572",
          "id": "3b85a0a1-f859-41b9-8f04-eba89b967f8a",
          "timestamp": 1767711320978,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 16,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:15 in test-script",
        "source": {
          "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
              }
            }
          ]
        },
        "parent": {
          "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
          "name": "우리BC카드",
          "item": [
            {
              "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                  }
                }
              ]
            },
            {
              "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "4aaa7604-0d9b-45b1-82b2-929e9752c356",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "d5431ec0-74b8-4d01-9c20-52b0f26109cd",
          "scriptId": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
          "execution": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 16,
          "test": "구매자 ID(USERID) 정상출력",
          "message": "expected undefined to deeply equal 'hnkim'",
          "stack": "AssertionError: expected undefined to deeply equal 'hnkim'\n   at Object.eval sandbox-script.js:17:14)",
          "checksum": "71be15b35b8aec1a5bf066b1bdc994b4",
          "id": "afbb2c54-186b-4a3e-b4df-3bb4b84c0a11",
          "timestamp": 1767711320979,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 17,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:16 in test-script",
        "source": {
          "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
              }
            }
          ]
        },
        "parent": {
          "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
          "name": "우리BC카드",
          "item": [
            {
              "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                  }
                }
              ]
            },
            {
              "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "4aaa7604-0d9b-45b1-82b2-929e9752c356",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "d5431ec0-74b8-4d01-9c20-52b0f26109cd",
          "scriptId": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
          "execution": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "결과코드(RETURNCODE) 정상출력",
          "message": "expected '1117' to deeply equal '0000'",
          "stack": "AssertionError: expected '1117' to deeply equal '0000'\n   at Object.eval sandbox-script.js:1:15)",
          "checksum": "a012cd453405486f5cf198bfc2cfb6c5",
          "id": "d5ff5ada-d221-43b3-82ed-b18631de193b",
          "timestamp": 1767711321317,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 15,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
              }
            }
          ]
        },
        "parent": {
          "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
          "name": "우리BC카드",
          "item": [
            {
              "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                  }
                }
              ]
            },
            {
              "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "939f08d6-5e83-4f85-aff1-a4c78dd3675c",
          "length": 21,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "3f1a4b62-b7ee-4a87-8f4f-997fda7c125b",
          "scriptId": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
          "execution": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 1,
          "test": "결과메세지(RETURNMSG) 정상출력",
          "message": "expected '%BF%F8%B0%C5%B7%A1%B0%C7%C0%CC+%C1%B8…' to deeply equal '%BC%BA%B0%F8'",
          "stack": "AssertionError: expected '%BF%F8%B0%C5%B7%A1%B0%C7%C0%CC+%C1%B8…' to deeply equal '%BC%BA%B0%F8'\n   at Object.eval sandbox-script.js:2:15)",
          "checksum": "822742ddbd77cbe388c5892b46b77dc1",
          "id": "c9b6e7fd-998e-4b13-b8d3-9ee244716198",
          "timestamp": 1767711321318,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 2,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 15,
              "native": false
            }
          ]
        },
        "at": "assertion:1 in test-script",
        "source": {
          "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
              }
            }
          ]
        },
        "parent": {
          "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
          "name": "우리BC카드",
          "item": [
            {
              "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                  }
                }
              ]
            },
            {
              "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "939f08d6-5e83-4f85-aff1-a4c78dd3675c",
          "length": 21,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "3f1a4b62-b7ee-4a87-8f4f-997fda7c125b",
          "scriptId": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
          "execution": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 2,
          "test": "취소 후 잔액(BALANCE) 정상출력",
          "message": "expected undefined to deeply equal '0'",
          "stack": "AssertionError: expected undefined to deeply equal '0'\n   at Object.eval sandbox-script.js:3:15)",
          "checksum": "4272e1f2e202d0f1893e80c0756de9b8",
          "id": "90afd420-e155-4dbb-88f2-ee9f5be7f622",
          "timestamp": 1767711321318,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 3,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 15,
              "native": false
            }
          ]
        },
        "at": "assertion:2 in test-script",
        "source": {
          "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
              }
            }
          ]
        },
        "parent": {
          "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
          "name": "우리BC카드",
          "item": [
            {
              "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                  }
                }
              ]
            },
            {
              "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "939f08d6-5e83-4f85-aff1-a4c78dd3675c",
          "length": 21,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "3f1a4b62-b7ee-4a87-8f4f-997fda7c125b",
          "scriptId": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
          "execution": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 3,
          "test": "다날 원 거래 키(O_TID) 정상출력",
          "message": "expected undefined not to be undefined",
          "stack": "AssertionError: expected undefined not to be undefined\n   at Object.eval sandbox-script.js:4:15)",
          "checksum": "863cc620ecbc06ed16663112ac5f0bbd",
          "id": "edd9e311-720d-4c60-8fb6-6b4f8bde4420",
          "timestamp": 1767711321319,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 4,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 15,
              "native": false
            }
          ]
        },
        "at": "assertion:3 in test-script",
        "source": {
          "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
              }
            }
          ]
        },
        "parent": {
          "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
          "name": "우리BC카드",
          "item": [
            {
              "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                  }
                }
              ]
            },
            {
              "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "939f08d6-5e83-4f85-aff1-a4c78dd3675c",
          "length": 21,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "3f1a4b62-b7ee-4a87-8f4f-997fda7c125b",
          "scriptId": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
          "execution": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 4,
          "test": "다날 거래 키(TID) 정상출력",
          "message": "expected undefined not to be undefined",
          "stack": "AssertionError: expected undefined not to be undefined\n   at Object.eval sandbox-script.js:5:15)",
          "checksum": "5865b485226e028e46a31c468d40a4df",
          "id": "0db4273a-4b13-4f1e-8124-60a7ee1709df",
          "timestamp": 1767711321319,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 5,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 15,
              "native": false
            }
          ]
        },
        "at": "assertion:4 in test-script",
        "source": {
          "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
              }
            }
          ]
        },
        "parent": {
          "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
          "name": "우리BC카드",
          "item": [
            {
              "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                  }
                }
              ]
            },
            {
              "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "939f08d6-5e83-4f85-aff1-a4c78dd3675c",
          "length": 21,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "3f1a4b62-b7ee-4a87-8f4f-997fda7c125b",
          "scriptId": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
          "execution": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 5,
          "test": "승인 발생시간(TRANTIME) 정상출력",
          "message": "expected undefined to deeply equal null",
          "stack": "AssertionError: expected undefined to deeply equal null\n   at Object.eval sandbox-script.js:6:15)",
          "checksum": "f1c8f2be7f2b2372b4eaf8e5af1690a0",
          "id": "42f9d205-9218-477c-b5be-1c1207a53c9b",
          "timestamp": 1767711321320,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 6,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 15,
              "native": false
            }
          ]
        },
        "at": "assertion:5 in test-script",
        "source": {
          "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
              }
            }
          ]
        },
        "parent": {
          "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
          "name": "우리BC카드",
          "item": [
            {
              "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                  }
                }
              ]
            },
            {
              "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "939f08d6-5e83-4f85-aff1-a4c78dd3675c",
          "length": 21,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "3f1a4b62-b7ee-4a87-8f4f-997fda7c125b",
          "scriptId": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
          "execution": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 6,
          "test": "승인 발생일자(TRANDATE)",
          "message": "expected undefined to deeply equal '20260106'",
          "stack": "AssertionError: expected undefined to deeply equal '20260106'\n   at Object.eval sandbox-script.js:7:15)",
          "checksum": "df5121398ba0033c48bf3d28e10764a5",
          "id": "6cf97674-e9c3-42de-ac88-917d54b4186c",
          "timestamp": 1767711321320,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 7,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 15,
              "native": false
            }
          ]
        },
        "at": "assertion:6 in test-script",
        "source": {
          "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
              }
            }
          ]
        },
        "parent": {
          "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
          "name": "우리BC카드",
          "item": [
            {
              "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                  }
                }
              ]
            },
            {
              "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "939f08d6-5e83-4f85-aff1-a4c78dd3675c",
          "length": 21,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "3f1a4b62-b7ee-4a87-8f4f-997fda7c125b",
          "scriptId": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
          "execution": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 7,
          "test": "승인 취소 금액(AMOUNT) 정상출력",
          "message": "expected undefined to deeply equal '301'",
          "stack": "AssertionError: expected undefined to deeply equal '301'\n   at Object.eval sandbox-script.js:8:15)",
          "checksum": "125a393a7dac12722dc3072ef4839e5a",
          "id": "91d0650b-2197-413e-b28d-80f7217693b3",
          "timestamp": 1767711321320,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 8,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 15,
              "native": false
            }
          ]
        },
        "at": "assertion:7 in test-script",
        "source": {
          "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
              }
            }
          ]
        },
        "parent": {
          "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
          "name": "우리BC카드",
          "item": [
            {
              "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                  }
                }
              ]
            },
            {
              "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "939f08d6-5e83-4f85-aff1-a4c78dd3675c",
          "length": 21,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "3f1a4b62-b7ee-4a87-8f4f-997fda7c125b",
          "scriptId": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
          "execution": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 8,
          "test": "컵 보증금(DEPOSIT_AMT) 정상출력",
          "message": "expected undefined to deeply equal '0'",
          "stack": "AssertionError: expected undefined to deeply equal '0'\n   at Object.eval sandbox-script.js:9:15)",
          "checksum": "bb01c28131fc1efd90a0a0f322fda70a",
          "id": "861b1a9a-5efd-4632-bdcf-ede8e66f6339",
          "timestamp": 1767711321321,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 9,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 15,
              "native": false
            }
          ]
        },
        "at": "assertion:8 in test-script",
        "source": {
          "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
              }
            }
          ]
        },
        "parent": {
          "id": "7587ffc4-2ee2-4a9a-85a2-120ff837b43b",
          "name": "우리BC카드",
          "item": [
            {
              "id": "89c2ac29-d229-49b9-bfab-1d52877ccc86",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "9881dcf7-63fd-4d10-8d6e-4ac15b2f9d31",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "04513435-502a-43d8-93d7-ac55c47e71df"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "50b55ae5-712b-4b6b-9b4a-3619bdb60bad",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "5fc7f9ec-65a0-40e8-bd85-2764f1a0f383"
                  }
                }
              ]
            },
            {
              "id": "48cf7097-f251-48aa-a701-c00c55d8b381",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "f06accff-ba07-4aeb-8d37-a10900c16b36",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "54bf07e1-d728-4b25-81e0-95bdc5e6def7"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "939f08d6-5e83-4f85-aff1-a4c78dd3675c",
          "length": 21,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "3f1a4b62-b7ee-4a87-8f4f-997fda7c125b",
          "scriptId": "254148f2-355c-4e73-aae6-1ccd1f6b6e21",
          "execution": "e97aab66-ee6e-4a6c-af2c-ca6e9d4fa394"
        }
      }
    ],
    "error": null
  }
}