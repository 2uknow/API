{
  "collection": {
    "_": {
      "postman_id": "ad14dfb9-75d7-4a97-85bf-8665f83ae3c1",
      "exporter_id": "24140936",
      "collection_link": "https://red-escape-704404.postman.co/workspace/Team-Workspace~a1f4d6b2-7a17-4360-8a8d-46313f959e2b/collection/24140936-ad14dfb9-75d7-4a97-85bf-8665f83ae3c1?action=share&source=collection_link&creator=24140936"
    },
    "item": [
      {
        "id": "7bfb015a-69ad-4be5-a6d1-6e722bb8eff4",
        "name": "CP 및 정기결제 요청 전송",
        "item": [
          {
            "id": "1dbc1c20-93b6-4040-a47b-7764dc94cd63",
            "name": "READY - BATCH",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/x-www-form-urlencoded; charset=UTF-8"
                }
              ],
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "db1d7967-44f3-40db-973b-4b910bc0dc6c",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "// 파싱 및 개별 디코딩\r",
                    "const parsed = parseQueryString(result);\r",
                    "const startUrlDecoded = safeDecodeURIComponent(parsed.STARTURL);\r",
                    "console.log(\"STARTURL(디코딩):\", startUrlDecoded);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메시지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"정기결제 초기인증 표준페이지 시작 URL(STARTURL) 정상출력\", function () {\r",
                    "    pm.expect(startUrlDecoded).to.eql(\"https://checkout.teledit.com/creditcard_recurring/web\")\r",
                    "})\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "});\r",
                    "\r",
                    "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"위 표준페이지 시작 URL 전송 파라미터(STARTPARAMS) 정상출력\", function () {\r",
                    "    pm.expect(parsed.STARTPARAMS).to.not.be.undefined;\r",
                    "    pm.expect(parsed.STARTPARAMS).to.not.be.empty;\r",
                    "    pm.expect(parsed.STARTPARAMS).to.not.be.null;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"결제금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "852303b7-17e5-4699-9356-79698f7c7510"
                }
              },
              {
                "listen": "prerequest",
                "script": {
                  "id": "26f44523-80ef-410d-a519-6754249ab4e8",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    ITEMNAME: 'apiautotest',\r",
                    "    AMOUNT: '301',\r",
                    "    CURRENCY: '410',\r",
                    "    USERID: 'hnkim',\r",
                    "    USERAGENT: 'PC',\r",
                    "    TXTYPE: 'AUTH',\r",
                    "    SERVICETYPE: 'BATCH',\r",
                    "    CANCELURL: 'https://paytest.teledit.com:888/clientdemo/oneapi/returnFail.php',\r",
                    "    RETURNURL: 'https://paytest.teledit.com:888/clientdemo/oneapi/returnFail.php',\r",
                    "    ISBILL: 'Y',\r",
                    "    ISNOTI: 'N'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "a4a010f7-649f-475e-9300-fce0306a0cd4"
                }
              }
            ]
          },
          {
            "id": "b3a7fa52-a139-454b-ad0a-1cded525940b",
            "name": "READY - DANALCARD",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/x-www-form-urlencoded; charset=UTF-8"
                }
              ],
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "07ad47b9-d529-43d7-9ff5-45b826879102",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "// 파싱 및 개별 디코딩\r",
                    "const parsed = parseQueryString(result);\r",
                    "const startUrlDecoded = safeDecodeURIComponent(parsed.STARTURL);\r",
                    "console.log(\"STARTURL(디코딩):\", startUrlDecoded);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메시지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"정기결제 초기인증 표준페이지 시작 URL(STARTURL) 정상출력\", function () {\r",
                    "    pm.expect(startUrlDecoded).to.eql(\"https://checkout.teledit.com/creditcard_std/web\")\r",
                    "})\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "});\r",
                    "\r",
                    "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"위 표준페이지 시작 URL 전송 파라미터(STARTPARAMS) 정상출력\", function () {\r",
                    "    pm.expect(parsed.STARTPARAMS).to.not.be.undefined;\r",
                    "    pm.expect(parsed.STARTPARAMS).to.not.be.empty;\r",
                    "    pm.expect(parsed.STARTPARAMS).to.not.be.null;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"결제금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "ea0e8cc5-5667-45b7-8b0f-3985ba085d5f"
                }
              },
              {
                "listen": "prerequest",
                "script": {
                  "id": "6801754b-ed63-4a84-be23-093bd8cdb221",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    ITEMNAME: 'apiautotest',\r",
                    "    AMOUNT: '301',\r",
                    "    CURRENCY: '410',\r",
                    "    USERID: 'hnkim',\r",
                    "    USERAGENT: 'PC',\r",
                    "    TXTYPE: 'AUTH',\r",
                    "    SERVICETYPE: 'DANALCARD',\r",
                    "    CANCELURL: 'https://paytest.teledit.com:888/clientdemo/oneapi/returnFail.php',\r",
                    "    RETURNURL: 'https://paytest.teledit.com:888/clientdemo/oneapi/returnFail.php',\r",
                    "    ISBILL: 'Y',\r",
                    "    ISNOTI: 'N'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "a71af66e-4e73-43c7-9e98-9dcecc9ae8c7"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "89f91615-9323-41a7-90d1-cdbb9c8e08b8",
        "name": "초기 인증 결제 요청",
        "item": [
          {
            "id": "0b59d194-e1d9-46c7-a996-daeb9888f7c4",
            "name": "ISSUEBILLKEY",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/x-www-form-urlencoded; charset=UTF-8"
                }
              ],
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "baf16a2d-10c1-487f-aab2-6965dceb8f87",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    AMOUNT: '301',\r",
                    "    TID: pm.environment.get('TID'),\r",
                    "    TXTYPE: 'ISSUEBILLKEY',\r",
                    "    SERVICETYPE: 'BATCH'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "b7ec26cd-15ab-496a-be45-642dc5e5cdad"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "e0f95b50-c0d2-4fe9-91fb-5a4a36c37a16",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "// 파싱 및 개별 디코딩\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) : 1104 출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"1104\")\r",
                    "});\r",
                    "\r",
                    "// \"존재하지 않는 거래 입니다.\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) : 존재하지 않는 거래입니다. 출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%C1%B8%C0%E7%C7%CF%C1%F6+%BE%CA%B4%C2+%B0%C5%B7%A1+%C0%D4%B4%CF%B4%D9.\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "a88735c4-a275-4f86-a18d-87d11077f50f"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "f3e2a988-1781-4de3-ae69-f6092ac4314f",
        "name": "삼성카드",
        "item": [
          {
            "id": "2f4b3ee6-1ddf-412a-8e7b-e7e2991b61fe",
            "name": "정기결제 요청 (OTBILL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/x-www-form-urlencoded; charset=UTF-8"
                }
              ],
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "71a61e4e-3924-4901-9c9a-dba648305451",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    ITEMNAME: 'apiautotest',\r",
                    "    AMOUNT: '301',\r",
                    "    CURRENCY: '410',\r",
                    "    USERID: 'hnkim',\r",
                    "    USERAGENT: 'ONLINE',\r",
                    "    TXTYPE: 'OTBILL',\r",
                    "    SERVICETYPE: 'BATCH',\r",
                    "    ISREBILL: 'Y',\r",
                    "    BILLINFO: 'DC250730151749FFCAA0',\r",
                    "    USERNAME: '김하늘',\r",
                    "    USERPHONE: '01085402697',\r",
                    "    ORDERID: '01234567'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "9f2bd34b-69d9-4aa5-8b0a-a07e2005c618"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "e17ce76a-ecbe-4430-85a8-beb75ee3f7e7",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDCODE).to.eql(\"0500\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.USERPHONE).to.eql(\"01085402697\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                    "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                    "  // 현재 시간 선언\r",
                    "  const now = new Date();\r",
                    "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                    "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                    "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                    "  const t = parsed.TRANTIME;\r",
                    "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                    "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                    "\r",
                    "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                    "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TRANTIME 저장\r",
                    "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TID 저장\r",
                    "pm.environment.set(\"TID\", parsed.TID);\r",
                    "\r",
                    "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.ORDERID).to.eql(\"01234567\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNO).to.eql(\"512028******7294\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                    "});\r",
                    "\r",
                    "// \"삼성카드\" 검증\r",
                    "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNAME).to.eql(\"%BB%EF%BC%BA%C4%AB%B5%E5\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERNAME).to.eql(\"%EA%B9%3F%3F%3F%3F%3F\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "89548491-0fa1-477c-a8c2-508f14a3f34d"
                }
              }
            ]
          },
          {
            "id": "24898af4-501d-4567-b9da-462b76df061e",
            "name": "카드 승인 취소 (BILLCANCEL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "test",
                "script": {
                  "id": "c639df6b-0251-4682-9b6b-037c8921317a",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                    "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "// 매출 발생시간과 비교 검증\r",
                    "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                    "});\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "3bf3f226-b9d3-460e-8961-293db51c8fe5"
                }
              },
              {
                "listen": "prerequest",
                "script": {
                  "id": "3da63183-d401-41d1-b88f-ce29df6907ba",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    AMOUNT: '301',\r",
                    "    TID: pm.environment.get(\"TID\"),\r",
                    "    CANCELTYPE: 'C',\r",
                    "    TXTYPE: 'CANCEL',\r",
                    "    SERVICETYPE: 'DANALCARD'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "618e1d26-05ea-4cad-96a1-c442814a4b5b"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "3e3ee58a-f7b2-40bb-a411-99a8cf1aff61",
        "name": "현대카드",
        "item": [
          {
            "id": "2fc9ead6-7e9d-4633-b93b-12d79bdabb54",
            "name": "정기결제 요청 (OTBILL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "d0823084-7854-46b3-afce-092d80aa1dd0",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    ITEMNAME: 'apiautotest',\r",
                    "    AMOUNT: '301',\r",
                    "    CURRENCY: '410',\r",
                    "    USERID: 'hnkim',\r",
                    "    USERAGENT: 'ONLINE',\r",
                    "    TXTYPE: 'OTBILL',\r",
                    "    SERVICETYPE: 'BATCH',\r",
                    "    ISREBILL: 'Y',\r",
                    "    BILLINFO: 'DC221222165535557F38'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "4f7f0bb9-876f-4c8c-bf00-40a6d4bf1e89"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "27224ca3-531f-4b3d-ac6b-3dbaf87b8c2a",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDCODE).to.eql(\"0400\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                    "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                    "  // 현재 시간 선언\r",
                    "  const now = new Date();\r",
                    "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                    "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                    "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                    "  const t = parsed.TRANTIME;\r",
                    "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                    "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                    "\r",
                    "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                    "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TRANTIME 저장\r",
                    "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TID 저장\r",
                    "pm.environment.set(\"TID\", parsed.TID);\r",
                    "\r",
                    "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNO).to.eql(\"403293******4003\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                    "});\r",
                    "\r",
                    "// \"현대카드\" 검증\r",
                    "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNAME).to.eql(\"%C7%F6%B4%EB%C4%AB%B5%E5\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                    "})\r",
                    "\r",
                    "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "fd8eae81-08c7-4151-9589-52f0490d6189"
                }
              }
            ]
          },
          {
            "id": "0455914c-74ca-4916-b875-d8928809ad72",
            "name": "카드 승인 취소 (BILLCANCEL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "6526b131-0d36-41c0-bf6a-b06502f6c50c",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    AMOUNT: '301',\r",
                    "    TID: pm.environment.get(\"TID\"),\r",
                    "    CANCELTYPE: 'C',\r",
                    "    TXTYPE: 'CANCEL',\r",
                    "    SERVICETYPE: 'DANALCARD'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "f031d13d-7f74-4e4c-ba78-6984aee3848a"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "3afafe74-f6df-4487-8e09-4313a0652952",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                    "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "// 매출 발생시간과 비교 검증\r",
                    "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                    "});\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "daea3ace-7aab-4e2c-9c6d-9a981220e013"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "fa46ca98-3fab-4587-b7f3-163b0fd407c3",
        "name": "신한카드",
        "item": [
          {
            "id": "f2168abe-694f-480f-8b31-6ed06eeacc4c",
            "name": "정기결제 요청 (OTBILL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "52b510e7-5e4e-457e-ba77-119c477b4396",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    ITEMNAME: 'apiautotest',\r",
                    "    AMOUNT: '301',\r",
                    "    CURRENCY: '410',\r",
                    "    USERID: 'hnkim',\r",
                    "    USERAGENT: 'ONLINE',\r",
                    "    TXTYPE: 'OTBILL',\r",
                    "    SERVICETYPE: 'BATCH',\r",
                    "    ISREBILL: 'Y',\r",
                    "    BILLINFO: 'DC2507311547242F2CD0'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "de1e9626-f1bb-42b5-afdc-80d10a529443"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "88949645-5627-42ca-a2af-8f86fbfba9c4",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDCODE).to.eql(\"0100\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                    "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                    "  // 현재 시간 선언\r",
                    "  const now = new Date();\r",
                    "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                    "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                    "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                    "  const t = parsed.TRANTIME;\r",
                    "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                    "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                    "\r",
                    "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                    "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TRANTIME 저장\r",
                    "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TID 저장\r",
                    "pm.environment.set(\"TID\", parsed.TID);\r",
                    "\r",
                    "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNO).to.eql(\"451842******5446\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                    "});\r",
                    "\r",
                    "// \"신한카드\" 검증\r",
                    "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNAME).to.eql(\"%BD%C5%C7%D1%C4%AB%B5%E5\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "eaf85718-b03a-45d5-93ba-b8d7446cc1f2"
                }
              }
            ]
          },
          {
            "id": "3180e6ff-42bf-436b-9e8d-f3ab3ed4ab3c",
            "name": "카드 승인 취소 (BILLCANCEL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "9906f7ab-4f1e-4df8-bdbc-4b75b9c95379",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    AMOUNT: '301',\r",
                    "    TID: pm.environment.get(\"TID\"),\r",
                    "    CANCELTYPE: 'C',\r",
                    "    TXTYPE: 'CANCEL',\r",
                    "    SERVICETYPE: 'DANALCARD'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "105bbc42-1ba4-4e63-b926-717c899609b3"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "7a7f4854-3c5d-4089-9928-a9c5f3ec5d8d",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                    "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "// 매출 발생시간과 비교 검증\r",
                    "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                    "});\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "5087b0e0-91a6-4eb0-90d1-0c4d4703173e"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "f4838137-761c-4bbf-a950-c05ee666cfda",
        "name": "농협카드",
        "item": [
          {
            "id": "8cc65430-454f-40a7-85c5-7aec936d2010",
            "name": "정기결제 요청 (OTBILL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "9f4bc402-ea9a-4c19-93b1-704e943f6b01",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    ITEMNAME: 'apiautotest',\r",
                    "    AMOUNT: '301',\r",
                    "    CURRENCY: '410',\r",
                    "    USERID: 'hnkim',\r",
                    "    USERAGENT: 'ONLINE',\r",
                    "    TXTYPE: 'OTBILL',\r",
                    "    SERVICETYPE: 'BATCH',\r",
                    "    ISREBILL: 'Y',\r",
                    "    BILLINFO: 'DC2512151528144A426D'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "d2c4d979-c0c8-4e6d-85ce-38a1ac412741"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "3ac979bd-d575-4f72-bfa8-a828c8ecf41b",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDCODE).to.eql(\"0800\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                    "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                    "  // 현재 시간 선언\r",
                    "  const now = new Date();\r",
                    "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                    "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                    "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                    "  const t = parsed.TRANTIME;\r",
                    "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                    "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                    "\r",
                    "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                    "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TRANTIME 저장\r",
                    "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TID 저장\r",
                    "pm.environment.set(\"TID\", parsed.TID);\r",
                    "\r",
                    "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNO).to.eql(\"542586******3820\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                    "});\r",
                    "// \"NH농협카드\" 검증\r",
                    "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNAME).to.eql(\"NH%B3%F3%C7%F9%C4%AB%B5%E5\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "157e87b0-1308-41ec-bc1e-bb32f319a895"
                }
              }
            ]
          },
          {
            "id": "2bc4d519-b351-4ded-905f-e6d838cc2131",
            "name": "카드 승인 취소 (BILLCANCEL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "ae12336d-f33a-4ed0-a177-131424b03d85",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    AMOUNT: '301',\r",
                    "    TID: pm.environment.get(\"TID\"),\r",
                    "    CANCELTYPE: 'C',\r",
                    "    TXTYPE: 'CANCEL',\r",
                    "    SERVICETYPE: 'DANALCARD'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "65d62309-8cec-4625-b1c0-e4bd12624654"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "f2217647-9dd1-42b6-9630-c311c3bfbb02",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                    "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "// 매출 발생시간과 비교 검증\r",
                    "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                    "});\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "df8a5283-0e0e-49b7-bc8e-f473f713f2fb"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "29a72a42-2226-4869-8b29-b18602be0076",
        "name": "국민카드",
        "item": [
          {
            "id": "ca00f6ea-05ed-4f79-b37e-919d41763284",
            "name": "정기결제 요청 (OTBILL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "54057ce4-afb2-42ed-be32-2e95b2e2c172",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    ITEMNAME: 'apiautotest',\r",
                    "    AMOUNT: '301',\r",
                    "    CURRENCY: '410',\r",
                    "    USERID: 'hnkim',\r",
                    "    USERAGENT: 'ONLINE',\r",
                    "    TXTYPE: 'OTBILL',\r",
                    "    SERVICETYPE: 'BATCH',\r",
                    "    ISREBILL: 'Y',\r",
                    "    BILLINFO: 'DC250804165745DBD04E'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "f3dd5061-156d-4313-b6e0-0f5aaef63c4d"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "90ed897c-e5d9-4814-994d-ed870cd6a1f9",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDCODE).to.eql(\"0300\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                    "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                    "  // 현재 시간 선언\r",
                    "  const now = new Date();\r",
                    "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                    "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                    "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                    "  const t = parsed.TRANTIME;\r",
                    "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                    "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                    "\r",
                    "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                    "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TRANTIME 저장\r",
                    "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TID 저장\r",
                    "pm.environment.set(\"TID\", parsed.TID);\r",
                    "\r",
                    "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNO).to.eql(\"540926******6041\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                    "});\r",
                    "\r",
                    "// \"국민카드\" 검증\r",
                    "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNAME).to.eql(\"KB%B1%B9%B9%CE%C4%AB%B5%E5\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "c69f66e5-fee0-4be5-ab3a-661939699b3e"
                }
              }
            ]
          },
          {
            "id": "17f74e5c-d456-4ee6-acfb-420ea127d045",
            "name": "카드 승인 취소 (BILLCANCEL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "b156ae6a-9f26-4c39-93cf-d9c8bf80f4c0",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    AMOUNT: '301',\r",
                    "    TID: pm.environment.get(\"TID\"),\r",
                    "    CANCELTYPE: 'C',\r",
                    "    TXTYPE: 'CANCEL',\r",
                    "    SERVICETYPE: 'DANALCARD'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "462e11a8-6405-4eb1-bf08-de888c11fc6c"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "ab367332-1537-42dd-872b-ca8059ee0a01",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                    "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "// 매출 발생시간과 비교 검증\r",
                    "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                    "});\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "92d9bf0f-f951-48ed-a2ab-60bf9714c75c"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
        "name": "우리BC카드",
        "item": [
          {
            "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
            "name": "정기결제 요청 (OTBILL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    ITEMNAME: 'apiautotest',\r",
                    "    AMOUNT: '301',\r",
                    "    CURRENCY: '410',\r",
                    "    USERID: 'hnkim',\r",
                    "    USERAGENT: 'ONLINE',\r",
                    "    TXTYPE: 'OTBILL',\r",
                    "    SERVICETYPE: 'BATCH',\r",
                    "    ISREBILL: 'Y',\r",
                    "    BILLINFO: 'DC25080416595836B04B'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "3307c1c8-6296-4f04-883e-62107464c402",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                    "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                    "  // 현재 시간 선언\r",
                    "  const now = new Date();\r",
                    "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                    "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                    "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                    "  const t = parsed.TRANTIME;\r",
                    "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                    "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                    "\r",
                    "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                    "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TRANTIME 저장\r",
                    "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TID 저장\r",
                    "pm.environment.set(\"TID\", parsed.TID);\r",
                    "\r",
                    "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                    "});\r",
                    "\r",
                    "// \"삼성카드\" 검증\r",
                    "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                }
              }
            ]
          },
          {
            "id": "149a4441-c945-45a3-a539-b046aa7e9949",
            "name": "카드 승인 취소 (BILLCANCEL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    AMOUNT: '301',\r",
                    "    TID: pm.environment.get(\"TID\"),\r",
                    "    CANCELTYPE: 'C',\r",
                    "    TXTYPE: 'CANCEL',\r",
                    "    SERVICETYPE: 'DANALCARD'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                    "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "// 매출 발생시간과 비교 검증\r",
                    "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                    "});\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "3a93dedc-b6dd-4dd1-bef6-9d250bcca437",
        "name": "우리독자카드",
        "item": [
          {
            "id": "8553585f-b694-4f34-9a7c-98f209a69bd5",
            "name": "정기결제 요청 (OTBILL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "bfee9087-f6d2-4fbf-8b89-82877e7ab416",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    ITEMNAME: 'apiautotest',\r",
                    "    AMOUNT: '301',\r",
                    "    CURRENCY: '410',\r",
                    "    USERID: 'hnkim',\r",
                    "    USERAGENT: 'ONLINE',\r",
                    "    TXTYPE: 'OTBILL',\r",
                    "    SERVICETYPE: 'BATCH',\r",
                    "    ISREBILL: 'Y',\r",
                    "    BILLINFO: 'DC251215145003CEDD72'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "633b4355-19bf-414e-862e-0ad00c819e46"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "fc5e99df-b9ee-4abb-be5c-651e8935ad94",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDCODE).to.eql(\"0907\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                    "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                    "  // 현재 시간 선언\r",
                    "  const now = new Date();\r",
                    "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                    "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                    "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                    "  const t = parsed.TRANTIME;\r",
                    "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                    "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                    "\r",
                    "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                    "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TRANTIME 저장\r",
                    "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TID 저장\r",
                    "pm.environment.set(\"TID\", parsed.TID);\r",
                    "\r",
                    "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNO).to.eql(\"624404******8380\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                    "});\r",
                    "\r",
                    "// \"롯데카드\" 검증\r",
                    "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AE%C4%AB%B5%E5\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "cde39164-1c0a-47d2-bae4-f325b7263cdb"
                }
              }
            ]
          },
          {
            "id": "81f5d691-2c4d-4d29-9c6f-1e5bb1ef27b9",
            "name": "카드 승인 취소 (BILLCANCEL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "758b0130-950b-427e-8335-2676db6bc46f",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    AMOUNT: '301',\r",
                    "    TID: pm.environment.get(\"TID\"),\r",
                    "    CANCELTYPE: 'C',\r",
                    "    TXTYPE: 'CANCEL',\r",
                    "    SERVICETYPE: 'DANALCARD'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "fc035d9e-758b-4f8f-869f-0b8a39522fb2"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "da016859-4f4d-45c8-b5ba-3ee2b8b670ce",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                    "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "// 매출 발생시간과 비교 검증\r",
                    "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                    "});\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "763a2989-4dbb-4dd0-91bd-511fc0ba3f17"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "5e79bb1a-9ce5-45c8-8f08-c731b7b3a9b4",
        "name": "Kbank카드",
        "item": [
          {
            "id": "88f48784-9bb2-4322-993a-dbaf8afd1a5a",
            "name": "정기결제 요청 (OTBILL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "516e4913-2a3e-491c-8f57-b25502da3b2f",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    ITEMNAME: 'apiautotest',\r",
                    "    AMOUNT: '301',\r",
                    "    CURRENCY: '410',\r",
                    "    USERID: 'hnkim',\r",
                    "    USERAGENT: 'ONLINE',\r",
                    "    TXTYPE: 'OTBILL',\r",
                    "    SERVICETYPE: 'BATCH',\r",
                    "    ISREBILL: 'Y',\r",
                    "    BILLINFO: 'DC25121515231344D775'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "746a31f8-868e-4fd4-bc9a-42bd94a2e2d5"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "cf38c8dd-2a53-437e-8e4b-948543073f8d",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDCODE).to.eql(\"0921\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                    "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                    "  // 현재 시간 선언\r",
                    "  const now = new Date();\r",
                    "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                    "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                    "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                    "  const t = parsed.TRANTIME;\r",
                    "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                    "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                    "\r",
                    "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                    "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TRANTIME 저장\r",
                    "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TID 저장\r",
                    "pm.environment.set(\"TID\", parsed.TID);\r",
                    "\r",
                    "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNO).to.eql(\"485462******0767\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                    "});\r",
                    "\r",
                    "// \"삼성카드\" 검증\r",
                    "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNAME).to.eql(\"%C4%C9%C0%CC%B9%F0%C5%A9%C4%AB%B5%E5\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "fefcd827-3ff8-4467-81f3-2c2f6089ef54"
                }
              }
            ]
          },
          {
            "id": "4e4fab2e-1a8a-4dd3-89d1-529d8950a57c",
            "name": "카드 승인 취소 (BILLCANCEL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "b1db5a15-59a1-4f17-9afe-4a3e1cfa3a4a",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    AMOUNT: '301',\r",
                    "    TID: pm.environment.get(\"TID\"),\r",
                    "    CANCELTYPE: 'C',\r",
                    "    TXTYPE: 'CANCEL',\r",
                    "    SERVICETYPE: 'DANALCARD'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "1ef14771-5d8e-4f28-8b92-89a0bee05b76"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "8915aafa-49aa-447d-836b-daef4c4e6a90",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                    "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "// 매출 발생시간과 비교 검증\r",
                    "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                    "});\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "058fdf47-2031-4ef4-9546-3aa435888b1a"
                }
              }
            ]
          }
        ],
        "event": []
      },
      {
        "id": "eb00e65d-d8e5-4ca8-b3e8-6a7edf88c4dc",
        "name": "롯데카드",
        "item": [
          {
            "id": "38ae85ac-35a1-4d7b-87c9-3f8ddb4fb1a4",
            "name": "정기결제 요청 (OTBILL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "7ef25d99-d119-4561-a7dc-d4b3b21ef183",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    ITEMNAME: 'apiautotest',\r",
                    "    AMOUNT: '301',\r",
                    "    CURRENCY: '410',\r",
                    "    USERID: 'hnkim',\r",
                    "    USERAGENT: 'ONLINE',\r",
                    "    TXTYPE: 'OTBILL',\r",
                    "    SERVICETYPE: 'BATCH',\r",
                    "    ISREBILL: 'Y',\r",
                    "    BILLINFO: 'DC2512151453119224E3'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "2698e623-7f2b-4541-a36b-ae0fac938037"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "3825921f-46d4-44f5-ad63-49b97de5591e",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDCODE).to.eql(\"0700\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                    "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                    "  // 현재 시간 선언\r",
                    "  const now = new Date();\r",
                    "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                    "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                    "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                    "  const t = parsed.TRANTIME;\r",
                    "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                    "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                    "\r",
                    "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                    "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TRANTIME 저장\r",
                    "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "});\r",
                    "\r",
                    "// Environments에 TID 저장\r",
                    "pm.environment.set(\"TID\", parsed.TID);\r",
                    "\r",
                    "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                    "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNO).to.eql(\"513792******3380\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                    "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                    "});\r",
                    "\r",
                    "// \"롯데카드\" 검증\r",
                    "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.CARDNAME).to.eql(\"%B7%D4%B5%A5%C4%AB%B5%E5\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                    "});\r",
                    "\r",
                    "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "f50a0777-1a52-455b-a282-6d9de197bfa8"
                }
              }
            ]
          },
          {
            "id": "b79d88db-0555-4498-8e15-ae9734d61623",
            "name": "카드 승인 취소 (BILLCANCEL)",
            "request": {
              "url": {
                "host": [
                  "{{tx-credit}}"
                ],
                "query": [
                  {
                    "key": "CPID",
                    "value": "A010037544"
                  },
                  {
                    "key": "DATA",
                    "value": "{{encryptedData}}"
                  }
                ],
                "variable": []
              },
              "method": "POST"
            },
            "response": [],
            "event": [
              {
                "listen": "prerequest",
                "script": {
                  "id": "dd5bb67c-19e4-4b9b-8956-a2f5679eb2b7",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// 암호화 대상 데이터 (CPID 제외)\r",
                    "let params = {\r",
                    "    AMOUNT: '301',\r",
                    "    TID: pm.environment.get(\"TID\"),\r",
                    "    CANCELTYPE: 'C',\r",
                    "    TXTYPE: 'CANCEL',\r",
                    "    SERVICETYPE: 'DANALCARD'\r",
                    "};\r",
                    "\r",
                    "// Step 1: URL 인코딩 (key 제외, value만)\r",
                    "let encodedParams = [];\r",
                    "for (let key in params) {\r",
                    "    let value = encodeURIComponent(params[key]);\r",
                    "    encodedParams.push(`${key}=${value}`);\r",
                    "}\r",
                    "\r",
                    "// Step 2: QueryString 구성\r",
                    "let queryString = encodedParams.join('&');\r",
                    "\r",
                    "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                    "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 4: Base64 → URLEncoded\r",
                    "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                    "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                    "\r",
                    "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                    "pm.environment.set(\"encryptedData\", finalEncoded);"
                  ],
                  "_lastExecutionId": "2091eee0-6a50-4d4e-b444-645895229c23"
                }
              },
              {
                "listen": "test",
                "script": {
                  "id": "c848d220-b552-433d-a018-0e0f741c6a51",
                  "type": "text/javascript",
                  "packages": {},
                  "exec": [
                    "// Step 1: 응답을 텍스트로 가져옴\r",
                    "let rawText = pm.response.text();\r",
                    "\r",
                    "// Step 2: DATA= 뒤의 암호문만 추출\r",
                    "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                    "\r",
                    "// Step 3: URI 디코딩\r",
                    "let base64Cipher = decodeURIComponent(encryptedData);\r",
                    "\r",
                    "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                    "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                    "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                    "\r",
                    "// Step 5: AES 복호화\r",
                    "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                    "    iv: iv,\r",
                    "    mode: CryptoJS.mode.CBC,\r",
                    "    padding: CryptoJS.pad.Pkcs7\r",
                    "});\r",
                    "\r",
                    "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                    "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                    "console.log(\"복호화 결과 : \", result);\r",
                    "\r",
                    "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                    "pm.environment.set(\"decryptedResponse\", result);\r",
                    "\r",
                    "\r",
                    "/********************     Assertion     **********************/\r",
                    "\r",
                    "// Key-Value 파싱 함수\r",
                    "function parseQueryString(str) {\r",
                    "    return str.split(\"&\").reduce((acc, pair) => {\r",
                    "        const [key, value] = pair.split(\"=\");\r",
                    "        acc[key] = value || \"\";\r",
                    "        return acc;\r",
                    "    }, {});\r",
                    "}\r",
                    "\r",
                    "// 안전 디코딩 함수\r",
                    "function safeDecodeURIComponent(str) {\r",
                    "    try {\r",
                    "        return decodeURIComponent(str);\r",
                    "    } catch (e) {\r",
                    "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                    "        return str;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "const parsed = parseQueryString(result);\r",
                    "\r",
                    "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                    "});\r",
                    "\r",
                    "// \"성공\" 검증\r",
                    "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                    "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                    "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                    "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                    "    pm.expect(parsed.TID).to.not.be.empty;\r",
                    "    pm.expect(parsed.TID).to.not.be.null;\r",
                    "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                    "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                    "});\r",
                    "\r",
                    "// 매출 발생시간과 비교 검증\r",
                    "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                    "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                    "});\r",
                    "\r",
                    "// 현재 날짜 구하기 (yyyyMMdd)\r",
                    "function getYYYYMMDD() {\r",
                    "  const today = new Date();\r",
                    "  const yyyy = today.getFullYear();\r",
                    "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                    "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                    "\r",
                    "  return `${yyyy}${mm}${dd}`;\r",
                    "}\r",
                    "\r",
                    "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                    "\r",
                    "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                    "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                    "});\r",
                    "\r",
                    "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                    "});\r",
                    "\r",
                    "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                    "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                    "});"
                  ],
                  "_lastExecutionId": "27ae5c1e-c206-42cb-8822-3c5d485bf168"
                }
              }
            ]
          }
        ],
        "event": []
      }
    ],
    "event": [],
    "variable": [],
    "info": {
      "_postman_id": "ad14dfb9-75d7-4a97-85bf-8665f83ae3c1",
      "name": "Danal_CreditRebill_v1.0",
      "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
    }
  },
  "environment": {
    "_": {
      "postman_variable_scope": "environment",
      "postman_exported_at": "2025-08-18T05:02:37.387Z",
      "postman_exported_using": "Postman/11.58.5"
    },
    "id": "6094ec42-451a-414a-8cd4-1d771ed4e797",
    "name": "Danal_CreditRebill_v1.0",
    "values": [
      {
        "type": "any",
        "value": "https://tx-creditcard.danalpay.com/credit/",
        "key": "tx-credit"
      },
      {
        "type": "any",
        "value": "8kvDIwvdID7NWcBMND4uDTxEYY88YXtfM3g9P7zqCug6xdyr%2B4EGFtgpLmppE3fggETSMiebJvct2k9vrO0pxvIV4Syl6jBhNbENvjz%2B6Hf4CI6B6RPt2aL%2B7AhAcUVR",
        "key": "encryptedData"
      },
      {
        "type": "any",
        "value": "RETURNCODE=0000&RETURNMSG=%BC%BA%B0%F8&BALANCE=0&O_TID=202601070000284168544400&TID=202601070000298438634400&TRANTIME=000029&TRANDATE=20260107&AMOUNT=301&DEPOSIT_AMT=0",
        "key": "decryptedResponse"
      },
      {
        "type": "any",
        "value": "",
        "key": "startUrlDecoded"
      },
      {
        "type": "any",
        "value": "202601070000284168544400",
        "key": "TID"
      },
      {
        "type": "any",
        "value": "",
        "key": "TRANDATE"
      },
      {
        "type": "any",
        "value": "000029",
        "key": "TRANTIME"
      }
    ]
  },
  "globals": {
    "id": "041c5e72-d3d7-41f2-8e07-ff2682b53ba8",
    "values": []
  },
  "run": {
    "stats": {
      "iterations": {
        "total": 1,
        "pending": 0,
        "failed": 0
      },
      "items": {
        "total": 21,
        "pending": 0,
        "failed": 0
      },
      "scripts": {
        "total": 42,
        "pending": 0,
        "failed": 0
      },
      "prerequests": {
        "total": 21,
        "pending": 0,
        "failed": 0
      },
      "requests": {
        "total": 21,
        "pending": 0,
        "failed": 0
      },
      "tests": {
        "total": 21,
        "pending": 0,
        "failed": 0
      },
      "assertions": {
        "total": 250,
        "pending": 0,
        "failed": 25
      },
      "testScripts": {
        "total": 21,
        "pending": 0,
        "failed": 0
      },
      "prerequestScripts": {
        "total": 21,
        "pending": 0,
        "failed": 0
      }
    },
    "timings": {
      "responseAverage": 1175.7142857142858,
      "responseMin": 24,
      "responseMax": 1705,
      "responseSd": 523.3260062748051,
      "dnsAverage": 208.45280000194907,
      "dnsMin": 208.45280000194907,
      "dnsMax": 208.45280000194907,
      "dnsSd": 0,
      "firstByteAverage": 1162.9588952380277,
      "firstByteMin": 22.94759999960661,
      "firstByteMax": 1703.4415000006557,
      "firstByteSd": 544.5914162478515,
      "started": 1767711602312,
      "completed": 1767711630514
    },
    "executions": [
      {
        "cursor": {
          "position": 0,
          "iteration": 0,
          "length": 21,
          "cycles": 1,
          "empty": false,
          "eof": false,
          "bof": true,
          "cr": false,
          "ref": "956562af-3e02-458a-b190-a524bf19e44f",
          "httpRequestId": "876dff55-c4f4-4eab-90b1-a8ace7ac5ced"
        },
        "item": {
          "id": "1dbc1c20-93b6-4040-a47b-7764dc94cd63",
          "name": "READY - BATCH",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded; charset=UTF-8"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "db1d7967-44f3-40db-973b-4b910bc0dc6c",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "// 파싱 및 개별 디코딩\r",
                  "const parsed = parseQueryString(result);\r",
                  "const startUrlDecoded = safeDecodeURIComponent(parsed.STARTURL);\r",
                  "console.log(\"STARTURL(디코딩):\", startUrlDecoded);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메시지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"정기결제 초기인증 표준페이지 시작 URL(STARTURL) 정상출력\", function () {\r",
                  "    pm.expect(startUrlDecoded).to.eql(\"https://checkout.teledit.com/creditcard_recurring/web\")\r",
                  "})\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"위 표준페이지 시작 URL 전송 파라미터(STARTPARAMS) 정상출력\", function () {\r",
                  "    pm.expect(parsed.STARTPARAMS).to.not.be.undefined;\r",
                  "    pm.expect(parsed.STARTPARAMS).to.not.be.empty;\r",
                  "    pm.expect(parsed.STARTPARAMS).to.not.be.null;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"결제금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});"
                ],
                "_lastExecutionId": "852303b7-17e5-4699-9356-79698f7c7510"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "26f44523-80ef-410d-a519-6754249ab4e8",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'PC',\r",
                  "    TXTYPE: 'AUTH',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    CANCELURL: 'https://paytest.teledit.com:888/clientdemo/oneapi/returnFail.php',\r",
                  "    RETURNURL: 'https://paytest.teledit.com:888/clientdemo/oneapi/returnFail.php',\r",
                  "    ISBILL: 'Y',\r",
                  "    ISNOTI: 'N'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "a4a010f7-649f-475e-9300-fce0306a0cd4"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "wcpoTy27mkzR%2FoCmuhu%2BEL1VevUN6wQgs96fAg0NJdKChw9Ccm7hXXJcj%2FUGj%2Bb8z5dq8TvydwIj3RXPjUXi4PJAgyNbIM2hLz3kcfuDNAuCqSPVhBCpg6V8SYW3jJ%2FZIfE36F%2BlYYpMSgxO77gr%2BDwLH0n%2BtJG7ZAyj6rsqbDI3wCKhX4bzlTMTVKd8c%2BGAYmpCZ3i8%2BtXuuBm6g2NRznUDXGC09xQFVhQa4p6tQyOn5eKksesgLSgIMzKa6kDqC5%2BLzMcAl8IF7qCGgIqWAazfqDqnE0a5U%2BZ8p2HIn%2FENLsoKdJRXIlRiPnCOj5yDVfIQWasCSQLbccOu1NheelnZWQGZ5rGm%2FTC5F8i9Vs5%2BjHsIKtlMOIqeb%2BdxblE4thUJb9NDu3NPdadnhpnr9g%3D%3D"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "Content-Type",
              "value": "application/x-www-form-urlencoded; charset=UTF-8"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "6fe5d709-80b2-4388-861f-0bb6e4bb19a6",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "18c245e5-855b-4afa-8813-0f89f2fbfec4",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Set-Cookie",
              "value": "SCOUTER=z6v5huk1n1ev29; Expires=Sun, 24-Jan-2094 18:14:10 GMT; Path=/"
            },
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "805"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 15:00:03 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              85,
              80,
              100,
              37,
              50,
              66,
              75,
              48,
              72,
              110,
              79,
              120,
              87,
              84,
              105,
              75,
              82,
              70,
              102,
              111,
              72,
              107,
              98,
              104,
              52,
              52,
              88,
              117,
              70,
              111,
              37,
              50,
              70,
              49,
              89,
              70,
              101,
              52,
              51,
              115,
              114,
              82,
              81,
              52,
              79,
              74,
              79,
              120,
              104,
              76,
              115,
              57,
              53,
              86,
              65,
              114,
              97,
              53,
              115,
              37,
              50,
              70,
              86,
              83,
              76,
              107,
              122,
              50,
              101,
              99,
              73,
              53,
              113,
              81,
              80,
              49,
              74,
              68,
              55,
              70,
              105,
              68,
              56,
              48,
              56,
              115,
              55,
              72,
              105,
              80,
              100,
              52,
              55,
              88,
              107,
              74,
              49,
              78,
              110,
              116,
              73,
              71,
              72,
              71,
              55,
              122,
              115,
              99,
              119,
              57,
              120,
              106,
              37,
              50,
              66,
              102,
              115,
              103,
              51,
              101,
              116,
              117,
              55,
              110,
              115,
              78,
              78,
              101,
              73,
              105,
              107,
              75,
              87,
              86,
              114,
              84,
              49,
              71,
              86,
              82,
              78,
              105,
              79,
              53,
              79,
              82,
              115,
              84,
              122,
              65,
              56,
              37,
              50,
              66,
              118,
              54,
              118,
              106,
              37,
              50,
              66,
              48,
              52,
              121,
              90,
              103,
              100,
              112,
              69,
              73,
              101,
              54,
              88,
              83,
              56,
              97,
              112,
              122,
              54,
              103,
              66,
              108,
              89,
              76,
              90,
              100,
              103,
              120,
              116,
              122,
              53,
              110,
              71,
              53,
              71,
              102,
              37,
              50,
              70,
              114,
              75,
              84,
              79,
              113,
              102,
              77,
              37,
              50,
              70,
              37,
              50,
              66,
              99,
              48,
              101,
              117,
              72,
              102,
              86,
              120,
              57,
              51,
              116,
              76,
              110,
              73,
              77,
              48,
              84,
              52,
              107,
              98,
              71,
              122,
              68,
              78,
              76,
              119,
              104,
              76,
              69,
              76,
              78,
              37,
              50,
              66,
              86,
              112,
              107,
              73,
              69,
              87,
              109,
              54,
              102,
              119,
              79,
              85,
              65,
              121,
              98,
              78,
              70,
              122,
              108,
              73,
              90,
              49,
              103,
              75,
              118,
              37,
              50,
              66,
              87,
              100,
              56,
              99,
              78,
              69,
              55,
              79,
              106,
              117,
              51,
              120,
              55,
              69,
              83,
              102,
              103,
              72,
              66,
              114,
              56,
              49,
              106,
              113,
              114,
              119,
              120,
              101,
              81,
              90,
              84,
              87,
              113,
              106,
              109,
              83,
              83,
              78,
              87,
              48,
              70,
              87,
              97,
              115,
              114,
              90,
              113,
              57,
              52,
              56,
              72,
              113,
              117,
              86,
              57,
              84,
              55,
              68,
              86,
              87,
              87,
              73,
              102,
              77,
              65,
              119,
              109,
              101,
              71,
              110,
              76,
              82,
              120,
              49,
              103,
              121,
              90,
              77,
              79,
              51,
              120,
              79,
              51,
              65,
              56,
              115,
              109,
              104,
              118,
              117,
              83,
              102,
              54,
              104,
              85,
              57,
              53,
              118,
              110,
              87,
              110,
              86,
              77,
              37,
              50,
              70,
              115,
              111,
              49,
              65,
              114,
              37,
              50,
              66,
              116,
              117,
              82,
              119,
              67,
              105,
              54,
              103,
              103,
              72,
              107,
              105,
              57,
              115,
              122,
              89,
              103,
              48,
              54,
              37,
              50,
              66,
              88,
              104,
              85,
              77,
              51,
              101,
              121,
              68,
              80,
              57,
              97,
              89,
              98,
              87,
              78,
              82,
              37,
              50,
              66,
              48,
              79,
              53,
              99,
              90,
              70,
              103,
              77,
              104,
              52,
              80,
              106,
              66,
              115,
              110,
              37,
              50,
              70,
              103,
              113,
              55,
              74,
              113,
              119,
              37,
              50,
              70,
              103,
              122,
              109,
              72,
              51,
              67,
              108,
              76,
              54,
              89,
              88,
              109,
              70,
              85,
              119,
              90,
              109,
              87,
              72,
              74,
              110,
              120,
              89,
              50,
              54,
              68,
              104,
              76,
              115,
              70,
              37,
              50,
              66,
              65,
              102,
              54,
              90,
              89,
              74,
              115,
              52,
              115,
              88,
              49,
              71,
              70,
              75,
              108,
              76,
              97,
              111,
              66,
              90,
              104,
              53,
              68,
              98,
              71,
              114,
              110,
              72,
              76,
              73,
              114,
              37,
              50,
              66,
              57,
              65,
              50,
              115,
              115,
              99,
              103,
              89,
              90,
              117,
              112,
              117,
              81,
              71,
              67,
              51,
              102,
              80,
              113,
              57,
              54,
              90,
              120,
              111,
              104,
              55,
              71,
              119,
              120,
              121,
              37,
              50,
              66,
              37,
              50,
              70,
              117,
              76,
              71,
              108,
              77,
              72,
              120,
              106,
              66,
              65,
              89,
              83,
              79,
              109,
              52,
              57,
              57,
              105,
              80,
              119,
              115,
              110,
              56,
              110,
              108,
              37,
              50,
              66,
              103,
              68,
              68,
              37,
              50,
              66,
              121,
              116,
              69,
              76,
              82,
              108,
              66,
              49,
              88,
              69,
              78,
              117,
              88,
              79,
              51,
              66,
              107,
              122,
              86,
              68,
              88,
              106,
              49,
              48,
              88,
              112,
              117,
              122,
              80,
              87,
              77,
              97,
              100,
              53,
              85,
              110,
              65,
              110,
              77,
              114,
              114,
              72,
              70,
              109,
              109,
              48,
              103,
              65,
              90,
              86,
              115,
              86,
              72,
              114,
              118,
              50,
              109,
              52,
              57,
              112,
              69,
              88,
              79,
              97,
              102,
              72,
              118,
              51,
              88,
              104,
              102,
              67,
              51,
              68,
              110,
              37,
              50,
              66,
              117,
              104,
              98,
              120,
              108,
              69,
              57,
              77,
              79,
              108,
              115,
              122,
              73,
              121,
              112,
              74,
              70,
              74,
              87,
              84,
              74,
              48,
              89,
              88,
              90,
              113,
              53,
              81,
              110,
              122,
              76,
              106,
              57,
              119,
              53,
              114,
              84,
              84,
              100,
              54,
              80,
              77,
              90,
              79,
              119,
              109,
              74,
              56,
              83,
              97,
              54,
              116,
              115,
              85,
              111,
              52,
              73,
              104,
              103,
              65,
              119,
              54,
              117,
              54,
              104,
              106,
              117,
              65,
              72,
              101,
              84,
              50,
              53,
              101,
              71,
              122,
              102,
              115,
              88,
              69,
              81,
              56,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 289,
          "responseSize": 805
        },
        "id": "1dbc1c20-93b6-4040-a47b-7764dc94cd63",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메시지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "정기결제 초기인증 표준페이지 시작 URL(STARTURL) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "가맹점 주문번호(ORDERID) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "위 표준페이지 시작 URL 전송 파라미터(STARTPARAMS) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결제금액(AMOUNT) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "be50bf72-2f4f-4fe9-8b8b-bab66a5bf603",
          "length": 21,
          "cycles": 1,
          "position": 1,
          "iteration": 0,
          "httpRequestId": "2b037908-26c7-47a5-9866-42375f806c45"
        },
        "item": {
          "id": "b3a7fa52-a139-454b-ad0a-1cded525940b",
          "name": "READY - DANALCARD",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded; charset=UTF-8"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "07ad47b9-d529-43d7-9ff5-45b826879102",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "// 파싱 및 개별 디코딩\r",
                  "const parsed = parseQueryString(result);\r",
                  "const startUrlDecoded = safeDecodeURIComponent(parsed.STARTURL);\r",
                  "console.log(\"STARTURL(디코딩):\", startUrlDecoded);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메시지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"정기결제 초기인증 표준페이지 시작 URL(STARTURL) 정상출력\", function () {\r",
                  "    pm.expect(startUrlDecoded).to.eql(\"https://checkout.teledit.com/creditcard_std/web\")\r",
                  "})\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"위 표준페이지 시작 URL 전송 파라미터(STARTPARAMS) 정상출력\", function () {\r",
                  "    pm.expect(parsed.STARTPARAMS).to.not.be.undefined;\r",
                  "    pm.expect(parsed.STARTPARAMS).to.not.be.empty;\r",
                  "    pm.expect(parsed.STARTPARAMS).to.not.be.null;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"결제금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});"
                ],
                "_lastExecutionId": "ea0e8cc5-5667-45b7-8b0f-3985ba085d5f"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "6801754b-ed63-4a84-be23-093bd8cdb221",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'PC',\r",
                  "    TXTYPE: 'AUTH',\r",
                  "    SERVICETYPE: 'DANALCARD',\r",
                  "    CANCELURL: 'https://paytest.teledit.com:888/clientdemo/oneapi/returnFail.php',\r",
                  "    RETURNURL: 'https://paytest.teledit.com:888/clientdemo/oneapi/returnFail.php',\r",
                  "    ISBILL: 'Y',\r",
                  "    ISNOTI: 'N'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "a71af66e-4e73-43c7-9e98-9dcecc9ae8c7"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "wcpoTy27mkzR%2FoCmuhu%2BEL1VevUN6wQgs96fAg0NJdKChw9Ccm7hXXJcj%2FUGj%2Bb8z5dq8TvydwIj3RXPjUXi4PJAgyNbIM2hLz3kcfuDNAsCL18rdUmVCzFjEXB9wjgQ82IteFWZK11Um66aaXg9%2BmJBA%2BzStWEMjr0dSocIEm%2Bbu9cYhIHHrFuuMeAbp0%2FaOn9YPjFswBAcVkFCl4MZNYRXi9%2BMiA7xwR%2FFNE00HJ0pC21O5yf5imQNizmVqk2bD03K20FpT3Fs3h%2FUCOJ0UXofslr6lyNGsyvb6DemiNcWC4LE3zCDhJmfdiJa9ITHGb2ToWrxU2XD3B50so4Ru4EZtRrOIrbszRI9doqcDx5dZKeCsMBh%2Ff1PMU0qTPX5ctV%2BHYz%2F289vKWnUu4B9CA%3D%3D"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "Content-Type",
              "value": "application/x-www-form-urlencoded; charset=UTF-8"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "2bdbc99b-1976-4172-b19d-8a1a1e6d33d9",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z6v5huk1n1ev29",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "c7038bb4-31c6-4921-a4c9-24109d050a4c",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "779"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 15:00:03 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              85,
              80,
              100,
              37,
              50,
              66,
              75,
              48,
              72,
              110,
              79,
              120,
              87,
              84,
              105,
              75,
              82,
              70,
              102,
              111,
              72,
              107,
              98,
              104,
              52,
              52,
              88,
              117,
              70,
              111,
              37,
              50,
              70,
              49,
              89,
              70,
              101,
              52,
              51,
              115,
              114,
              82,
              81,
              52,
              79,
              74,
              79,
              120,
              104,
              76,
              115,
              57,
              53,
              86,
              65,
              114,
              97,
              53,
              115,
              37,
              50,
              70,
              86,
              83,
              76,
              107,
              122,
              50,
              101,
              99,
              73,
              53,
              113,
              81,
              80,
              49,
              74,
              68,
              55,
              70,
              105,
              68,
              56,
              48,
              56,
              115,
              55,
              72,
              105,
              80,
              100,
              52,
              97,
              105,
              70,
              118,
              66,
              106,
              114,
              51,
              113,
              89,
              111,
              122,
              100,
              72,
              81,
              53,
              88,
              122,
              103,
              106,
              53,
              75,
              54,
              116,
              37,
              50,
              70,
              49,
              120,
              69,
              83,
              111,
              111,
              65,
              37,
              50,
              66,
              74,
              50,
              107,
              79,
              81,
              101,
              37,
              50,
              66,
              69,
              53,
              51,
              105,
              105,
              118,
              104,
              71,
              50,
              103,
              80,
              106,
              100,
              119,
              52,
              119,
              119,
              122,
              57,
              86,
              121,
              65,
              111,
              115,
              100,
              118,
              55,
              84,
              49,
              86,
              114,
              84,
              89,
              105,
              99,
              56,
              97,
              90,
              98,
              79,
              113,
              87,
              117,
              37,
              50,
              70,
              72,
              118,
              37,
              50,
              66,
              88,
              54,
              86,
              83,
              80,
              76,
              70,
              99,
              66,
              109,
              52,
              121,
              72,
              51,
              79,
              85,
              66,
              87,
              70,
              53,
              51,
              37,
              50,
              70,
              121,
              111,
              82,
              54,
              90,
              115,
              77,
              100,
              101,
              65,
              53,
              109,
              67,
              67,
              56,
              78,
              73,
              82,
              101,
              73,
              86,
              86,
              112,
              71,
              107,
              77,
              113,
              100,
              118,
              71,
              52,
              107,
              98,
              102,
              37,
              50,
              70,
              108,
              120,
              51,
              101,
              71,
              80,
              105,
              122,
              74,
              108,
              116,
              53,
              73,
              50,
              111,
              118,
              102,
              77,
              54,
              109,
              112,
              48,
              117,
              121,
              50,
              110,
              99,
              52,
              90,
              53,
              82,
              55,
              104,
              102,
              74,
              79,
              49,
              97,
              98,
              115,
              77,
              105,
              56,
              82,
              73,
              117,
              85,
              75,
              119,
              70,
              114,
              56,
              108,
              69,
              68,
              120,
              79,
              85,
              48,
              109,
              86,
              68,
              117,
              120,
              116,
              77,
              53,
              117,
              80,
              37,
              50,
              66,
              89,
              89,
              78,
              57,
              113,
              73,
              117,
              76,
              67,
              88,
              49,
              88,
              115,
              119,
              103,
              108,
              77,
              103,
              48,
              86,
              86,
              105,
              121,
              122,
              106,
              66,
              89,
              72,
              105,
              66,
              57,
              114,
              48,
              37,
              50,
              66,
              77,
              55,
              120,
              71,
              56,
              104,
              48,
              119,
              65,
              117,
              74,
              65,
              53,
              67,
              68,
              51,
              117,
              50,
              69,
              69,
              110,
              99,
              97,
              82,
              99,
              49,
              55,
              71,
              107,
              100,
              76,
              98,
              50,
              84,
              106,
              65,
              77,
              97,
              120,
              98,
              65,
              118,
              57,
              86,
              75,
              120,
              121,
              101,
              117,
              76,
              51,
              115,
              122,
              121,
              111,
              52,
              53,
              118,
              89,
              89,
              115,
              103,
              97,
              88,
              108,
              80,
              75,
              105,
              51,
              114,
              105,
              106,
              73,
              86,
              55,
              72,
              103,
              102,
              83,
              109,
              51,
              82,
              83,
              50,
              68,
              52,
              49,
              110,
              101,
              52,
              51,
              97,
              37,
              50,
              70,
              76,
              112,
              69,
              48,
              88,
              114,
              98,
              97,
              57,
              67,
              104,
              77,
              102,
              101,
              51,
              75,
              71,
              113,
              75,
              120,
              88,
              120,
              75,
              97,
              98,
              76,
              81,
              103,
              99,
              104,
              90,
              100,
              106,
              83,
              106,
              111,
              101,
              49,
              82,
              99,
              49,
              103,
              48,
              99,
              120,
              110,
              90,
              83,
              97,
              54,
              69,
              106,
              117,
              80,
              87,
              49,
              70,
              79,
              57,
              122,
              49,
              97,
              48,
              80,
              121,
              109,
              112,
              88,
              48,
              122,
              79,
              77,
              98,
              118,
              118,
              55,
              119,
              118,
              37,
              50,
              66,
              78,
              100,
              79,
              65,
              57,
              55,
              79,
              49,
              103,
              100,
              82,
              82,
              89,
              37,
              50,
              66,
              110,
              71,
              50,
              52,
              97,
              75,
              65,
              106,
              86,
              89,
              110,
              82,
              100,
              74,
              106,
              55,
              102,
              105,
              87,
              70,
              70,
              112,
              104,
              75,
              52,
              106,
              121,
              87,
              116,
              107,
              107,
              119,
              53,
              80,
              102,
              83,
              69,
              65,
              101,
              80,
              48,
              37,
              50,
              66,
              104,
              89,
              109,
              122,
              51,
              37,
              50,
              66,
              88,
              73,
              80,
              107,
              111,
              50,
              106,
              122,
              81,
              48,
              78,
              65,
              54,
              97,
              83,
              69,
              78,
              70,
              67,
              104,
              103,
              112,
              116,
              48,
              104,
              112,
              88,
              71,
              79,
              67,
              113,
              72,
              81,
              98,
              83,
              109,
              112,
              98,
              37,
              50,
              66,
              111,
              90,
              71,
              79,
              101,
              122,
              77,
              89,
              52,
              50,
              111,
              122,
              107,
              80,
              80,
              120,
              37,
              50,
              66,
              112,
              89,
              119,
              55,
              116,
              106,
              76,
              118,
              54,
              113,
              50,
              73,
              101,
              115,
              79,
              112,
              117,
              101,
              51,
              82,
              72,
              49,
              117,
              89,
              52,
              67,
              86,
              101,
              76,
              52,
              66,
              117,
              71,
              99,
              52,
              73,
              84,
              71,
              54,
              66,
              103,
              57,
              51,
              114,
              110,
              105,
              74,
              88,
              82,
              103,
              80,
              49,
              37,
              50,
              66,
              114,
              102,
              67,
              88,
              98,
              100,
              81,
              37,
              51,
              68,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 33,
          "responseSize": 779
        },
        "id": "b3a7fa52-a139-454b-ad0a-1cded525940b",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메시지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "정기결제 초기인증 표준페이지 시작 URL(STARTURL) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "가맹점 주문번호(ORDERID) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "위 표준페이지 시작 URL 전송 파라미터(STARTPARAMS) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결제금액(AMOUNT) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "7285c0ac-7012-4af6-af3c-13968348cc90",
          "length": 21,
          "cycles": 1,
          "position": 2,
          "iteration": 0,
          "httpRequestId": "55700dba-aafc-4717-b283-81bd1a224497"
        },
        "item": {
          "id": "0b59d194-e1d9-46c7-a996-daeb9888f7c4",
          "name": "ISSUEBILLKEY",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded; charset=UTF-8"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "baf16a2d-10c1-487f-aab2-6965dceb8f87",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get('TID'),\r",
                  "    TXTYPE: 'ISSUEBILLKEY',\r",
                  "    SERVICETYPE: 'BATCH'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "b7ec26cd-15ab-496a-be45-642dc5e5cdad"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "e0f95b50-c0d2-4fe9-91fb-5a4a36c37a16",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "// 파싱 및 개별 디코딩\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) : 1104 출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"1104\")\r",
                  "});\r",
                  "\r",
                  "// \"존재하지 않는 거래 입니다.\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) : 존재하지 않는 거래입니다. 출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%C1%B8%C0%E7%C7%CF%C1%F6+%BE%CA%B4%C2+%B0%C5%B7%A1+%C0%D4%B4%CF%B4%D9.\")\r",
                  "});"
                ],
                "_lastExecutionId": "a88735c4-a275-4f86-a18d-87d11077f50f"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "8kvDIwvdID7NWcBMND4uDXHvMUqO25iIdKkD6XH4VkTYfgoBPJqjGpr15Fqq4CCxlzQc11Pn06IJSodR9hnt4%2FgbXDCdFcZ2uADRjw%2Fvh8Q%3D"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "Content-Type",
              "value": "application/x-www-form-urlencoded; charset=UTF-8"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "3626e8d4-fc0c-4d3f-b122-149e54622d6b",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z6v5huk1n1ev29",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "8eaee253-1fa6-477b-a9dd-8526331d5aa6",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "173"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 15:00:03 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              102,
              117,
              54,
              83,
              50,
              114,
              73,
              76,
              75,
              49,
              37,
              50,
              70,
              69,
              48,
              108,
              103,
              69,
              121,
              75,
              71,
              81,
              51,
              97,
              115,
              54,
              107,
              69,
              107,
              75,
              101,
              114,
              56,
              72,
              66,
              109,
              89,
              119,
              80,
              108,
              76,
              84,
              81,
              80,
              113,
              101,
              87,
              101,
              111,
              48,
              116,
              97,
              76,
              106,
              111,
              73,
              113,
              89,
              51,
              110,
              116,
              53,
              77,
              57,
              65,
              105,
              110,
              57,
              37,
              50,
              70,
              100,
              83,
              114,
              110,
              101,
              121,
              53,
              88,
              107,
              55,
              78,
              56,
              114,
              114,
              88,
              101,
              68,
              97,
              116,
              88,
              109,
              88,
              51,
              99,
              66,
              107,
              87,
              56,
              65,
              75,
              37,
              50,
              70,
              104,
              117,
              114,
              49,
              48,
              51,
              74,
              67,
              80,
              107,
              37,
              50,
              70,
              103,
              110,
              72,
              73,
              102,
              103,
              107,
              78,
              117,
              120,
              115,
              73,
              101,
              81,
              70,
              83,
              118,
              73,
              102,
              73,
              37,
              50,
              70,
              72,
              49,
              74,
              84,
              105,
              55,
              116,
              87,
              79,
              111,
              99,
              37,
              50,
              66,
              109,
              103,
              84,
              51,
              100,
              99,
              88,
              65,
              37,
              51,
              68,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 24,
          "responseSize": 173
        },
        "id": "0b59d194-e1d9-46c7-a996-daeb9888f7c4",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) : 1104 출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) : 존재하지 않는 거래입니다. 출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "7cae2614-0311-4bf0-80f1-d7c3aa0a998f",
          "length": 21,
          "cycles": 1,
          "position": 3,
          "iteration": 0,
          "httpRequestId": "4f85fd65-de1e-4f0f-9ccb-1e972aaa232e"
        },
        "item": {
          "id": "2f4b3ee6-1ddf-412a-8e7b-e7e2991b61fe",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded; charset=UTF-8"
              }
            ],
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "71a61e4e-3924-4901-9c9a-dba648305451",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC250730151749FFCAA0',\r",
                  "    USERNAME: '김하늘',\r",
                  "    USERPHONE: '01085402697',\r",
                  "    ORDERID: '01234567'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "9f2bd34b-69d9-4aa5-8b0a-a07e2005c618"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "e17ce76a-ecbe-4430-85a8-beb75ee3f7e7",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0500\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.eql(\"01085402697\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.eql(\"01234567\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"512028******7294\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BB%EF%BC%BA%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.eql(\"%EA%B9%3F%3F%3F%3F%3F\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "89548491-0fa1-477c-a8c2-508f14a3f34d"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "wcpoTy27mkzR%2FoCmuhu%2BEL1VevUN6wQgs96fAg0NJdKChw9Ccm7hXXJcj%2FUGj%2Bb8z5dq8TvydwIj3RXPjUXi4KzQHH0ZG0DZA03Udge2eI0IsrkEsoTSxKLbYyq5iCvbykTt6GhW9hCDbp8fHC1zGJEYvBJNsjEqz2X9zw2JzccrERjqayECmibASVLCFcu3mtMwnyeSqsDkh6Ok0RVNhbkzCgrGZvyWLuE0qblstQgkt2NYUzE21ScHAo%2BsYJOcT3xCtYEislZjbacyD1Wou68o56siY3%2FOkdyV%2FLh5ZjM%3D"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "Content-Type",
              "value": "application/x-www-form-urlencoded; charset=UTF-8"
            },
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "099ce40a-29d4-4097-bb6e-6a117a75cf0d",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z6v5huk1n1ev29",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "6fa65068-2ccb-439c-9385-35091f68bead",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "481"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 15:00:05 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              85,
              79,
              114,
              84,
              50,
              122,
              98,
              84,
              116,
              90,
              116,
              65,
              104,
              54,
              52,
              50,
              115,
              86,
              101,
              74,
              54,
              83,
              105,
              110,
              122,
              90,
              79,
              117,
              104,
              37,
              50,
              70,
              73,
              90,
              56,
              73,
              52,
              117,
              100,
              113,
              98,
              71,
              72,
              116,
              66,
              107,
              104,
              103,
              100,
              105,
              37,
              50,
              66,
              77,
              100,
              87,
              117,
              68,
              82,
              87,
              57,
              101,
              107,
              115,
              72,
              103,
              87,
              73,
              66,
              103,
              120,
              109,
              115,
              78,
              111,
              98,
              118,
              80,
              87,
              88,
              82,
              120,
              104,
              100,
              76,
              103,
              67,
              87,
              112,
              108,
              72,
              106,
              106,
              87,
              114,
              70,
              100,
              66,
              37,
              50,
              66,
              72,
              115,
              57,
              101,
              52,
              70,
              88,
              102,
              122,
              74,
              101,
              50,
              104,
              102,
              86,
              106,
              78,
              115,
              116,
              73,
              116,
              116,
              80,
              77,
              116,
              90,
              72,
              70,
              86,
              108,
              105,
              50,
              67,
              118,
              122,
              54,
              109,
              103,
              107,
              74,
              57,
              74,
              70,
              84,
              98,
              106,
              68,
              80,
              71,
              72,
              105,
              83,
              117,
              90,
              104,
              37,
              50,
              66,
              53,
              114,
              57,
              37,
              50,
              70,
              50,
              87,
              109,
              83,
              37,
              50,
              70,
              77,
              87,
              84,
              109,
              110,
              83,
              98,
              75,
              97,
              113,
              73,
              111,
              55,
              100,
              37,
              50,
              70,
              122,
              113,
              113,
              117,
              86,
              74,
              118,
              110,
              115,
              101,
              74,
              85,
              106,
              86,
              116,
              74,
              73,
              81,
              116,
              106,
              72,
              56,
              72,
              117,
              101,
              77,
              86,
              85,
              72,
              118,
              122,
              84,
              55,
              56,
              81,
              113,
              52,
              75,
              110,
              50,
              104,
              76,
              119,
              52,
              110,
              110,
              49,
              53,
              84,
              72,
              77,
              50,
              54,
              66,
              53,
              108,
              56,
              103,
              80,
              70,
              80,
              118,
              109,
              90,
              72,
              119,
              97,
              55,
              66,
              79,
              37,
              50,
              70,
              107,
              89,
              65,
              68,
              68,
              117,
              55,
              80,
              88,
              99,
              100,
              81,
              120,
              55,
              51,
              86,
              65,
              79,
              50,
              70,
              105,
              74,
              117,
              54,
              120,
              108,
              78,
              54,
              114,
              101,
              81,
              68,
              65,
              83,
              84,
              77,
              112,
              87,
              113,
              80,
              119,
              37,
              50,
              66,
              100,
              98,
              52,
              83,
              54,
              121,
              84,
              77,
              107,
              50,
              67,
              107,
              86,
              107,
              101,
              84,
              109,
              110,
              100,
              54,
              102,
              82,
              37,
              50,
              70,
              72,
              83,
              111,
              118,
              79,
              118,
              68,
              100,
              115,
              69,
              110,
              68,
              67,
              119,
              78,
              65,
              115,
              118,
              65,
              110,
              85,
              48,
              85,
              112,
              122,
              104,
              37,
              50,
              70,
              100,
              80,
              109,
              110,
              115,
              76,
              74,
              49,
              107,
              67,
              114,
              54,
              37,
              50,
              70,
              76,
              108,
              121,
              106,
              119,
              109,
              109,
              115,
              49,
              90,
              107,
              54,
              86,
              79,
              77,
              119,
              50,
              88,
              97,
              122,
              66,
              67,
              103,
              99,
              48,
              120,
              120,
              104,
              113,
              111,
              100,
              98,
              51,
              66,
              108,
              65,
              84,
              53,
              56,
              117,
              102,
              57,
              121,
              99,
              80,
              100,
              116,
              108,
              122,
              114,
              69,
              48,
              109,
              74,
              37,
              50,
              66
            ]
          },
          "cookie": [],
          "responseTime": 1523,
          "responseSize": 481
        },
        "id": "2f4b3ee6-1ddf-412a-8e7b-e7e2991b61fe",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 코드(CARDCODE 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 전화번호(USERPHONE) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "할부 개월 수(QUOTA) 정상출력",
            "skipped": false
          },
          {
            "assertion": "매출 발생시간(TRANTIME) ±5초 이내 검증",
            "skipped": false
          },
          {
            "assertion": "매출 발생일자(TRANDATE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "상품명(ITEMNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "가맹점 주문번호(ORDERID) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "카드번호(CARDNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "거래 승인 번호(CARDAUTHNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 명(CARDNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 이름(USERNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 ID(USERID) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "5e26e994-2abd-452c-8230-e8959d57ac76",
          "length": 21,
          "cycles": 1,
          "position": 4,
          "iteration": 0,
          "httpRequestId": "e691e250-c3c1-4dd0-8567-511dca192274"
        },
        "item": {
          "id": "24898af4-501d-4567-b9da-462b76df061e",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "c639df6b-0251-4682-9b6b-037c8921317a",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "3bf3f226-b9d3-460e-8961-293db51c8fe5"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "3da63183-d401-41d1-b88f-ce29df6907ba",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "618e1d26-05ea-4cad-96a1-c442814a4b5b"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "8kvDIwvdID7NWcBMND4uDZ4LOwHbovA9wWVlnJA3hCscaqjTHiHwjN2xYGhJDEdcs4mM3tOzwj%2BoyFSZFvzHZtQgZdRw7f%2Bj%2Bsz9mYwdGN5ALl2eWWptC%2BLH0Ny80Xf%2B"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "598f8bc9-80e8-4a7c-b031-f6619d7d9fc7",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z6v5huk1n1ev29",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "09415232-c862-4e3e-abe9-a82197e80360",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "265"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 15:00:06 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              86,
              122,
              104,
              72,
              85,
              53,
              115,
              100,
              101,
              115,
              52,
              48,
              103,
              114,
              118,
              75,
              109,
              122,
              105,
              37,
              50,
              66,
              114,
              88,
              112,
              69,
              99,
              109,
              104,
              55,
              106,
              76,
              56,
              116,
              118,
              81,
              56,
              121,
              77,
              75,
              108,
              105,
              102,
              109,
              112,
              48,
              66,
              104,
              90,
              82,
              88,
              85,
              115,
              76,
              50,
              50,
              110,
              67,
              101,
              81,
              108,
              102,
              52,
              98,
              103,
              79,
              97,
              98,
              37,
              50,
              70,
              112,
              74,
              108,
              75,
              117,
              65,
              100,
              113,
              37,
              50,
              66,
              49,
              37,
              50,
              66,
              57,
              101,
              37,
              50,
              70,
              69,
              88,
              101,
              56,
              83,
              117,
              106,
              51,
              48,
              107,
              69,
              116,
              82,
              97,
              111,
              108,
              56,
              76,
              110,
              51,
              118,
              72,
              70,
              68,
              79,
              111,
              88,
              104,
              72,
              54,
              113,
              122,
              82,
              57,
              114,
              37,
              50,
              66,
              114,
              77,
              118,
              66,
              106,
              79,
              101,
              110,
              55,
              119,
              97,
              77,
              53,
              57,
              51,
              49,
              37,
              50,
              66,
              79,
              37,
              50,
              70,
              52,
              112,
              88,
              119,
              86,
              101,
              78,
              73,
              56,
              113,
              107,
              82,
              51,
              104,
              114,
              66,
              106,
              75,
              52,
              54,
              100,
              90,
              101,
              84,
              81,
              48,
              102,
              76,
              79,
              80,
              37,
              50,
              66,
              114,
              100,
              105,
              76,
              88,
              77,
              51,
              37,
              50,
              66,
              76,
              71,
              83,
              103,
              76,
              118,
              115,
              108,
              112,
              112,
              118,
              56,
              118,
              70,
              74,
              49,
              99,
              99,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1404,
          "responseSize": 265
        },
        "id": "24898af4-501d-4567-b9da-462b76df061e",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "취소 후 잔액(BALANCE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 원 거래 키(O_TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생시간(TRANTIME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생일자(TRANDATE)",
            "skipped": false
          },
          {
            "assertion": "승인 취소 금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "041a3580-9b40-4b6b-befb-cf1d001046ed",
          "length": 21,
          "cycles": 1,
          "position": 5,
          "iteration": 0,
          "httpRequestId": "cc08fdc7-e919-47f9-a536-84deee397588"
        },
        "item": {
          "id": "2fc9ead6-7e9d-4633-b93b-12d79bdabb54",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "d0823084-7854-46b3-afce-092d80aa1dd0",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC221222165535557F38'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "4f7f0bb9-876f-4c8c-bf00-40a6d4bf1e89"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "27224ca3-531f-4b3d-ac6b-3dbaf87b8c2a",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0400\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"403293******4003\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"현대카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%C7%F6%B4%EB%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "})\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "fd8eae81-08c7-4151-9589-52f0490d6189"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "wcpoTy27mkzR%2FoCmuhu%2BEL1VevUN6wQgs96fAg0NJdKChw9Ccm7hXXJcj%2FUGj%2Bb8z5dq8TvydwIj3RXPjUXi4KzQHH0ZG0DZA03Udge2eI0IsrkEsoTSxKLbYyq5iCvbykTt6GhW9hCDbp8fHC1zGJEYvBJNsjEqz2X9zw2JzceacjSE9wkZ8OEcuyhqS4aTCOgYJsVDSvmkj%2FNDn1RD1w%3D%3D"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "778d7ab1-f101-40be-8347-a3dcaccc214b",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z6v5huk1n1ev29",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "74da3d9f-2e12-4fbd-ace0-c0d764131fee",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "435"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 15:00:08 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              85,
              79,
              114,
              84,
              50,
              122,
              98,
              84,
              116,
              90,
              116,
              65,
              104,
              54,
              52,
              50,
              115,
              86,
              101,
              74,
              54,
              83,
              53,
              70,
              88,
              84,
              104,
              82,
              70,
              68,
              71,
              122,
              97,
              100,
              67,
              102,
              82,
              75,
              111,
              97,
              74,
              107,
              107,
              50,
              55,
              78,
              97,
              109,
              97,
              54,
              87,
              111,
              56,
              52,
              81,
              100,
              84,
              108,
              107,
              83,
              116,
              106,
              99,
              99,
              113,
              50,
              108,
              37,
              50,
              70,
              56,
              57,
              37,
              50,
              70,
              112,
              66,
              121,
              37,
              50,
              70,
              110,
              49,
              100,
              118,
              118,
              57,
              122,
              81,
              69,
              84,
              57,
              72,
              121,
              67,
              37,
              50,
              70,
              101,
              107,
              117,
              113,
              71,
              104,
              98,
              89,
              116,
              120,
              108,
              119,
              51,
              98,
              51,
              82,
              55,
              76,
              114,
              49,
              112,
              108,
              120,
              76,
              76,
              98,
              85,
              52,
              49,
              68,
              50,
              115,
              56,
              81,
              86,
              68,
              113,
              70,
              109,
              115,
              106,
              87,
              103,
              107,
              115,
              71,
              70,
              55,
              53,
              89,
              80,
              88,
              50,
              51,
              100,
              72,
              55,
              37,
              50,
              66,
              71,
              78,
              52,
              120,
              114,
              79,
              117,
              52,
              82,
              103,
              114,
              101,
              117,
              49,
              120,
              115,
              79,
              75,
              102,
              87,
              104,
              116,
              116,
              69,
              109,
              83,
              74,
              113,
              99,
              89,
              54,
              57,
              70,
              120,
              114,
              48,
              81,
              51,
              52,
              108,
              85,
              75,
              120,
              50,
              70,
              112,
              117,
              107,
              99,
              102,
              52,
              52,
              109,
              119,
              116,
              82,
              122,
              89,
              102,
              115,
              107,
              111,
              105,
              83,
              116,
              104,
              102,
              116,
              52,
              114,
              80,
              117,
              97,
              107,
              115,
              73,
              113,
              112,
              103,
              115,
              107,
              105,
              52,
              79,
              106,
              48,
              57,
              80,
              82,
              122,
              108,
              89,
              114,
              76,
              97,
              101,
              121,
              102,
              85,
              107,
              80,
              85,
              101,
              116,
              90,
              103,
              106,
              56,
              67,
              77,
              52,
              86,
              102,
              68,
              109,
              86,
              73,
              105,
              122,
              102,
              77,
              82,
              99,
              87,
              55,
              72,
              106,
              107,
              80,
              111,
              50,
              68,
              55,
              117,
              72,
              70,
              70,
              84,
              107,
              121,
              101,
              110,
              122,
              117,
              108,
              81,
              97,
              55,
              116,
              66,
              117,
              37,
              50,
              66,
              104,
              66,
              119,
              49,
              100,
              70,
              51,
              75,
              106,
              97,
              119,
              108,
              102,
              81,
              120,
              84,
              80,
              113,
              106,
              89,
              105,
              100,
              116,
              103,
              65,
              88,
              114,
              49,
              122,
              84,
              77,
              100,
              57,
              113,
              87,
              74,
              78,
              77,
              121,
              80,
              104,
              121,
              113,
              68,
              70,
              49,
              81,
              118,
              88,
              82,
              119,
              37,
              50,
              66,
              52,
              89,
              37,
              50,
              70,
              99,
              66,
              55,
              112,
              119,
              65,
              97,
              75,
              103,
              37,
              51,
              68,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1311,
          "responseSize": 435
        },
        "id": "2fc9ead6-7e9d-4633-b93b-12d79bdabb54",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 코드(CARDCODE 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 전화번호(USERPHONE) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "할부 개월 수(QUOTA) 정상출력",
            "skipped": false
          },
          {
            "assertion": "매출 발생시간(TRANTIME) ±5초 이내 검증",
            "skipped": false
          },
          {
            "assertion": "매출 발생일자(TRANDATE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "상품명(ITEMNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "가맹점 주문번호(ORDERID) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "카드번호(CARDNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "거래 승인 번호(CARDAUTHNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 명(CARDNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 이름(USERNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 ID(USERID) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "d353820b-1f95-4161-8341-848a7ecc3973",
          "length": 21,
          "cycles": 1,
          "position": 6,
          "iteration": 0,
          "httpRequestId": "3fd314b5-79ca-496f-94cf-6b20a6af0559"
        },
        "item": {
          "id": "0455914c-74ca-4916-b875-d8928809ad72",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "6526b131-0d36-41c0-bf6a-b06502f6c50c",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "f031d13d-7f74-4e4c-ba78-6984aee3848a"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "3afafe74-f6df-4487-8e09-4313a0652952",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "daea3ace-7aab-4e2c-9c6d-9a981220e013"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "8kvDIwvdID7NWcBMND4uDWx1AF61DO15baRmxXKLQGDupEauN7tsxD0wzCuRgIhIDp1Lvo63c0sRxk%2FG0nulZ3IprOQLuQbTDOe8Ule078RGsJz1RAe0p3%2F20O3VIttI"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "7e1fb238-b073-4b2d-b486-1f007deb403b",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z6v5huk1n1ev29",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "379a7cbd-55f4-4c1e-b718-89a2b41e9790",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "255"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 15:00:09 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              86,
              122,
              104,
              72,
              85,
              53,
              115,
              100,
              101,
              115,
              52,
              48,
              103,
              114,
              118,
              75,
              109,
              122,
              105,
              37,
              50,
              66,
              114,
              88,
              112,
              69,
              99,
              109,
              104,
              55,
              106,
              76,
              56,
              116,
              118,
              81,
              56,
              121,
              77,
              75,
              108,
              105,
              102,
              109,
              112,
              37,
              50,
              66,
              119,
              72,
              84,
              87,
              105,
              83,
              55,
              122,
              117,
              72,
              89,
              78,
              121,
              54,
              49,
              71,
              101,
              119,
              103,
              110,
              50,
              104,
              120,
              79,
              116,
              102,
              97,
              122,
              52,
              122,
              70,
              77,
              78,
              114,
              81,
              54,
              51,
              103,
              73,
              55,
              104,
              120,
              118,
              122,
              108,
              98,
              50,
              112,
              107,
              116,
              101,
              77,
              105,
              121,
              111,
              100,
              104,
              120,
              108,
              66,
              53,
              101,
              52,
              56,
              116,
              97,
              97,
              118,
              83,
              50,
              103,
              107,
              68,
              37,
              50,
              70,
              109,
              78,
              53,
              120,
              79,
              53,
              113,
              99,
              106,
              52,
              98,
              100,
              76,
              103,
              37,
              50,
              66,
              76,
              122,
              56,
              81,
              86,
              112,
              81,
              102,
              110,
              71,
              118,
              122,
              99,
              98,
              87,
              79,
              122,
              105,
              66,
              66,
              76,
              49,
              109,
              122,
              117,
              109,
              86,
              90,
              116,
              102,
              50,
              57,
              75,
              80,
              88,
              113,
              102,
              108,
              107,
              111,
              68,
              73,
              53,
              109,
              121,
              114,
              48,
              66,
              71,
              52,
              107,
              71,
              37,
              50,
              66,
              78,
              73,
              80,
              82,
              102,
              115,
              119,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1361,
          "responseSize": 255
        },
        "id": "0455914c-74ca-4916-b875-d8928809ad72",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "취소 후 잔액(BALANCE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 원 거래 키(O_TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생시간(TRANTIME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생일자(TRANDATE)",
            "skipped": false
          },
          {
            "assertion": "승인 취소 금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "e483f775-9112-4985-9b5c-e05f595c3e40",
          "length": 21,
          "cycles": 1,
          "position": 7,
          "iteration": 0,
          "httpRequestId": "5536a4ea-b522-4e09-97cc-6eb435276b3d"
        },
        "item": {
          "id": "f2168abe-694f-480f-8b31-6ed06eeacc4c",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "52b510e7-5e4e-457e-ba77-119c477b4396",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC2507311547242F2CD0'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "de1e9626-f1bb-42b5-afdc-80d10a529443"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "88949645-5627-42ca-a2af-8f86fbfba9c4",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0100\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"451842******5446\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"신한카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BD%C5%C7%D1%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "eaf85718-b03a-45d5-93ba-b8d7446cc1f2"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "wcpoTy27mkzR%2FoCmuhu%2BEL1VevUN6wQgs96fAg0NJdKChw9Ccm7hXXJcj%2FUGj%2Bb8z5dq8TvydwIj3RXPjUXi4KzQHH0ZG0DZA03Udge2eI0IsrkEsoTSxKLbYyq5iCvbykTt6GhW9hCDbp8fHC1zGJEYvBJNsjEqz2X9zw2JzcfXTTxRRh%2BjuC1%2BxTb3aJM2weIs3zf7UG56%2FZflpkMYeg%3D%3D"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "a90d1720-301e-40da-85e3-985e4cffe85f",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z6v5huk1n1ev29",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "08a2bd69-45e0-47f7-bd9d-e99c9bed8a4c",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "435"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 15:00:10 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              85,
              79,
              114,
              84,
              50,
              122,
              98,
              84,
              116,
              90,
              116,
              65,
              104,
              54,
              52,
              50,
              115,
              86,
              101,
              74,
              54,
              83,
              70,
              68,
              83,
              99,
              115,
              89,
              118,
              103,
              52,
              89,
              99,
              121,
              83,
              76,
              37,
              50,
              66,
              53,
              78,
              76,
              86,
              78,
              116,
              103,
              97,
              106,
              73,
              108,
              119,
              105,
              83,
              103,
              73,
              89,
              99,
              82,
              80,
              37,
              50,
              66,
              90,
              51,
              53,
              81,
              53,
              57,
              48,
              84,
              55,
              82,
              88,
              122,
              109,
              69,
              81,
              50,
              66,
              52,
              106,
              103,
              121,
              98,
              105,
              115,
              103,
              83,
              122,
              70,
              111,
              106,
              120,
              77,
              102,
              120,
              101,
              90,
              112,
              37,
              50,
              66,
              76,
              100,
              54,
              70,
              80,
              102,
              51,
              72,
              66,
              108,
              101,
              51,
              37,
              50,
              70,
              84,
              116,
              57,
              83,
              50,
              75,
              122,
              37,
              50,
              66,
              72,
              48,
              97,
              101,
              112,
              116,
              106,
              50,
              83,
              78,
              110,
              108,
              82,
              72,
              110,
              110,
              51,
              55,
              75,
              69,
              82,
              48,
              78,
              70,
              82,
              118,
              52,
              109,
              117,
              66,
              48,
              97,
              50,
              103,
              51,
              55,
              103,
              57,
              112,
              55,
              114,
              113,
              51,
              53,
              117,
              51,
              122,
              72,
              79,
              73,
              109,
              90,
              52,
              80,
              68,
              86,
              72,
              107,
              98,
              102,
              107,
              110,
              37,
              50,
              66,
              101,
              114,
              89,
              48,
              121,
              83,
              50,
              66,
              50,
              68,
              97,
              90,
              110,
              87,
              66,
              120,
              75,
              78,
              67,
              68,
              71,
              100,
              85,
              119,
              78,
              83,
              85,
              113,
              81,
              66,
              121,
              118,
              109,
              75,
              48,
              48,
              71,
              50,
              75,
              119,
              78,
              75,
              109,
              79,
              57,
              78,
              111,
              113,
              37,
              50,
              66,
              71,
              74,
              82,
              80,
              113,
              73,
              86,
              66,
              104,
              49,
              48,
              105,
              51,
              114,
              117,
              66,
              78,
              49,
              120,
              67,
              49,
              76,
              111,
              78,
              100,
              104,
              107,
              37,
              50,
              66,
              49,
              66,
              56,
              66,
              99,
              99,
              97,
              106,
              84,
              77,
              112,
              86,
              90,
              67,
              68,
              86,
              110,
              97,
              76,
              48,
              51,
              67,
              79,
              78,
              79,
              68,
              76,
              110,
              102,
              67,
              119,
              56,
              79,
              88,
              54,
              98,
              80,
              78,
              97,
              65,
              112,
              69,
              65,
              111,
              101,
              53,
              109,
              100,
              54,
              71,
              87,
              117,
              78,
              99,
              66,
              68,
              88,
              101,
              112,
              105,
              57,
              111,
              122,
              69,
              78,
              116,
              48,
              78,
              49,
              70,
              83,
              86,
              52,
              84,
              50,
              72,
              79,
              49,
              81,
              84,
              108,
              55,
              106,
              54,
              109,
              56,
              56,
              104,
              81,
              118,
              56,
              74,
              100,
              103,
              53,
              74,
              71,
              78,
              81,
              80,
              77,
              86,
              79,
              97,
              112,
              109,
              119,
              37,
              51,
              68,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1512,
          "responseSize": 435
        },
        "id": "f2168abe-694f-480f-8b31-6ed06eeacc4c",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 코드(CARDCODE 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 전화번호(USERPHONE) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "할부 개월 수(QUOTA) 정상출력",
            "skipped": false
          },
          {
            "assertion": "매출 발생시간(TRANTIME) ±5초 이내 검증",
            "skipped": false
          },
          {
            "assertion": "매출 발생일자(TRANDATE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "상품명(ITEMNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "가맹점 주문번호(ORDERID) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "카드번호(CARDNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "거래 승인 번호(CARDAUTHNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 명(CARDNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 이름(USERNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 ID(USERID) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "d3fa8887-eb1f-4ec4-a39e-0aa3bb3ee299",
          "length": 21,
          "cycles": 1,
          "position": 8,
          "iteration": 0,
          "httpRequestId": "33d5aace-4f74-4ad3-9bff-9314e786605f"
        },
        "item": {
          "id": "3180e6ff-42bf-436b-9e8d-f3ab3ed4ab3c",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "9906f7ab-4f1e-4df8-bdbc-4b75b9c95379",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "105bbc42-1ba4-4e63-b926-717c899609b3"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "7a7f4854-3c5d-4089-9928-a9c5f3ec5d8d",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "5087b0e0-91a6-4eb0-90d1-0c4d4703173e"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "8kvDIwvdID7NWcBMND4uDcYde%2BS5rRI0%2Fdigker%2FA3pITMrFDlg%2BK%2BMLwYVpGIfH%2B2yctFYzZzbz7u6%2F5rYYZ%2Bj9BX5PKInvitElOxE19qEI5tIgPxDgQosBkHaXQKUi"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "c54de7d6-7738-46cd-8ec5-fe987b4166cf",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z6v5huk1n1ev29",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "31267530-e57c-4d56-9bf4-71b3537de11e",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "259"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 15:00:13 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              86,
              122,
              104,
              72,
              85,
              53,
              115,
              100,
              101,
              115,
              52,
              48,
              103,
              114,
              118,
              75,
              109,
              122,
              105,
              37,
              50,
              66,
              114,
              88,
              112,
              69,
              99,
              109,
              104,
              55,
              106,
              76,
              56,
              116,
              118,
              81,
              56,
              121,
              77,
              75,
              108,
              105,
              102,
              109,
              112,
              120,
              97,
              102,
              116,
              88,
              51,
              105,
              54,
              73,
              100,
              51,
              106,
              89,
              121,
              119,
              69,
              99,
              105,
              83,
              51,
              106,
              117,
              77,
              66,
              74,
              49,
              104,
              74,
              69,
              122,
              100,
              73,
              49,
              114,
              78,
              114,
              86,
              105,
              55,
              78,
              104,
              70,
              76,
              73,
              53,
              109,
              87,
              53,
              78,
              50,
              76,
              52,
              73,
              98,
              120,
              54,
              119,
              118,
              116,
              82,
              120,
              99,
              54,
              109,
              111,
              55,
              73,
              52,
              98,
              77,
              110,
              57,
              110,
              89,
              101,
              105,
              73,
              114,
              122,
              99,
              122,
              100,
              84,
              49,
              84,
              100,
              111,
              80,
              122,
              76,
              78,
              86,
              111,
              57,
              82,
              54,
              89,
              53,
              67,
              108,
              88,
              82,
              37,
              50,
              66,
              76,
              83,
              73,
              73,
              72,
              81,
              54,
              37,
              50,
              66,
              83,
              98,
              111,
              73,
              120,
              97,
              101,
              55,
              73,
              52,
              85,
              99,
              117,
              71,
              37,
              50,
              70,
              57,
              48,
              53,
              73,
              78,
              89,
              37,
              50,
              70,
              108,
              50,
              78,
              85,
              51,
              73,
              84,
              79,
              108,
              113,
              66,
              37,
              50,
              70,
              37,
              50,
              70,
              115,
              107,
              109,
              115,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1418,
          "responseSize": 259
        },
        "id": "3180e6ff-42bf-436b-9e8d-f3ab3ed4ab3c",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "취소 후 잔액(BALANCE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 원 거래 키(O_TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생시간(TRANTIME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생일자(TRANDATE)",
            "skipped": false
          },
          {
            "assertion": "승인 취소 금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "2ded9df0-b536-4b56-ad1c-dc6a32412fe3",
          "length": 21,
          "cycles": 1,
          "position": 9,
          "iteration": 0,
          "httpRequestId": "0ced4138-c9e9-465b-8c30-f1603408fa29"
        },
        "item": {
          "id": "8cc65430-454f-40a7-85c5-7aec936d2010",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "9f4bc402-ea9a-4c19-93b1-704e943f6b01",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC2512151528144A426D'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "d2c4d979-c0c8-4e6d-85ce-38a1ac412741"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "3ac979bd-d575-4f72-bfa8-a828c8ecf41b",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0800\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"542586******3820\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "// \"NH농협카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"NH%B3%F3%C7%F9%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "157e87b0-1308-41ec-bc1e-bb32f319a895"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "wcpoTy27mkzR%2FoCmuhu%2BEL1VevUN6wQgs96fAg0NJdKChw9Ccm7hXXJcj%2FUGj%2Bb8z5dq8TvydwIj3RXPjUXi4KzQHH0ZG0DZA03Udge2eI0IsrkEsoTSxKLbYyq5iCvbykTt6GhW9hCDbp8fHC1zGJEYvBJNsjEqz2X9zw2JzcfqMk1YAIjfTKOzEfoXN7bENBxmDICbQksXQP2fAKPCnw%3D%3D"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "74835a89-f831-477c-9c8b-1d9ea752efac",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z6v5huk1n1ev29",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "d2618ea5-948b-4174-951c-8aee380243b1",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "451"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 15:00:14 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              85,
              79,
              114,
              84,
              50,
              122,
              98,
              84,
              116,
              90,
              116,
              65,
              104,
              54,
              52,
              50,
              115,
              86,
              101,
              74,
              54,
              83,
              99,
              76,
              50,
              56,
              105,
              65,
              113,
              66,
              53,
              66,
              111,
              70,
              106,
              117,
              107,
              121,
              103,
              65,
              54,
              55,
              109,
              85,
              67,
              50,
              70,
              48,
              53,
              68,
              66,
              80,
              70,
              70,
              68,
              122,
              82,
              81,
              118,
              69,
              37,
              50,
              70,
              84,
              113,
              106,
              37,
              50,
              70,
              65,
              121,
              48,
              56,
              111,
              84,
              50,
              37,
              50,
              66,
              116,
              104,
              103,
              99,
              69,
              103,
              106,
              67,
              112,
              88,
              50,
              71,
              117,
              55,
              73,
              111,
              114,
              56,
              86,
              102,
              103,
              83,
              37,
              50,
              66,
              78,
              117,
              65,
              53,
              90,
              110,
              67,
              85,
              84,
              121,
              117,
              82,
              113,
              100,
              80,
              57,
              121,
              48,
              78,
              117,
              85,
              37,
              50,
              70,
              108,
              79,
              51,
              99,
              37,
              50,
              70,
              37,
              50,
              70,
              85,
              117,
              53,
              37,
              50,
              70,
              116,
              78,
              75,
              52,
              116,
              112,
              87,
              71,
              53,
              50,
              75,
              102,
              111,
              99,
              120,
              101,
              119,
              110,
              53,
              88,
              117,
              65,
              81,
              37,
              50,
              70,
              118,
              67,
              89,
              103,
              67,
              109,
              115,
              79,
              116,
              105,
              86,
              51,
              118,
              121,
              118,
              37,
              50,
              70,
              80,
              102,
              69,
              102,
              48,
              100,
              37,
              50,
              66,
              113,
              56,
              54,
              120,
              118,
              106,
              83,
              121,
              102,
              85,
              90,
              56,
              98,
              77,
              78,
              71,
              77,
              88,
              85,
              67,
              52,
              70,
              85,
              55,
              48,
              52,
              116,
              37,
              50,
              70,
              107,
              110,
              121,
              100,
              106,
              57,
              107,
              101,
              68,
              69,
              98,
              72,
              122,
              102,
              49,
              102,
              101,
              118,
              78,
              84,
              99,
              114,
              119,
              82,
              71,
              37,
              50,
              66,
              106,
              101,
              78,
              99,
              121,
              68,
              115,
              66,
              79,
              121,
              85,
              97,
              73,
              110,
              48,
              120,
              37,
              50,
              66,
              89,
              73,
              77,
              37,
              50,
              66,
              37,
              50,
              70,
              101,
              54,
              65,
              84,
              72,
              69,
              54,
              100,
              100,
              87,
              73,
              53,
              77,
              50,
              69,
              90,
              76,
              49,
              105,
              65,
              110,
              101,
              48,
              54,
              79,
              112,
              51,
              104,
              115,
              54,
              90,
              68,
              99,
              102,
              114,
              90,
              53,
              66,
              65,
              67,
              89,
              99,
              69,
              104,
              105,
              52,
              97,
              110,
              115,
              56,
              51,
              67,
              102,
              99,
              79,
              83,
              48,
              70,
              49,
              112,
              55,
              107,
              74,
              103,
              119,
              86,
              118,
              120,
              103,
              101,
              105,
              112,
              48,
              106,
              77,
              117,
              112,
              116,
              100,
              77,
              97,
              110,
              83,
              88,
              121,
              51,
              117,
              80,
              104,
              55,
              79,
              97,
              101,
              100,
              90,
              70,
              122,
              88,
              49,
              82,
              79,
              81,
              100,
              113,
              51,
              87,
              107,
              84,
              73,
              66,
              87,
              73,
              103,
              37,
              51,
              68,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1605,
          "responseSize": 451
        },
        "id": "8cc65430-454f-40a7-85c5-7aec936d2010",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 코드(CARDCODE 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 전화번호(USERPHONE) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "할부 개월 수(QUOTA) 정상출력",
            "skipped": false
          },
          {
            "assertion": "매출 발생시간(TRANTIME) ±5초 이내 검증",
            "skipped": false
          },
          {
            "assertion": "매출 발생일자(TRANDATE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "상품명(ITEMNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "가맹점 주문번호(ORDERID) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "카드번호(CARDNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "거래 승인 번호(CARDAUTHNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 명(CARDNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 이름(USERNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 ID(USERID) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "ab29db97-1a8c-4c5d-b04f-274cbada2a9d",
          "length": 21,
          "cycles": 1,
          "position": 10,
          "iteration": 0,
          "httpRequestId": "92f1fa90-870a-4dda-8ad7-4e62707f4990"
        },
        "item": {
          "id": "2bc4d519-b351-4ded-905f-e6d838cc2131",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "ae12336d-f33a-4ed0-a177-131424b03d85",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "65d62309-8cec-4625-b1c0-e4bd12624654"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "f2217647-9dd1-42b6-9630-c311c3bfbb02",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "df8a5283-0e0e-49b7-bc8e-f473f713f2fb"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "8kvDIwvdID7NWcBMND4uDVWJrgsBuRipydeyTKnu5bdwqBp%2BHJJzZmiGhX1jKh%2FIg9DFCd4rDJF9MNksyeADrBUzr7pyNhDBpSJAkffVJan%2B9B%2F62i2QRNKsqW1aOvCZ"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "30edbbeb-066a-48bc-abfd-7f4260a180fa",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z6v5huk1n1ev29",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "94b08ca1-c983-4daf-bcec-8cf053640988",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "255"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 15:00:16 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              86,
              122,
              104,
              72,
              85,
              53,
              115,
              100,
              101,
              115,
              52,
              48,
              103,
              114,
              118,
              75,
              109,
              122,
              105,
              37,
              50,
              66,
              114,
              88,
              112,
              69,
              99,
              109,
              104,
              55,
              106,
              76,
              56,
              116,
              118,
              81,
              56,
              121,
              77,
              75,
              108,
              105,
              102,
              109,
              112,
              48,
              76,
              97,
              116,
              73,
              51,
              84,
              109,
              117,
              115,
              65,
              114,
              51,
              49,
              48,
              90,
              105,
              57,
              98,
              48,
              65,
              69,
              100,
              113,
              97,
              65,
              81,
              51,
              100,
              72,
              68,
              110,
              74,
              89,
              81,
              90,
              75,
              97,
              114,
              115,
              56,
              117,
              113,
              53,
              111,
              105,
              106,
              73,
              65,
              51,
              53,
              99,
              66,
              80,
              54,
              78,
              65,
              72,
              49,
              120,
              100,
              90,
              37,
              50,
              66,
              87,
              116,
              76,
              77,
              76,
              97,
              74,
              48,
              67,
              102,
              55,
              83,
              115,
              102,
              112,
              116,
              115,
              65,
              70,
              112,
              55,
              73,
              55,
              81,
              104,
              121,
              107,
              110,
              37,
              50,
              66,
              78,
              111,
              121,
              53,
              107,
              98,
              81,
              50,
              73,
              117,
              114,
              120,
              110,
              122,
              49,
              74,
              79,
              86,
              82,
              99,
              54,
              120,
              84,
              70,
              52,
              100,
              53,
              108,
              66,
              79,
              78,
              37,
              50,
              66,
              97,
              89,
              50,
              101,
              68,
              57,
              109,
              55,
              114,
              121,
              70,
              98,
              54,
              111,
              111,
              116,
              111,
              55,
              37,
              50,
              66,
              69,
              66,
              98,
              57,
              113,
              120,
              103,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1631,
          "responseSize": 255
        },
        "id": "2bc4d519-b351-4ded-905f-e6d838cc2131",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "취소 후 잔액(BALANCE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 원 거래 키(O_TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생시간(TRANTIME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생일자(TRANDATE)",
            "skipped": false
          },
          {
            "assertion": "승인 취소 금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "f742f410-a360-415c-8535-de8ebc105c2e",
          "length": 21,
          "cycles": 1,
          "position": 11,
          "iteration": 0,
          "httpRequestId": "323a30d4-0045-4b97-ae99-50c29315b057"
        },
        "item": {
          "id": "ca00f6ea-05ed-4f79-b37e-919d41763284",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "54057ce4-afb2-42ed-be32-2e95b2e2c172",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC250804165745DBD04E'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "f3dd5061-156d-4313-b6e0-0f5aaef63c4d"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "90ed897c-e5d9-4814-994d-ed870cd6a1f9",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0300\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"540926******6041\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"국민카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"KB%B1%B9%B9%CE%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "c69f66e5-fee0-4be5-ab3a-661939699b3e"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "wcpoTy27mkzR%2FoCmuhu%2BEL1VevUN6wQgs96fAg0NJdKChw9Ccm7hXXJcj%2FUGj%2Bb8z5dq8TvydwIj3RXPjUXi4KzQHH0ZG0DZA03Udge2eI0IsrkEsoTSxKLbYyq5iCvbykTt6GhW9hCDbp8fHC1zGJEYvBJNsjEqz2X9zw2JzccTXfPyWymzriWFq4iqdmp99Wj2bHxTvGvcdoWGjKzABQ%3D%3D"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "35961eef-8d39-44dc-a8fe-112615c451f8",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z6v5huk1n1ev29",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "fc41e5d9-ef54-4dab-ac40-cdba9877daf3",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "439"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 15:00:17 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              85,
              79,
              114,
              84,
              50,
              122,
              98,
              84,
              116,
              90,
              116,
              65,
              104,
              54,
              52,
              50,
              115,
              86,
              101,
              74,
              54,
              83,
              109,
              37,
              50,
              66,
              54,
              71,
              66,
              89,
              57,
              107,
              74,
              81,
              114,
              116,
              99,
              83,
              88,
              121,
              89,
              70,
              120,
              69,
              57,
              101,
              122,
              67,
              73,
              71,
              78,
              109,
              49,
              55,
              108,
              119,
              119,
              48,
              48,
              122,
              78,
              50,
              77,
              79,
              110,
              112,
              53,
              90,
              77,
              98,
              86,
              37,
              50,
              70,
              112,
              102,
              102,
              72,
              52,
              75,
              86,
              54,
              67,
              48,
              87,
              120,
              76,
              117,
              108,
              71,
              49,
              52,
              122,
              103,
              50,
              65,
              109,
              75,
              88,
              117,
              99,
              71,
              79,
              37,
              50,
              66,
              88,
              77,
              81,
              120,
              105,
              114,
              72,
              114,
              78,
              104,
              82,
              111,
              80,
              106,
              121,
              90,
              118,
              57,
              88,
              101,
              68,
              75,
              37,
              50,
              70,
              106,
              98,
              87,
              66,
              112,
              85,
              98,
              112,
              67,
              107,
              66,
              112,
              115,
              86,
              72,
              89,
              55,
              49,
              52,
              57,
              85,
              76,
              73,
              113,
              122,
              100,
              121,
              68,
              56,
              68,
              113,
              65,
              65,
              99,
              86,
              103,
              76,
              122,
              117,
              98,
              116,
              51,
              51,
              56,
              54,
              101,
              97,
              83,
              109,
              52,
              116,
              84,
              109,
              109,
              105,
              73,
              56,
              71,
              106,
              97,
              109,
              69,
              103,
              57,
              50,
              67,
              85,
              109,
              115,
              109,
              117,
              84,
              76,
              74,
              102,
              74,
              97,
              108,
              77,
              86,
              117,
              49,
              99,
              89,
              101,
              86,
              53,
              79,
              83,
              117,
              108,
              109,
              55,
              119,
              117,
              80,
              99,
              74,
              88,
              52,
              89,
              106,
              97,
              81,
              109,
              117,
              111,
              88,
              86,
              68,
              74,
              117,
              53,
              110,
              111,
              108,
              69,
              100,
              80,
              85,
              76,
              52,
              56,
              70,
              98,
              79,
              51,
              81,
              100,
              116,
              68,
              104,
              118,
              101,
              56,
              111,
              101,
              112,
              68,
              114,
              90,
              98,
              72,
              118,
              84,
              104,
              37,
              50,
              70,
              98,
              118,
              77,
              84,
              122,
              106,
              113,
              84,
              97,
              119,
              119,
              105,
              68,
              120,
              103,
              75,
              86,
              102,
              108,
              84,
              121,
              77,
              66,
              79,
              51,
              73,
              111,
              90,
              110,
              121,
              37,
              50,
              70,
              102,
              111,
              57,
              67,
              85,
              119,
              69,
              112,
              66,
              106,
              79,
              116,
              115,
              65,
              37,
              50,
              66,
              70,
              37,
              50,
              70,
              53,
              37,
              50,
              66,
              98,
              67,
              74,
              74,
              101,
              52,
              52,
              108,
              51,
              56,
              54,
              121,
              69,
              79,
              49,
              54,
              71,
              51,
              112,
              83,
              120,
              71,
              103,
              37,
              50,
              66,
              55,
              75,
              102,
              118,
              75,
              51,
              87,
              79,
              67,
              87,
              82,
              114,
              99,
              119,
              108,
              89,
              76,
              110,
              76,
              81,
              37,
              51,
              68,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1293,
          "responseSize": 439
        },
        "id": "ca00f6ea-05ed-4f79-b37e-919d41763284",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 코드(CARDCODE 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 전화번호(USERPHONE) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "할부 개월 수(QUOTA) 정상출력",
            "skipped": false
          },
          {
            "assertion": "매출 발생시간(TRANTIME) ±5초 이내 검증",
            "skipped": false
          },
          {
            "assertion": "매출 발생일자(TRANDATE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "상품명(ITEMNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "보증금 금액(DEPOSIT_AMT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "가맹점 주문번호(ORDERID) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "카드번호(CARDNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "거래 승인 번호(CARDAUTHNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 명(CARDNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 이름(USERNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 ID(USERID) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "2f27a478-bd1a-40f2-9094-633ddb43cb45",
          "length": 21,
          "cycles": 1,
          "position": 12,
          "iteration": 0,
          "httpRequestId": "dee38d63-5149-4675-b6aa-42ff6294071b"
        },
        "item": {
          "id": "17f74e5c-d456-4ee6-acfb-420ea127d045",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "b156ae6a-9f26-4c39-93cf-d9c8bf80f4c0",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "462e11a8-6405-4eb1-bf08-de888c11fc6c"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "ab367332-1537-42dd-872b-ca8059ee0a01",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "92d9bf0f-f951-48ed-a2ab-60bf9714c75c"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "8kvDIwvdID7NWcBMND4uDec02pzbW9UPsGGUxv42pFO7FCqLAZVpO4ttjo1B3QqntJglNxz7aOfjOtl%2B04IVuRyFwQeMBd8EmQQ7SaVL2MkSL0iKw9JSVTpAJXLCB1KB"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "be7b4678-ce12-4428-a4f8-1904bfcc5bc1",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z6v5huk1n1ev29",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "25a6b474-3266-4b90-a2a2-a05c1323d074",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "257"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 15:00:19 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              86,
              122,
              104,
              72,
              85,
              53,
              115,
              100,
              101,
              115,
              52,
              48,
              103,
              114,
              118,
              75,
              109,
              122,
              105,
              37,
              50,
              66,
              114,
              88,
              112,
              69,
              99,
              109,
              104,
              55,
              106,
              76,
              56,
              116,
              118,
              81,
              56,
              121,
              77,
              75,
              108,
              105,
              102,
              109,
              112,
              120,
              80,
              55,
              109,
              85,
              79,
              37,
              50,
              70,
              99,
              75,
              104,
              74,
              87,
              90,
              57,
              66,
              67,
              105,
              119,
              52,
              90,
              108,
              50,
              98,
              52,
              107,
              70,
              117,
              115,
              71,
              118,
              112,
              57,
              37,
              50,
              70,
              87,
              117,
              120,
              54,
              89,
              50,
              108,
              105,
              121,
              111,
              76,
              121,
              99,
              85,
              82,
              118,
              97,
              73,
              85,
              74,
              108,
              69,
              89,
              86,
              75,
              100,
              98,
              102,
              107,
              52,
              88,
              56,
              110,
              97,
              71,
              67,
              66,
              122,
              77,
              120,
              50,
              52,
              112,
              79,
              55,
              76,
              73,
              66,
              79,
              57,
              119,
              119,
              100,
              80,
              57,
              88,
              76,
              66,
              88,
              49,
              78,
              66,
              88,
              54,
              73,
              37,
              50,
              70,
              68,
              87,
              115,
              105,
              84,
              84,
              55,
              99,
              89,
              69,
              75,
              56,
              37,
              50,
              66,
              106,
              97,
              81,
              116,
              114,
              110,
              85,
              118,
              112,
              89,
              74,
              51,
              69,
              71,
              107,
              103,
              37,
              50,
              70,
              110,
              107,
              108,
              90,
              54,
              108,
              122,
              109,
              121,
              101,
              116,
              114,
              56,
              101,
              98,
              71,
              49,
              72,
              103,
              108,
              69,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1321,
          "responseSize": 257
        },
        "id": "17f74e5c-d456-4ee6-acfb-420ea127d045",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "취소 후 잔액(BALANCE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 원 거래 키(O_TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생시간(TRANTIME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생일자(TRANDATE)",
            "skipped": false
          },
          {
            "assertion": "승인 취소 금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "38c309ac-3584-41c9-a6ee-fb246bdaae7d",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "697eba32-c6e4-4f61-aaf8-ba165ccca513"
        },
        "item": {
          "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "3307c1c8-6296-4f04-883e-62107464c402",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "wcpoTy27mkzR%2FoCmuhu%2BEL1VevUN6wQgs96fAg0NJdKChw9Ccm7hXXJcj%2FUGj%2Bb8z5dq8TvydwIj3RXPjUXi4KzQHH0ZG0DZA03Udge2eI0IsrkEsoTSxKLbYyq5iCvbykTt6GhW9hCDbp8fHC1zGJEYvBJNsjEqz2X9zw2JzccVRR%2FtepSx6ESumfhyCleVEPVKGpunFtzDUwUlJoNVsg%3D%3D"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "2dcca34c-3045-4b49-8e64-2538b95b2fb5",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z6v5huk1n1ev29",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "14a50505-3e5a-467c-aafd-d4c933a2f3e2",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "195"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 15:00:21 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              52,
              77,
              116,
              51,
              119,
              72,
              70,
              67,
              81,
              114,
              78,
              79,
              107,
              48,
              97,
              87,
              70,
              37,
              50,
              66,
              54,
              103,
              48,
              108,
              76,
              80,
              52,
              72,
              104,
              84,
              87,
              113,
              53,
              79,
              99,
              115,
              101,
              113,
              75,
              107,
              112,
              108,
              111,
              100,
              102,
              69,
              112,
              56,
              108,
              65,
              50,
              100,
              72,
              114,
              70,
              113,
              82,
              84,
              102,
              82,
              50,
              57,
              103,
              86,
              101,
              66,
              67,
              37,
              50,
              70,
              72,
              70,
              54,
              55,
              55,
              83,
              52,
              67,
              111,
              57,
              66,
              66,
              51,
              108,
              71,
              37,
              50,
              70,
              98,
              54,
              107,
              120,
              115,
              48,
              79,
              66,
              54,
              37,
              50,
              66,
              109,
              50,
              82,
              108,
              115,
              90,
              87,
              55,
              87,
              100,
              114,
              83,
              68,
              122,
              71,
              78,
              117,
              121,
              85,
              120,
              111,
              57,
              37,
              50,
              66,
              68,
              48,
              116,
              57,
              67,
              107,
              37,
              50,
              70,
              74,
              85,
              100,
              100,
              87,
              83,
              70,
              53,
              73,
              37,
              50,
              70,
              65,
              79,
              53,
              107,
              121,
              121,
              68,
              100,
              37,
              50,
              70,
              80,
              72,
              82,
              81,
              101,
              73,
              50,
              79,
              107,
              103,
              120,
              70,
              83,
              114,
              114,
              80,
              80,
              100,
              83,
              101,
              101,
              56,
              55,
              74,
              102,
              73,
              101,
              76,
              118,
              69,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1499,
          "responseSize": 195
        },
        "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "결과코드(RETURNCODE) 정상출력",
              "message": "expected '3143' to deeply equal '0000'",
              "stack": "AssertionError: expected '3143' to deeply equal '0000'\n   at Object.eval sandbox-script.js:1:14)"
            }
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 1,
              "test": "결과메세지(RETURNMSG) 정상출력",
              "message": "expected '%C4%AB%B5%E5%BB%E7+%B9%AE%C0%C7+%B9%D…' to deeply equal '%BC%BA%B0%F8'",
              "stack": "AssertionError: expected '%C4%AB%B5%E5%BB%E7+%B9%AE%C0%C7+%B9%D…' to deeply equal '%BC%BA%B0%F8'\n   at Object.eval sandbox-script.js:2:14)"
            }
          },
          {
            "assertion": "카드사 코드(CARDCODE 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 2,
              "test": "카드사 코드(CARDCODE 정상출력",
              "message": "expected undefined to deeply equal '0202'",
              "stack": "AssertionError: expected undefined to deeply equal '0202'\n   at Object.eval sandbox-script.js:3:14)"
            }
          },
          {
            "assertion": "구매자 전화번호(USERPHONE) 빈값 확인",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 3,
              "test": "구매자 전화번호(USERPHONE) 빈값 확인",
              "message": ".empty was passed non-string primitive undefined",
              "stack": "AssertionError: .empty was passed non-string primitive undefined\n   at Object.eval sandbox-script.js:4:14)"
            }
          },
          {
            "assertion": "할부 개월 수(QUOTA) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 4,
              "test": "할부 개월 수(QUOTA) 정상출력",
              "message": "expected undefined to deeply equal '00'",
              "stack": "AssertionError: expected undefined to deeply equal '00'\n   at Object.eval sandbox-script.js:5:14)"
            }
          },
          {
            "assertion": "매출 발생시간(TRANTIME) ±5초 이내 검증",
            "skipped": false,
            "error": {
              "name": "TypeError",
              "index": 5,
              "test": "매출 발생시간(TRANTIME) ±5초 이내 검증",
              "message": "Cannot read properties of undefined (reading 'slice')",
              "stack": "TypeError: Cannot read properties of undefined (reading 'slice')\n   at Object.eval sandbox-script.js:6:14)"
            }
          },
          {
            "assertion": "매출 발생일자(TRANDATE) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 6,
              "test": "매출 발생일자(TRANDATE) 정상출력",
              "message": "expected undefined to deeply equal '20260107'",
              "stack": "AssertionError: expected undefined to deeply equal '20260107'\n   at Object.eval sandbox-script.js:7:14)"
            }
          },
          {
            "assertion": "승인금액(AMOUNT) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 7,
              "test": "승인금액(AMOUNT) 정상출력",
              "message": "expected undefined to deeply equal '301'",
              "stack": "AssertionError: expected undefined to deeply equal '301'\n   at Object.eval sandbox-script.js:8:14)"
            }
          },
          {
            "assertion": "상품명(ITEMNAME) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 8,
              "test": "상품명(ITEMNAME) 정상출력",
              "message": "expected undefined to deeply equal 'apiautotest'",
              "stack": "AssertionError: expected undefined to deeply equal 'apiautotest'\n   at Object.eval sandbox-script.js:9:14)"
            }
          },
          {
            "assertion": "보증금 금액(DEPOSIT_AMT) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 9,
              "test": "보증금 금액(DEPOSIT_AMT) 정상출력",
              "message": "expected undefined to deeply equal '0'",
              "stack": "AssertionError: expected undefined to deeply equal '0'\n   at Object.eval sandbox-script.js:10:14)"
            }
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "가맹점 주문번호(ORDERID) 빈값 확인",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 11,
              "test": "가맹점 주문번호(ORDERID) 빈값 확인",
              "message": ".empty was passed non-string primitive undefined",
              "stack": "AssertionError: .empty was passed non-string primitive undefined\n   at Object.eval sandbox-script.js:12:14)"
            }
          },
          {
            "assertion": "카드번호(CARDNO) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 12,
              "test": "카드번호(CARDNO) 정상출력",
              "message": "expected undefined to deeply equal '538920******1226'",
              "stack": "AssertionError: expected undefined to deeply equal '538920******1226'\n   at Object.eval sandbox-script.js:13:14)"
            }
          },
          {
            "assertion": "거래 승인 번호(CARDAUTHNO) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 13,
              "test": "거래 승인 번호(CARDAUTHNO) 정상출력",
              "message": "expected undefined to exist",
              "stack": "AssertionError: expected undefined to exist\n   at Object.eval sandbox-script.js:14:14)"
            }
          },
          {
            "assertion": "카드사 명(CARDNAME) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 14,
              "test": "카드사 명(CARDNAME) 정상출력",
              "message": "expected undefined to deeply equal '%BF%EC%B8%AEBC%C4%AB%B5%E5'",
              "stack": "AssertionError: expected undefined to deeply equal '%BF%EC%B8%AEBC%C4%AB%B5%E5'\n   at Object.eval sandbox-script.js:15:14)"
            }
          },
          {
            "assertion": "구매자 이름(USERNAME) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 15,
              "test": "구매자 이름(USERNAME) 정상출력",
              "message": ".empty was passed non-string primitive undefined",
              "stack": "AssertionError: .empty was passed non-string primitive undefined\n   at Object.eval sandbox-script.js:16:14)"
            }
          },
          {
            "assertion": "구매자 ID(USERID) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 16,
              "test": "구매자 ID(USERID) 정상출력",
              "message": "expected undefined to deeply equal 'hnkim'",
              "stack": "AssertionError: expected undefined to deeply equal 'hnkim'\n   at Object.eval sandbox-script.js:17:14)"
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "6f4f0024-6883-45b7-b35d-3ccc1f9f415a",
          "length": 21,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "e9811c6d-e498-4da4-8f2d-e4994b5fe595"
        },
        "item": {
          "id": "149a4441-c945-45a3-a539-b046aa7e9949",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "8kvDIwvdID7NWcBMND4uDa%2FXVguUu6oEc5D7ndcqd%2BgHZDeycZdoCQSuIW99%2B1gvbDteO0xRMDzIPajRYGxntoKJNb1axJ5eYMWW9s%2BIbAMR2KPWTuVNA8PlHPC6OtQF"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "5bec2804-5f41-4101-8218-f333c8ed383a",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z6v5huk1n1ev29",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "766c892d-0263-4f04-b584-4dbff8deae0d",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "171"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 15:00:21 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              117,
              116,
              54,
              112,
              83,
              71,
              103,
              117,
              114,
              77,
              87,
              72,
              51,
              111,
              50,
              79,
              119,
              103,
              75,
              85,
              116,
              121,
              66,
              108,
              73,
              67,
              74,
              117,
              120,
              67,
              117,
              75,
              109,
              115,
              52,
              55,
              76,
              118,
              79,
              80,
              76,
              51,
              116,
              107,
              73,
              76,
              116,
              76,
              119,
              81,
              100,
              89,
              89,
              77,
              90,
              98,
              70,
              107,
              110,
              67,
              69,
              80,
              119,
              76,
              69,
              68,
              102,
              111,
              37,
              50,
              70,
              78,
              97,
              71,
              37,
              50,
              66,
              116,
              52,
              81,
              114,
              106,
              87,
              99,
              117,
              78,
              110,
              83,
              81,
              48,
              71,
              89,
              71,
              69,
              90,
              117,
              73,
              37,
              50,
              66,
              71,
              69,
              67,
              116,
              116,
              116,
              101,
              89,
              114,
              82,
              65,
              97,
              100,
              110,
              78,
              77,
              97,
              87,
              118,
              100,
              79,
              98,
              112,
              87,
              37,
              50,
              66,
              97,
              52,
              73,
              78,
              118,
              72,
              80,
              83,
              57,
              88,
              102,
              122,
              74,
              102,
              77,
              65,
              119,
              109,
              82,
              72,
              37,
              50,
              70,
              48,
              118,
              51,
              80,
              116,
              85,
              82,
              83,
              105,
              65,
              37,
              51,
              68,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 168,
          "responseSize": 171
        },
        "id": "149a4441-c945-45a3-a539-b046aa7e9949",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 0,
              "test": "결과코드(RETURNCODE) 정상출력",
              "message": "expected '1117' to deeply equal '0000'",
              "stack": "AssertionError: expected '1117' to deeply equal '0000'\n   at Object.eval sandbox-script.js:1:15)"
            }
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 1,
              "test": "결과메세지(RETURNMSG) 정상출력",
              "message": "expected '%BF%F8%B0%C5%B7%A1%B0%C7%C0%CC+%C1%B8…' to deeply equal '%BC%BA%B0%F8'",
              "stack": "AssertionError: expected '%BF%F8%B0%C5%B7%A1%B0%C7%C0%CC+%C1%B8…' to deeply equal '%BC%BA%B0%F8'\n   at Object.eval sandbox-script.js:2:15)"
            }
          },
          {
            "assertion": "취소 후 잔액(BALANCE) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 2,
              "test": "취소 후 잔액(BALANCE) 정상출력",
              "message": "expected undefined to deeply equal '0'",
              "stack": "AssertionError: expected undefined to deeply equal '0'\n   at Object.eval sandbox-script.js:3:15)"
            }
          },
          {
            "assertion": "다날 원 거래 키(O_TID) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 3,
              "test": "다날 원 거래 키(O_TID) 정상출력",
              "message": "expected undefined not to be undefined",
              "stack": "AssertionError: expected undefined not to be undefined\n   at Object.eval sandbox-script.js:4:15)"
            }
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 4,
              "test": "다날 거래 키(TID) 정상출력",
              "message": "expected undefined not to be undefined",
              "stack": "AssertionError: expected undefined not to be undefined\n   at Object.eval sandbox-script.js:5:15)"
            }
          },
          {
            "assertion": "승인 발생시간(TRANTIME) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 5,
              "test": "승인 발생시간(TRANTIME) 정상출력",
              "message": "expected undefined to deeply equal null",
              "stack": "AssertionError: expected undefined to deeply equal null\n   at Object.eval sandbox-script.js:6:15)"
            }
          },
          {
            "assertion": "승인 발생일자(TRANDATE)",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 6,
              "test": "승인 발생일자(TRANDATE)",
              "message": "expected undefined to deeply equal '20260107'",
              "stack": "AssertionError: expected undefined to deeply equal '20260107'\n   at Object.eval sandbox-script.js:7:15)"
            }
          },
          {
            "assertion": "승인 취소 금액(AMOUNT) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 7,
              "test": "승인 취소 금액(AMOUNT) 정상출력",
              "message": "expected undefined to deeply equal '301'",
              "stack": "AssertionError: expected undefined to deeply equal '301'\n   at Object.eval sandbox-script.js:8:15)"
            }
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false,
            "error": {
              "name": "AssertionError",
              "index": 8,
              "test": "컵 보증금(DEPOSIT_AMT) 정상출력",
              "message": "expected undefined to deeply equal '0'",
              "stack": "AssertionError: expected undefined to deeply equal '0'\n   at Object.eval sandbox-script.js:9:15)"
            }
          }
        ]
      },
      {
        "cursor": {
          "ref": "48ba6d18-c964-47fc-a6a8-d91636233efd",
          "length": 21,
          "cycles": 1,
          "position": 15,
          "iteration": 0,
          "httpRequestId": "0b87903d-9648-45e7-a9a7-167eec11b605"
        },
        "item": {
          "id": "8553585f-b694-4f34-9a7c-98f209a69bd5",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "bfee9087-f6d2-4fbf-8b89-82877e7ab416",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC251215145003CEDD72'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "633b4355-19bf-414e-862e-0ad00c819e46"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "fc5e99df-b9ee-4abb-be5c-651e8935ad94",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0907\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"624404******8380\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"롯데카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AE%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "cde39164-1c0a-47d2-bae4-f325b7263cdb"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "wcpoTy27mkzR%2FoCmuhu%2BEL1VevUN6wQgs96fAg0NJdKChw9Ccm7hXXJcj%2FUGj%2Bb8z5dq8TvydwIj3RXPjUXi4KzQHH0ZG0DZA03Udge2eI0IsrkEsoTSxKLbYyq5iCvbykTt6GhW9hCDbp8fHC1zGJEYvBJNsjEqz2X9zw2JzcextrJriQhf%2FIUYtULhB8bH62Qdp0SGru%2BMd63vyNOLHA%3D%3D"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "f9706105-7ace-4287-9cb5-9bb653282af3",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z6v5huk1n1ev29",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "cfd1a05a-75d0-43c8-b0be-007761faaba5",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "447"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 15:00:23 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              85,
              79,
              114,
              84,
              50,
              122,
              98,
              84,
              116,
              90,
              116,
              65,
              104,
              54,
              52,
              50,
              115,
              86,
              101,
              74,
              54,
              83,
              67,
              69,
              86,
              56,
              88,
              48,
              116,
              51,
              118,
              77,
              102,
              108,
              57,
              65,
              84,
              99,
              48,
              69,
              103,
              77,
              86,
              103,
              115,
              37,
              50,
              66,
              83,
              101,
              50,
              37,
              50,
              66,
              77,
              83,
              68,
              103,
              54,
              37,
              50,
              70,
              71,
              37,
              50,
              70,
              104,
              97,
              117,
              48,
              73,
              72,
              65,
              82,
              51,
              86,
              67,
              85,
              107,
              69,
              82,
              101,
              37,
              50,
              66,
              74,
              56,
              74,
              57,
              49,
              85,
              103,
              78,
              122,
              105,
              98,
              77,
              50,
              102,
              50,
              101,
              48,
              97,
              53,
              78,
              80,
              70,
              37,
              50,
              66,
              119,
              88,
              80,
              73,
              99,
              69,
              50,
              54,
              109,
              50,
              114,
              52,
              37,
              50,
              66,
              54,
              48,
              51,
              85,
              68,
              74,
              53,
              79,
              103,
              67,
              111,
              37,
              50,
              70,
              77,
              51,
              106,
              103,
              49,
              49,
              51,
              112,
              73,
              70,
              71,
              49,
              57,
              117,
              80,
              37,
              50,
              66,
              99,
              97,
              68,
              110,
              66,
              66,
              100,
              106,
              109,
              74,
              108,
              109,
              86,
              88,
              74,
              83,
              88,
              115,
              56,
              66,
              87,
              68,
              109,
              109,
              109,
              89,
              72,
              48,
              111,
              52,
              102,
              68,
              79,
              102,
              49,
              99,
              89,
              119,
              109,
              79,
              77,
              66,
              37,
              50,
              70,
              108,
              97,
              90,
              80,
              78,
              76,
              76,
              76,
              103,
              87,
              71,
              50,
              111,
              87,
              77,
              70,
              78,
              87,
              98,
              114,
              82,
              50,
              112,
              111,
              69,
              117,
              103,
              88,
              84,
              90,
              83,
              102,
              49,
              104,
              97,
              54,
              54,
              90,
              103,
              116,
              98,
              83,
              120,
              74,
              51,
              121,
              104,
              116,
              102,
              108,
              109,
              89,
              37,
              50,
              66,
              71,
              86,
              104,
              78,
              56,
              67,
              80,
              48,
              71,
              113,
              37,
              50,
              70,
              78,
              55,
              37,
              50,
              66,
              100,
              81,
              100,
              68,
              104,
              82,
              74,
              65,
              109,
              90,
              120,
              86,
              80,
              105,
              87,
              70,
              111,
              67,
              49,
              76,
              37,
              50,
              70,
              65,
              118,
              52,
              77,
              57,
              102,
              51,
              50,
              53,
              112,
              114,
              117,
              117,
              114,
              69,
              104,
              66,
              117,
              121,
              107,
              53,
              67,
              51,
              57,
              101,
              76,
              117,
              71,
              110,
              67,
              107,
              103,
              90,
              69,
              101,
              87,
              53,
              111,
              53,
              71,
              50,
              104,
              115,
              112,
              100,
              113,
              49,
              82,
              54,
              88,
              75,
              81,
              53,
              65,
              103,
              79,
              71,
              118,
              116,
              116,
              66,
              70,
              55,
              49,
              48,
              81,
              72,
              74,
              118,
              86,
              107,
              122,
              106,
              84,
              74,
              120,
              71,
              109,
              104,
              111,
              114,
              51,
              51,
              69,
              79,
              111,
              73,
              50,
              76,
              108,
              54,
              49,
              73,
              103,
              37,
              51,
              68,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1303,
          "responseSize": 447
        },
        "id": "8553585f-b694-4f34-9a7c-98f209a69bd5",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 코드(CARDCODE 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 전화번호(USERPHONE) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "할부 개월 수(QUOTA) 정상출력",
            "skipped": false
          },
          {
            "assertion": "매출 발생시간(TRANTIME) ±5초 이내 검증",
            "skipped": false
          },
          {
            "assertion": "매출 발생일자(TRANDATE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "상품명(ITEMNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "보증금 금액(DEPOSIT_AMT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "가맹점 주문번호(ORDERID) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "카드번호(CARDNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "거래 승인 번호(CARDAUTHNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 명(CARDNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 이름(USERNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 ID(USERID) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "59a5891e-5465-412b-83de-e84514cde1d9",
          "length": 21,
          "cycles": 1,
          "position": 16,
          "iteration": 0,
          "httpRequestId": "e03eb89f-2a71-459a-b46b-6a3e636c85ee"
        },
        "item": {
          "id": "81f5d691-2c4d-4d29-9c6f-1e5bb1ef27b9",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "758b0130-950b-427e-8335-2676db6bc46f",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "fc035d9e-758b-4f8f-869f-0b8a39522fb2"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "da016859-4f4d-45c8-b5ba-3ee2b8b670ce",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "763a2989-4dbb-4dd0-91bd-511fc0ba3f17"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "8kvDIwvdID7NWcBMND4uDZjKbH8TJxVlOSJ45mILrB58V0JihDyDPASpteNWhs6qjr6zvK2CUnEEz2yzRnZwb1ayQivVv1G7dV%2BrZ4yTvdu1WXmCGm8eszD2Px6zwXFS"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "d48b0006-2093-46a6-8a77-ff97cdf23c4f",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z6v5huk1n1ev29",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "16c8a8ac-a37d-46a9-86c1-4d5a2d23b182",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "263"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 15:00:24 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              86,
              122,
              104,
              72,
              85,
              53,
              115,
              100,
              101,
              115,
              52,
              48,
              103,
              114,
              118,
              75,
              109,
              122,
              105,
              37,
              50,
              66,
              114,
              88,
              112,
              69,
              99,
              109,
              104,
              55,
              106,
              76,
              56,
              116,
              118,
              81,
              56,
              121,
              77,
              75,
              108,
              105,
              102,
              109,
              112,
              49,
              57,
              85,
              90,
              82,
              75,
              98,
              101,
              53,
              90,
              83,
              103,
              55,
              103,
              49,
              74,
              90,
              85,
              109,
              88,
              116,
              69,
              106,
              76,
              88,
              54,
              52,
              76,
              98,
              122,
              87,
              78,
              37,
              50,
              70,
              90,
              116,
              83,
              68,
              83,
              98,
              111,
              101,
              79,
              97,
              82,
              37,
              50,
              66,
              75,
              99,
              118,
              78,
              79,
              70,
              101,
              78,
              48,
              88,
              65,
              117,
              122,
              110,
              116,
              78,
              55,
              49,
              50,
              114,
              54,
              83,
              69,
              37,
              50,
              70,
              118,
              88,
              100,
              78,
              78,
              113,
              116,
              117,
              108,
              89,
              106,
              109,
              112,
              101,
              68,
              86,
              50,
              54,
              53,
              118,
              37,
              50,
              70,
              103,
              48,
              53,
              99,
              75,
              97,
              72,
              49,
              70,
              111,
              97,
              66,
              114,
              86,
              109,
              78,
              37,
              50,
              66,
              110,
              108,
              121,
              79,
              122,
              112,
              73,
              109,
              67,
              121,
              77,
              113,
              82,
              55,
              53,
              54,
              106,
              56,
              83,
              37,
              50,
              70,
              78,
              66,
              99,
              52,
              71,
              84,
              88,
              103,
              115,
              103,
              51,
              37,
              50,
              70,
              116,
              122,
              119,
              99,
              111,
              83,
              110,
              76,
              104,
              37,
              50,
              70,
              81,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1314,
          "responseSize": 263
        },
        "id": "81f5d691-2c4d-4d29-9c6f-1e5bb1ef27b9",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "취소 후 잔액(BALANCE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 원 거래 키(O_TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생시간(TRANTIME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생일자(TRANDATE)",
            "skipped": false
          },
          {
            "assertion": "승인 취소 금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "fdbd8e9f-9c47-4675-b192-f29439da3eea",
          "length": 21,
          "cycles": 1,
          "position": 17,
          "iteration": 0,
          "httpRequestId": "2a0d0e5b-1417-42b7-ab30-2bb17e1c035f"
        },
        "item": {
          "id": "88f48784-9bb2-4322-993a-dbaf8afd1a5a",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "516e4913-2a3e-491c-8f57-b25502da3b2f",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25121515231344D775'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "746a31f8-868e-4fd4-bc9a-42bd94a2e2d5"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "cf38c8dd-2a53-437e-8e4b-948543073f8d",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0921\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"485462******0767\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%C4%C9%C0%CC%B9%F0%C5%A9%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "fefcd827-3ff8-4467-81f3-2c2f6089ef54"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "wcpoTy27mkzR%2FoCmuhu%2BEL1VevUN6wQgs96fAg0NJdKChw9Ccm7hXXJcj%2FUGj%2Bb8z5dq8TvydwIj3RXPjUXi4KzQHH0ZG0DZA03Udge2eI0IsrkEsoTSxKLbYyq5iCvbykTt6GhW9hCDbp8fHC1zGJEYvBJNsjEqz2X9zw2JzccQmxP3XnXAnB6A1V7j6yFer%2BQE%2Ba1pl7pMnq93f1iTpw%3D%3D"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "f3086ab2-2f61-4249-9b6a-67462443b697",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z6v5huk1n1ev29",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "33da7942-4b8c-4ae1-b4b8-3947779e6414",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "431"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 15:00:26 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              85,
              79,
              114,
              84,
              50,
              122,
              98,
              84,
              116,
              90,
              116,
              65,
              104,
              54,
              52,
              50,
              115,
              86,
              101,
              74,
              54,
              83,
              105,
              110,
              68,
              107,
              89,
              110,
              57,
              105,
              111,
              74,
              115,
              68,
              56,
              111,
              102,
              101,
              113,
              105,
              120,
              97,
              90,
              104,
              97,
              102,
              103,
              86,
              122,
              82,
              84,
              70,
              80,
              37,
              50,
              70,
              103,
              67,
              67,
              70,
              120,
              86,
              83,
              37,
              50,
              70,
              109,
              71,
              97,
              116,
              85,
              115,
              83,
              76,
              113,
              100,
              77,
              118,
              89,
              52,
              75,
              97,
              110,
              97,
              56,
              105,
              115,
              66,
              114,
              65,
              72,
              56,
              87,
              111,
              80,
              37,
              50,
              70,
              83,
              56,
              113,
              69,
              66,
              121,
              90,
              85,
              76,
              88,
              52,
              72,
              99,
              100,
              66,
              101,
              57,
              90,
              56,
              112,
              114,
              122,
              70,
              100,
              115,
              78,
              50,
              65,
              79,
              100,
              108,
              56,
              70,
              99,
              102,
              102,
              67,
              86,
              113,
              57,
              108,
              76,
              80,
              113,
              115,
              68,
              56,
              51,
              68,
              83,
              55,
              100,
              54,
              70,
              89,
              116,
              37,
              50,
              70,
              49,
              78,
              119,
              73,
              73,
              50,
              100,
              69,
              114,
              54,
              119,
              81,
              103,
              120,
              119,
              111,
              80,
              66,
              89,
              53,
              77,
              65,
              78,
              50,
              72,
              102,
              118,
              56,
              120,
              50,
              100,
              114,
              111,
              103,
              107,
              57,
              52,
              118,
              73,
              116,
              71,
              67,
              83,
              114,
              114,
              68,
              48,
              99,
              78,
              102,
              86,
              79,
              115,
              120,
              55,
              86,
              73,
              52,
              107,
              118,
              88,
              119,
              72,
              99,
              67,
              100,
              77,
              108,
              86,
              120,
              67,
              79,
              55,
              79,
              74,
              67,
              65,
              82,
              87,
              81,
              53,
              88,
              79,
              74,
              110,
              55,
              107,
              106,
              57,
              73,
              50,
              75,
              105,
              53,
              80,
              56,
              71,
              109,
              109,
              72,
              107,
              116,
              102,
              81,
              90,
              97,
              37,
              50,
              70,
              49,
              86,
              69,
              97,
              81,
              108,
              78,
              107,
              78,
              81,
              67,
              89,
              50,
              118,
              82,
              81,
              119,
              49,
              114,
              53,
              101,
              53,
              110,
              107,
              83,
              100,
              100,
              103,
              66,
              79,
              84,
              77,
              84,
              88,
              121,
              70,
              108,
              84,
              55,
              105,
              100,
              52,
              78,
              106,
              121,
              37,
              50,
              66,
              50,
              83,
              114,
              68,
              108,
              84,
              114,
              118,
              89,
              48,
              81,
              73,
              113,
              113,
              68,
              78,
              52,
              102,
              75,
              102,
              102,
              81,
              103,
              74,
              51,
              65,
              89,
              88,
              76,
              121,
              50,
              81,
              118,
              69,
              121,
              119,
              107,
              71,
              112,
              98,
              74,
              84,
              106,
              115,
              89,
              85,
              98,
              49,
              100,
              117,
              102,
              53,
              78,
              110,
              115,
              98,
              57,
              98,
              71,
              77,
              117,
              103,
              37,
              51,
              68,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1705,
          "responseSize": 431
        },
        "id": "88f48784-9bb2-4322-993a-dbaf8afd1a5a",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 코드(CARDCODE 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 전화번호(USERPHONE) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "할부 개월 수(QUOTA) 정상출력",
            "skipped": false
          },
          {
            "assertion": "매출 발생시간(TRANTIME) ±5초 이내 검증",
            "skipped": false
          },
          {
            "assertion": "매출 발생일자(TRANDATE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "상품명(ITEMNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "보증금 금액(DEPOSIT_AMT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "가맹점 주문번호(ORDERID) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "카드번호(CARDNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "거래 승인 번호(CARDAUTHNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 명(CARDNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 이름(USERNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 ID(USERID) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "969fd1ec-1deb-4711-b441-3d63b748f585",
          "length": 21,
          "cycles": 1,
          "position": 18,
          "iteration": 0,
          "httpRequestId": "7c193cb7-7a5c-4547-9168-721aefece75e"
        },
        "item": {
          "id": "4e4fab2e-1a8a-4dd3-89d1-529d8950a57c",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "b1db5a15-59a1-4f17-9afe-4a3e1cfa3a4a",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "1ef14771-5d8e-4f28-8b92-89a0bee05b76"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "8915aafa-49aa-447d-836b-daef4c4e6a90",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "058fdf47-2031-4ef4-9546-3aa435888b1a"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "8kvDIwvdID7NWcBMND4uDcZCL70QM07ujaMZ7SqVJB4FEEsOBxCgv8QRZyEEyktEz%2BObnmyzOzBo%2Ft3XnfFwo64mhjNslyzahW25wASUMn%2B0Hjpe9%2Buwg1tqmkV%2F1pB7"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "c26eaca3-d1a0-4f04-a648-c52b34bcfd34",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z6v5huk1n1ev29",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "68fb8b81-480e-4fd6-9cfc-7f7ed79f1220",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "269"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 15:00:27 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              86,
              122,
              104,
              72,
              85,
              53,
              115,
              100,
              101,
              115,
              52,
              48,
              103,
              114,
              118,
              75,
              109,
              122,
              105,
              37,
              50,
              66,
              114,
              88,
              112,
              69,
              99,
              109,
              104,
              55,
              106,
              76,
              56,
              116,
              118,
              81,
              56,
              121,
              77,
              75,
              108,
              105,
              102,
              109,
              112,
              53,
              74,
              115,
              119,
              118,
              86,
              113,
              55,
              75,
              72,
              83,
              37,
              50,
              66,
              75,
              80,
              113,
              37,
              50,
              70,
              51,
              87,
              68,
              82,
              115,
              55,
              122,
              116,
              73,
              71,
              99,
              109,
              108,
              37,
              50,
              66,
              56,
              105,
              120,
              66,
              119,
              88,
              74,
              54,
              103,
              70,
              77,
              90,
              110,
              78,
              118,
              97,
              75,
              70,
              112,
              37,
              50,
              66,
              50,
              118,
              84,
              83,
              77,
              111,
              77,
              89,
              108,
              76,
              56,
              115,
              83,
              52,
              48,
              54,
              77,
              69,
              50,
              69,
              53,
              98,
              105,
              113,
              77,
              81,
              50,
              75,
              49,
              37,
              50,
              70,
              71,
              53,
              37,
              50,
              70,
              110,
              67,
              76,
              55,
              102,
              122,
              65,
              57,
              84,
              56,
              104,
              103,
              75,
              37,
              50,
              66,
              78,
              90,
              82,
              86,
              37,
              50,
              66,
              100,
              86,
              117,
              90,
              56,
              116,
              70,
              75,
              68,
              53,
              66,
              37,
              50,
              66,
              76,
              104,
              89,
              85,
              52,
              118,
              98,
              121,
              99,
              112,
              70,
              106,
              68,
              101,
              112,
              120,
              112,
              122,
              87,
              88,
              111,
              120,
              86,
              86,
              37,
              50,
              66,
              71,
              107,
              55,
              88,
              86,
              100,
              104,
              79,
              37,
              50,
              66,
              107,
              107,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1389,
          "responseSize": 269
        },
        "id": "4e4fab2e-1a8a-4dd3-89d1-529d8950a57c",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "취소 후 잔액(BALANCE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 원 거래 키(O_TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생시간(TRANTIME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생일자(TRANDATE)",
            "skipped": false
          },
          {
            "assertion": "승인 취소 금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "c23cd58f-3743-48a0-a5ac-37859530fa10",
          "length": 21,
          "cycles": 1,
          "position": 19,
          "iteration": 0,
          "httpRequestId": "2da328e5-ff1d-4f4a-9f87-9455efb51a16"
        },
        "item": {
          "id": "38ae85ac-35a1-4d7b-87c9-3f8ddb4fb1a4",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "7ef25d99-d119-4561-a7dc-d4b3b21ef183",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC2512151453119224E3'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "2698e623-7f2b-4541-a36b-ae0fac938037"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "3825921f-46d4-44f5-ad63-49b97de5591e",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0700\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"513792******3380\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"롯데카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%B7%D4%B5%A5%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "f50a0777-1a52-455b-a282-6d9de197bfa8"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "wcpoTy27mkzR%2FoCmuhu%2BEL1VevUN6wQgs96fAg0NJdKChw9Ccm7hXXJcj%2FUGj%2Bb8z5dq8TvydwIj3RXPjUXi4KzQHH0ZG0DZA03Udge2eI0IsrkEsoTSxKLbYyq5iCvbykTt6GhW9hCDbp8fHC1zGJEYvBJNsjEqz2X9zw2JzcfDPdPuA9czR8Lb0T%2Ba0ODlNEPIdgayTwp7V1JVXixp1g%3D%3D"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "a27a56c3-de97-4907-a531-af7b9de55306",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z6v5huk1n1ev29",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "a2fd0839-5076-41ce-89ee-f5583e9aa614",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "441"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 15:00:28 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              85,
              79,
              114,
              84,
              50,
              122,
              98,
              84,
              116,
              90,
              116,
              65,
              104,
              54,
              52,
              50,
              115,
              86,
              101,
              74,
              54,
              83,
              116,
              115,
              67,
              83,
              76,
              81,
              114,
              72,
              89,
              56,
              55,
              101,
              99,
              98,
              52,
              66,
              83,
              55,
              77,
              57,
              87,
              79,
              55,
              51,
              68,
              55,
              111,
              100,
              37,
              50,
              66,
              74,
              83,
              119,
              107,
              70,
              110,
              106,
              115,
              76,
              82,
              115,
              110,
              73,
              89,
              52,
              52,
              51,
              107,
              90,
              105,
              52,
              85,
              79,
              78,
              74,
              115,
              104,
              104,
              82,
              69,
              66,
              79,
              50,
              76,
              117,
              55,
              66,
              76,
              89,
              100,
              71,
              65,
              114,
              101,
              37,
              50,
              66,
              99,
              37,
              50,
              70,
              65,
              102,
              66,
              98,
              77,
              103,
              71,
              104,
              81,
              37,
              50,
              70,
              52,
              115,
              113,
              67,
              117,
              54,
              73,
              81,
              52,
              102,
              83,
              50,
              97,
              55,
              65,
              68,
              65,
              103,
              112,
              105,
              50,
              97,
              53,
              104,
              57,
              97,
              121,
              122,
              79,
              118,
              100,
              79,
              65,
              99,
              98,
              55,
              72,
              55,
              79,
              67,
              120,
              52,
              117,
              105,
              80,
              106,
              72,
              74,
              120,
              87,
              108,
              84,
              83,
              88,
              89,
              88,
              57,
              107,
              73,
              116,
              120,
              110,
              115,
              97,
              109,
              75,
              106,
              117,
              90,
              101,
              103,
              121,
              77,
              52,
              81,
              72,
              65,
              89,
              65,
              82,
              54,
              102,
              37,
              50,
              70,
              81,
              101,
              99,
              105,
              66,
              49,
              53,
              103,
              37,
              50,
              70,
              100,
              86,
              77,
              103,
              55,
              71,
              118,
              85,
              37,
              50,
              66,
              110,
              88,
              80,
              88,
              73,
              49,
              75,
              50,
              77,
              103,
              107,
              107,
              88,
              78,
              65,
              57,
              113,
              109,
              84,
              113,
              103,
              109,
              68,
              65,
              81,
              69,
              68,
              49,
              49,
              104,
              50,
              73,
              83,
              65,
              82,
              37,
              50,
              70,
              101,
              53,
              37,
              50,
              70,
              106,
              54,
              55,
              86,
              84,
              87,
              117,
              69,
              76,
              76,
              120,
              51,
              71,
              87,
              69,
              103,
              102,
              100,
              74,
              90,
              79,
              80,
              66,
              69,
              57,
              120,
              66,
              79,
              117,
              70,
              78,
              69,
              120,
              48,
              85,
              101,
              74,
              52,
              116,
              115,
              84,
              117,
              50,
              101,
              65,
              89,
              112,
              76,
              113,
              84,
              98,
              98,
              116,
              112,
              97,
              74,
              108,
              87,
              82,
              119,
              109,
              105,
              87,
              75,
              65,
              87,
              73,
              107,
              107,
              99,
              87,
              57,
              55,
              122,
              53,
              109,
              57,
              88,
              66,
              99,
              68,
              73,
              67,
              110,
              101,
              75,
              116,
              116,
              103,
              103,
              104,
              66,
              69,
              89,
              99,
              119,
              107,
              57,
              74,
              80,
              77,
              54,
              37,
              50,
              70,
              115,
              108,
              75,
              122,
              37,
              50,
              70,
              75,
              53,
              122,
              81,
              120,
              87,
              49,
              65,
              37,
              51,
              68,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1278,
          "responseSize": 441
        },
        "id": "38ae85ac-35a1-4d7b-87c9-3f8ddb4fb1a4",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 코드(CARDCODE 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 전화번호(USERPHONE) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "할부 개월 수(QUOTA) 정상출력",
            "skipped": false
          },
          {
            "assertion": "매출 발생시간(TRANTIME) ±5초 이내 검증",
            "skipped": false
          },
          {
            "assertion": "매출 발생일자(TRANDATE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "상품명(ITEMNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "보증금 금액(DEPOSIT_AMT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "가맹점 주문번호(ORDERID) 빈값 확인",
            "skipped": false
          },
          {
            "assertion": "카드번호(CARDNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "거래 승인 번호(CARDAUTHNO) 정상출력",
            "skipped": false
          },
          {
            "assertion": "카드사 명(CARDNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 이름(USERNAME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "구매자 ID(USERID) 정상출력",
            "skipped": false
          }
        ]
      },
      {
        "cursor": {
          "ref": "e8db000a-74a6-4a9e-8524-e128e239e7f7",
          "length": 21,
          "cycles": 1,
          "position": 20,
          "iteration": 0,
          "httpRequestId": "404671ad-3889-449f-83c8-ce29a10a260f"
        },
        "item": {
          "id": "b79d88db-0555-4498-8e15-ae9734d61623",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "dd5bb67c-19e4-4b9b-8956-a2f5679eb2b7",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "2091eee0-6a50-4d4e-b444-645895229c23"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "c848d220-b552-433d-a018-0e0f741c6a51",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "27ae5c1e-c206-42cb-8822-3c5d485bf168"
              }
            }
          ]
        },
        "request": {
          "url": {
            "protocol": "https",
            "path": [
              "credit",
              ""
            ],
            "host": [
              "tx-creditcard",
              "danalpay",
              "com"
            ],
            "query": [
              {
                "key": "CPID",
                "value": "A010037544"
              },
              {
                "key": "DATA",
                "value": "8kvDIwvdID7NWcBMND4uDTxEYY88YXtfM3g9P7zqCug6xdyr%2B4EGFtgpLmppE3fggETSMiebJvct2k9vrO0pxvIV4Syl6jBhNbENvjz%2B6Hf4CI6B6RPt2aL%2B7AhAcUVR"
              }
            ],
            "variable": []
          },
          "header": [
            {
              "key": "User-Agent",
              "value": "PostmanRuntime/7.39.1",
              "system": true
            },
            {
              "key": "Accept",
              "value": "*/*",
              "system": true
            },
            {
              "key": "Cache-Control",
              "value": "no-cache",
              "system": true
            },
            {
              "key": "Postman-Token",
              "value": "eb4ca690-c8ca-4fbf-8fef-fba881b3eaaa",
              "system": true
            },
            {
              "key": "Host",
              "value": "tx-creditcard.danalpay.com",
              "system": true
            },
            {
              "key": "Accept-Encoding",
              "value": "gzip, deflate, br",
              "system": true
            },
            {
              "key": "Connection",
              "value": "keep-alive",
              "system": true
            },
            {
              "key": "Cookie",
              "value": "SCOUTER=z6v5huk1n1ev29",
              "system": true
            },
            {
              "key": "Content-Length",
              "value": "0",
              "system": true
            }
          ],
          "method": "POST"
        },
        "response": {
          "id": "be3ad73b-13fe-4efc-9b84-561e7e0ee5f8",
          "status": "OK",
          "code": 200,
          "header": [
            {
              "key": "Content-Type",
              "value": "text/plain;charset=EUC-KR"
            },
            {
              "key": "Content-Length",
              "value": "253"
            },
            {
              "key": "Date",
              "value": "Tue, 06 Jan 2026 15:00:31 GMT"
            },
            {
              "key": "Server",
              "value": "blank"
            }
          ],
          "stream": {
            "type": "Buffer",
            "data": [
              68,
              65,
              84,
              65,
              61,
              98,
              72,
              54,
              69,
              108,
              53,
              101,
              108,
              79,
              78,
              53,
              56,
              56,
              51,
              76,
              66,
              51,
              82,
              108,
              102,
              70,
              49,
              79,
              70,
              49,
              72,
              56,
              101,
              90,
              84,
              88,
              118,
              52,
              57,
              119,
              88,
              76,
              56,
              37,
              50,
              70,
              65,
              86,
              101,
              86,
              122,
              104,
              72,
              85,
              53,
              115,
              100,
              101,
              115,
              52,
              48,
              103,
              114,
              118,
              75,
              109,
              122,
              105,
              37,
              50,
              66,
              114,
              88,
              112,
              69,
              99,
              109,
              104,
              55,
              106,
              76,
              56,
              116,
              118,
              81,
              56,
              121,
              77,
              75,
              108,
              105,
              102,
              109,
              112,
              48,
              107,
              112,
              72,
              54,
              51,
              80,
              98,
              73,
              67,
              106,
              70,
              111,
              37,
              50,
              66,
              106,
              98,
              69,
              65,
              83,
              83,
              109,
              86,
              75,
              65,
              69,
              89,
              67,
              89,
              86,
              67,
              106,
              50,
              98,
              48,
              57,
              50,
              107,
              66,
              98,
              97,
              37,
              50,
              70,
              85,
              101,
              106,
              50,
              117,
              118,
              106,
              85,
              82,
              111,
              82,
              74,
              108,
              109,
              101,
              79,
              104,
              66,
              122,
              49,
              49,
              49,
              113,
              72,
              74,
              110,
              111,
              87,
              73,
              83,
              84,
              117,
              113,
              68,
              52,
              55,
              84,
              82,
              104,
              101,
              114,
              111,
              111,
              89,
              52,
              89,
              75,
              72,
              54,
              49,
              100,
              106,
              99,
              76,
              87,
              105,
              80,
              86,
              83,
              101,
              81,
              112,
              108,
              85,
              87,
              37,
              50,
              66,
              107,
              104,
              99,
              101,
              82,
              71,
              119,
              90,
              103,
              77,
              113,
              120,
              52,
              81,
              100,
              83,
              100,
              53,
              90,
              82,
              66,
              80,
              80,
              112,
              72,
              97,
              73,
              52,
              76,
              115,
              98,
              115,
              75,
              118,
              105,
              87,
              105,
              80,
              90,
              86,
              77,
              105,
              99,
              37,
              51,
              68
            ]
          },
          "cookie": [],
          "responseTime": 1309,
          "responseSize": 253
        },
        "id": "b79d88db-0555-4498-8e15-ae9734d61623",
        "assertions": [
          {
            "assertion": "결과코드(RETURNCODE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "결과메세지(RETURNMSG) 정상출력",
            "skipped": false
          },
          {
            "assertion": "취소 후 잔액(BALANCE) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 원 거래 키(O_TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "다날 거래 키(TID) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생시간(TRANTIME) 정상출력",
            "skipped": false
          },
          {
            "assertion": "승인 발생일자(TRANDATE)",
            "skipped": false
          },
          {
            "assertion": "승인 취소 금액(AMOUNT) 정상출력",
            "skipped": false
          },
          {
            "assertion": "컵 보증금(DEPOSIT_AMT) 정상출력",
            "skipped": false
          }
        ]
      }
    ],
    "transfers": {
      "responseTotal": 7759
    },
    "failures": [
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "결과코드(RETURNCODE) 정상출력",
          "message": "expected '3143' to deeply equal '0000'",
          "stack": "AssertionError: expected '3143' to deeply equal '0000'\n   at Object.eval sandbox-script.js:1:14)",
          "checksum": "39d7afe66119f8ed083fbf2591ba0453",
          "id": "ec04200c-5e21-48dc-a375-d5807f7aabd2",
          "timestamp": 1767711620856,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "3307c1c8-6296-4f04-883e-62107464c402",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
              }
            }
          ]
        },
        "parent": {
          "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
          "name": "우리BC카드",
          "item": [
            {
              "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "3307c1c8-6296-4f04-883e-62107464c402",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                  }
                }
              ]
            },
            {
              "id": "149a4441-c945-45a3-a539-b046aa7e9949",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "38c309ac-3584-41c9-a6ee-fb246bdaae7d",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "697eba32-c6e4-4f61-aaf8-ba165ccca513",
          "scriptId": "3307c1c8-6296-4f04-883e-62107464c402",
          "execution": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 1,
          "test": "결과메세지(RETURNMSG) 정상출력",
          "message": "expected '%C4%AB%B5%E5%BB%E7+%B9%AE%C0%C7+%B9%D…' to deeply equal '%BC%BA%B0%F8'",
          "stack": "AssertionError: expected '%C4%AB%B5%E5%BB%E7+%B9%AE%C0%C7+%B9%D…' to deeply equal '%BC%BA%B0%F8'\n   at Object.eval sandbox-script.js:2:14)",
          "checksum": "a36d8cf3892c4f95c75241ad9161cdf5",
          "id": "c4443e3b-cb71-4d8b-a24f-43c859274a3e",
          "timestamp": 1767711620858,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 2,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:1 in test-script",
        "source": {
          "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "3307c1c8-6296-4f04-883e-62107464c402",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
              }
            }
          ]
        },
        "parent": {
          "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
          "name": "우리BC카드",
          "item": [
            {
              "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "3307c1c8-6296-4f04-883e-62107464c402",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                  }
                }
              ]
            },
            {
              "id": "149a4441-c945-45a3-a539-b046aa7e9949",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "38c309ac-3584-41c9-a6ee-fb246bdaae7d",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "697eba32-c6e4-4f61-aaf8-ba165ccca513",
          "scriptId": "3307c1c8-6296-4f04-883e-62107464c402",
          "execution": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 2,
          "test": "카드사 코드(CARDCODE 정상출력",
          "message": "expected undefined to deeply equal '0202'",
          "stack": "AssertionError: expected undefined to deeply equal '0202'\n   at Object.eval sandbox-script.js:3:14)",
          "checksum": "04102c5be7218d63ffd754d54018692e",
          "id": "126bc871-d652-4d7c-b89f-2443f27e5818",
          "timestamp": 1767711620859,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 3,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:2 in test-script",
        "source": {
          "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "3307c1c8-6296-4f04-883e-62107464c402",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
              }
            }
          ]
        },
        "parent": {
          "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
          "name": "우리BC카드",
          "item": [
            {
              "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "3307c1c8-6296-4f04-883e-62107464c402",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                  }
                }
              ]
            },
            {
              "id": "149a4441-c945-45a3-a539-b046aa7e9949",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "38c309ac-3584-41c9-a6ee-fb246bdaae7d",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "697eba32-c6e4-4f61-aaf8-ba165ccca513",
          "scriptId": "3307c1c8-6296-4f04-883e-62107464c402",
          "execution": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 3,
          "test": "구매자 전화번호(USERPHONE) 빈값 확인",
          "message": ".empty was passed non-string primitive undefined",
          "stack": "AssertionError: .empty was passed non-string primitive undefined\n   at Object.eval sandbox-script.js:4:14)",
          "checksum": "8afb764eee0fab671b701fb5419df6b2",
          "id": "29c39124-6e6b-48d0-ad45-069a4610b7ba",
          "timestamp": 1767711620859,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 4,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:3 in test-script",
        "source": {
          "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "3307c1c8-6296-4f04-883e-62107464c402",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
              }
            }
          ]
        },
        "parent": {
          "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
          "name": "우리BC카드",
          "item": [
            {
              "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "3307c1c8-6296-4f04-883e-62107464c402",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                  }
                }
              ]
            },
            {
              "id": "149a4441-c945-45a3-a539-b046aa7e9949",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "38c309ac-3584-41c9-a6ee-fb246bdaae7d",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "697eba32-c6e4-4f61-aaf8-ba165ccca513",
          "scriptId": "3307c1c8-6296-4f04-883e-62107464c402",
          "execution": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 4,
          "test": "할부 개월 수(QUOTA) 정상출력",
          "message": "expected undefined to deeply equal '00'",
          "stack": "AssertionError: expected undefined to deeply equal '00'\n   at Object.eval sandbox-script.js:5:14)",
          "checksum": "0d5832df7e81d68dde75879e94d30847",
          "id": "fa3e0f39-16e3-46c2-a158-fddcc3650c07",
          "timestamp": 1767711620860,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 5,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:4 in test-script",
        "source": {
          "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "3307c1c8-6296-4f04-883e-62107464c402",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
              }
            }
          ]
        },
        "parent": {
          "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
          "name": "우리BC카드",
          "item": [
            {
              "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "3307c1c8-6296-4f04-883e-62107464c402",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                  }
                }
              ]
            },
            {
              "id": "149a4441-c945-45a3-a539-b046aa7e9949",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "38c309ac-3584-41c9-a6ee-fb246bdaae7d",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "697eba32-c6e4-4f61-aaf8-ba165ccca513",
          "scriptId": "3307c1c8-6296-4f04-883e-62107464c402",
          "execution": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
        }
      },
      {
        "error": {
          "name": "TypeError",
          "index": 5,
          "test": "매출 발생시간(TRANTIME) ±5초 이내 검증",
          "message": "Cannot read properties of undefined (reading 'slice')",
          "stack": "TypeError: Cannot read properties of undefined (reading 'slice')\n   at Object.eval sandbox-script.js:6:14)",
          "checksum": "eab3458fb8a7bd36b0e8ad6a235cc2bf",
          "id": "cd33b903-45bc-4ba9-93fa-844b9d424b92",
          "timestamp": 1767711620860,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 6,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:5 in test-script",
        "source": {
          "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "3307c1c8-6296-4f04-883e-62107464c402",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
              }
            }
          ]
        },
        "parent": {
          "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
          "name": "우리BC카드",
          "item": [
            {
              "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "3307c1c8-6296-4f04-883e-62107464c402",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                  }
                }
              ]
            },
            {
              "id": "149a4441-c945-45a3-a539-b046aa7e9949",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "38c309ac-3584-41c9-a6ee-fb246bdaae7d",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "697eba32-c6e4-4f61-aaf8-ba165ccca513",
          "scriptId": "3307c1c8-6296-4f04-883e-62107464c402",
          "execution": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 6,
          "test": "매출 발생일자(TRANDATE) 정상출력",
          "message": "expected undefined to deeply equal '20260107'",
          "stack": "AssertionError: expected undefined to deeply equal '20260107'\n   at Object.eval sandbox-script.js:7:14)",
          "checksum": "a168b862aacd6b6635b4dbf8498144e5",
          "id": "85ed0a29-fb5b-42bb-8bf1-305b83eed762",
          "timestamp": 1767711620861,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 7,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:6 in test-script",
        "source": {
          "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "3307c1c8-6296-4f04-883e-62107464c402",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
              }
            }
          ]
        },
        "parent": {
          "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
          "name": "우리BC카드",
          "item": [
            {
              "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "3307c1c8-6296-4f04-883e-62107464c402",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                  }
                }
              ]
            },
            {
              "id": "149a4441-c945-45a3-a539-b046aa7e9949",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "38c309ac-3584-41c9-a6ee-fb246bdaae7d",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "697eba32-c6e4-4f61-aaf8-ba165ccca513",
          "scriptId": "3307c1c8-6296-4f04-883e-62107464c402",
          "execution": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 7,
          "test": "승인금액(AMOUNT) 정상출력",
          "message": "expected undefined to deeply equal '301'",
          "stack": "AssertionError: expected undefined to deeply equal '301'\n   at Object.eval sandbox-script.js:8:14)",
          "checksum": "877b95a69b497c92ef65dd0726b13142",
          "id": "e85d6d24-18a7-437d-a0f6-3625b2d0388d",
          "timestamp": 1767711620861,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 8,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:7 in test-script",
        "source": {
          "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "3307c1c8-6296-4f04-883e-62107464c402",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
              }
            }
          ]
        },
        "parent": {
          "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
          "name": "우리BC카드",
          "item": [
            {
              "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "3307c1c8-6296-4f04-883e-62107464c402",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                  }
                }
              ]
            },
            {
              "id": "149a4441-c945-45a3-a539-b046aa7e9949",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "38c309ac-3584-41c9-a6ee-fb246bdaae7d",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "697eba32-c6e4-4f61-aaf8-ba165ccca513",
          "scriptId": "3307c1c8-6296-4f04-883e-62107464c402",
          "execution": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 8,
          "test": "상품명(ITEMNAME) 정상출력",
          "message": "expected undefined to deeply equal 'apiautotest'",
          "stack": "AssertionError: expected undefined to deeply equal 'apiautotest'\n   at Object.eval sandbox-script.js:9:14)",
          "checksum": "9ece39081e0b87f92735355a3832bc7e",
          "id": "1fd48b35-fe44-4871-8dc3-83111acd063d",
          "timestamp": 1767711620862,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 9,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:8 in test-script",
        "source": {
          "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "3307c1c8-6296-4f04-883e-62107464c402",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
              }
            }
          ]
        },
        "parent": {
          "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
          "name": "우리BC카드",
          "item": [
            {
              "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "3307c1c8-6296-4f04-883e-62107464c402",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                  }
                }
              ]
            },
            {
              "id": "149a4441-c945-45a3-a539-b046aa7e9949",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "38c309ac-3584-41c9-a6ee-fb246bdaae7d",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "697eba32-c6e4-4f61-aaf8-ba165ccca513",
          "scriptId": "3307c1c8-6296-4f04-883e-62107464c402",
          "execution": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 9,
          "test": "보증금 금액(DEPOSIT_AMT) 정상출력",
          "message": "expected undefined to deeply equal '0'",
          "stack": "AssertionError: expected undefined to deeply equal '0'\n   at Object.eval sandbox-script.js:10:14)",
          "checksum": "bc7bd473f6a845d01599f30172e34f19",
          "id": "1945726a-df9a-4f34-8f0e-cd8fd887180d",
          "timestamp": 1767711620862,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 10,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:9 in test-script",
        "source": {
          "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "3307c1c8-6296-4f04-883e-62107464c402",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
              }
            }
          ]
        },
        "parent": {
          "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
          "name": "우리BC카드",
          "item": [
            {
              "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "3307c1c8-6296-4f04-883e-62107464c402",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                  }
                }
              ]
            },
            {
              "id": "149a4441-c945-45a3-a539-b046aa7e9949",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "38c309ac-3584-41c9-a6ee-fb246bdaae7d",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "697eba32-c6e4-4f61-aaf8-ba165ccca513",
          "scriptId": "3307c1c8-6296-4f04-883e-62107464c402",
          "execution": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 11,
          "test": "가맹점 주문번호(ORDERID) 빈값 확인",
          "message": ".empty was passed non-string primitive undefined",
          "stack": "AssertionError: .empty was passed non-string primitive undefined\n   at Object.eval sandbox-script.js:12:14)",
          "checksum": "f6865c7f4c66c938f654c12653b00629",
          "id": "0eefd2a6-a9e4-47a2-a1f8-a6742db33e84",
          "timestamp": 1767711620863,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 12,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:11 in test-script",
        "source": {
          "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "3307c1c8-6296-4f04-883e-62107464c402",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
              }
            }
          ]
        },
        "parent": {
          "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
          "name": "우리BC카드",
          "item": [
            {
              "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "3307c1c8-6296-4f04-883e-62107464c402",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                  }
                }
              ]
            },
            {
              "id": "149a4441-c945-45a3-a539-b046aa7e9949",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "38c309ac-3584-41c9-a6ee-fb246bdaae7d",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "697eba32-c6e4-4f61-aaf8-ba165ccca513",
          "scriptId": "3307c1c8-6296-4f04-883e-62107464c402",
          "execution": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 12,
          "test": "카드번호(CARDNO) 정상출력",
          "message": "expected undefined to deeply equal '538920******1226'",
          "stack": "AssertionError: expected undefined to deeply equal '538920******1226'\n   at Object.eval sandbox-script.js:13:14)",
          "checksum": "04cecf0816b1b458b1789beae6dd677e",
          "id": "a879e47e-1517-40f6-a321-13c3b92cfce5",
          "timestamp": 1767711620863,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 13,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:12 in test-script",
        "source": {
          "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "3307c1c8-6296-4f04-883e-62107464c402",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
              }
            }
          ]
        },
        "parent": {
          "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
          "name": "우리BC카드",
          "item": [
            {
              "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "3307c1c8-6296-4f04-883e-62107464c402",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                  }
                }
              ]
            },
            {
              "id": "149a4441-c945-45a3-a539-b046aa7e9949",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "38c309ac-3584-41c9-a6ee-fb246bdaae7d",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "697eba32-c6e4-4f61-aaf8-ba165ccca513",
          "scriptId": "3307c1c8-6296-4f04-883e-62107464c402",
          "execution": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 13,
          "test": "거래 승인 번호(CARDAUTHNO) 정상출력",
          "message": "expected undefined to exist",
          "stack": "AssertionError: expected undefined to exist\n   at Object.eval sandbox-script.js:14:14)",
          "checksum": "c2a3a9c58df7bedc9e1825e97f7a211a",
          "id": "51290e3a-b47d-48df-9842-0d5d14d7d440",
          "timestamp": 1767711620864,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 14,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:13 in test-script",
        "source": {
          "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "3307c1c8-6296-4f04-883e-62107464c402",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
              }
            }
          ]
        },
        "parent": {
          "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
          "name": "우리BC카드",
          "item": [
            {
              "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "3307c1c8-6296-4f04-883e-62107464c402",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                  }
                }
              ]
            },
            {
              "id": "149a4441-c945-45a3-a539-b046aa7e9949",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "38c309ac-3584-41c9-a6ee-fb246bdaae7d",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "697eba32-c6e4-4f61-aaf8-ba165ccca513",
          "scriptId": "3307c1c8-6296-4f04-883e-62107464c402",
          "execution": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 14,
          "test": "카드사 명(CARDNAME) 정상출력",
          "message": "expected undefined to deeply equal '%BF%EC%B8%AEBC%C4%AB%B5%E5'",
          "stack": "AssertionError: expected undefined to deeply equal '%BF%EC%B8%AEBC%C4%AB%B5%E5'\n   at Object.eval sandbox-script.js:15:14)",
          "checksum": "94eb2f7a44f776a27ca4e055ce9af35e",
          "id": "882461d5-3784-4bdb-be65-f99ef7d2a205",
          "timestamp": 1767711620864,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 15,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:14 in test-script",
        "source": {
          "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "3307c1c8-6296-4f04-883e-62107464c402",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
              }
            }
          ]
        },
        "parent": {
          "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
          "name": "우리BC카드",
          "item": [
            {
              "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "3307c1c8-6296-4f04-883e-62107464c402",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                  }
                }
              ]
            },
            {
              "id": "149a4441-c945-45a3-a539-b046aa7e9949",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "38c309ac-3584-41c9-a6ee-fb246bdaae7d",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "697eba32-c6e4-4f61-aaf8-ba165ccca513",
          "scriptId": "3307c1c8-6296-4f04-883e-62107464c402",
          "execution": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 15,
          "test": "구매자 이름(USERNAME) 정상출력",
          "message": ".empty was passed non-string primitive undefined",
          "stack": "AssertionError: .empty was passed non-string primitive undefined\n   at Object.eval sandbox-script.js:16:14)",
          "checksum": "797b6dc46f383bcc5df0d5571c825572",
          "id": "7328a6e1-9c01-44ee-b62e-3951b6a8c412",
          "timestamp": 1767711620864,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 16,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:15 in test-script",
        "source": {
          "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "3307c1c8-6296-4f04-883e-62107464c402",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
              }
            }
          ]
        },
        "parent": {
          "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
          "name": "우리BC카드",
          "item": [
            {
              "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "3307c1c8-6296-4f04-883e-62107464c402",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                  }
                }
              ]
            },
            {
              "id": "149a4441-c945-45a3-a539-b046aa7e9949",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "38c309ac-3584-41c9-a6ee-fb246bdaae7d",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "697eba32-c6e4-4f61-aaf8-ba165ccca513",
          "scriptId": "3307c1c8-6296-4f04-883e-62107464c402",
          "execution": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 16,
          "test": "구매자 ID(USERID) 정상출력",
          "message": "expected undefined to deeply equal 'hnkim'",
          "stack": "AssertionError: expected undefined to deeply equal 'hnkim'\n   at Object.eval sandbox-script.js:17:14)",
          "checksum": "71be15b35b8aec1a5bf066b1bdc994b4",
          "id": "60f3bf60-89b1-4155-9e90-cf0e7b04b0e4",
          "timestamp": 1767711620865,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 17,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 14,
              "native": false
            }
          ]
        },
        "at": "assertion:16 in test-script",
        "source": {
          "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
          "name": "정기결제 요청 (OTBILL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    ITEMNAME: 'apiautotest',\r",
                  "    AMOUNT: '301',\r",
                  "    CURRENCY: '410',\r",
                  "    USERID: 'hnkim',\r",
                  "    USERAGENT: 'ONLINE',\r",
                  "    TXTYPE: 'OTBILL',\r",
                  "    SERVICETYPE: 'BATCH',\r",
                  "    ISREBILL: 'Y',\r",
                  "    BILLINFO: 'DC25080416595836B04B'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "3307c1c8-6296-4f04-883e-62107464c402",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                  "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                  "  // 현재 시간 선언\r",
                  "  const now = new Date();\r",
                  "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                  "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                  "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                  "  const t = parsed.TRANTIME;\r",
                  "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                  "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                  "\r",
                  "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                  "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TRANTIME 저장\r",
                  "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "});\r",
                  "\r",
                  "// Environments에 TID 저장\r",
                  "pm.environment.set(\"TID\", parsed.TID);\r",
                  "\r",
                  "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                  "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                  "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                  "});\r",
                  "\r",
                  "// \"삼성카드\" 검증\r",
                  "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                  "});"
                ],
                "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
              }
            }
          ]
        },
        "parent": {
          "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
          "name": "우리BC카드",
          "item": [
            {
              "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "3307c1c8-6296-4f04-883e-62107464c402",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                  }
                }
              ]
            },
            {
              "id": "149a4441-c945-45a3-a539-b046aa7e9949",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "38c309ac-3584-41c9-a6ee-fb246bdaae7d",
          "length": 21,
          "cycles": 1,
          "position": 13,
          "iteration": 0,
          "httpRequestId": "697eba32-c6e4-4f61-aaf8-ba165ccca513",
          "scriptId": "3307c1c8-6296-4f04-883e-62107464c402",
          "execution": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 0,
          "test": "결과코드(RETURNCODE) 정상출력",
          "message": "expected '1117' to deeply equal '0000'",
          "stack": "AssertionError: expected '1117' to deeply equal '0000'\n   at Object.eval sandbox-script.js:1:15)",
          "checksum": "a012cd453405486f5cf198bfc2cfb6c5",
          "id": "10d58477-1095-42e1-844a-d97cd7346678",
          "timestamp": 1767711621210,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 1,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 15,
              "native": false
            }
          ]
        },
        "at": "assertion:0 in test-script",
        "source": {
          "id": "149a4441-c945-45a3-a539-b046aa7e9949",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
              }
            }
          ]
        },
        "parent": {
          "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
          "name": "우리BC카드",
          "item": [
            {
              "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "3307c1c8-6296-4f04-883e-62107464c402",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                  }
                }
              ]
            },
            {
              "id": "149a4441-c945-45a3-a539-b046aa7e9949",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "6f4f0024-6883-45b7-b35d-3ccc1f9f415a",
          "length": 21,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "e9811c6d-e498-4da4-8f2d-e4994b5fe595",
          "scriptId": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
          "execution": "ca7fd499-1345-4931-929d-e6ab2f61218a"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 1,
          "test": "결과메세지(RETURNMSG) 정상출력",
          "message": "expected '%BF%F8%B0%C5%B7%A1%B0%C7%C0%CC+%C1%B8…' to deeply equal '%BC%BA%B0%F8'",
          "stack": "AssertionError: expected '%BF%F8%B0%C5%B7%A1%B0%C7%C0%CC+%C1%B8…' to deeply equal '%BC%BA%B0%F8'\n   at Object.eval sandbox-script.js:2:15)",
          "checksum": "822742ddbd77cbe388c5892b46b77dc1",
          "id": "8d045790-af34-45f7-ae4a-f156a0d081a6",
          "timestamp": 1767711621211,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 2,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 15,
              "native": false
            }
          ]
        },
        "at": "assertion:1 in test-script",
        "source": {
          "id": "149a4441-c945-45a3-a539-b046aa7e9949",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
              }
            }
          ]
        },
        "parent": {
          "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
          "name": "우리BC카드",
          "item": [
            {
              "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "3307c1c8-6296-4f04-883e-62107464c402",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                  }
                }
              ]
            },
            {
              "id": "149a4441-c945-45a3-a539-b046aa7e9949",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "6f4f0024-6883-45b7-b35d-3ccc1f9f415a",
          "length": 21,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "e9811c6d-e498-4da4-8f2d-e4994b5fe595",
          "scriptId": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
          "execution": "ca7fd499-1345-4931-929d-e6ab2f61218a"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 2,
          "test": "취소 후 잔액(BALANCE) 정상출력",
          "message": "expected undefined to deeply equal '0'",
          "stack": "AssertionError: expected undefined to deeply equal '0'\n   at Object.eval sandbox-script.js:3:15)",
          "checksum": "4272e1f2e202d0f1893e80c0756de9b8",
          "id": "8c43786d-4a45-4a4c-893d-56cb0c6ad830",
          "timestamp": 1767711621211,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 3,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 15,
              "native": false
            }
          ]
        },
        "at": "assertion:2 in test-script",
        "source": {
          "id": "149a4441-c945-45a3-a539-b046aa7e9949",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
              }
            }
          ]
        },
        "parent": {
          "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
          "name": "우리BC카드",
          "item": [
            {
              "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "3307c1c8-6296-4f04-883e-62107464c402",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                  }
                }
              ]
            },
            {
              "id": "149a4441-c945-45a3-a539-b046aa7e9949",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "6f4f0024-6883-45b7-b35d-3ccc1f9f415a",
          "length": 21,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "e9811c6d-e498-4da4-8f2d-e4994b5fe595",
          "scriptId": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
          "execution": "ca7fd499-1345-4931-929d-e6ab2f61218a"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 3,
          "test": "다날 원 거래 키(O_TID) 정상출력",
          "message": "expected undefined not to be undefined",
          "stack": "AssertionError: expected undefined not to be undefined\n   at Object.eval sandbox-script.js:4:15)",
          "checksum": "863cc620ecbc06ed16663112ac5f0bbd",
          "id": "0cdfa985-402d-4740-b54e-7c0f15c02534",
          "timestamp": 1767711621212,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 4,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 15,
              "native": false
            }
          ]
        },
        "at": "assertion:3 in test-script",
        "source": {
          "id": "149a4441-c945-45a3-a539-b046aa7e9949",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
              }
            }
          ]
        },
        "parent": {
          "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
          "name": "우리BC카드",
          "item": [
            {
              "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "3307c1c8-6296-4f04-883e-62107464c402",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                  }
                }
              ]
            },
            {
              "id": "149a4441-c945-45a3-a539-b046aa7e9949",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "6f4f0024-6883-45b7-b35d-3ccc1f9f415a",
          "length": 21,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "e9811c6d-e498-4da4-8f2d-e4994b5fe595",
          "scriptId": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
          "execution": "ca7fd499-1345-4931-929d-e6ab2f61218a"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 4,
          "test": "다날 거래 키(TID) 정상출력",
          "message": "expected undefined not to be undefined",
          "stack": "AssertionError: expected undefined not to be undefined\n   at Object.eval sandbox-script.js:5:15)",
          "checksum": "5865b485226e028e46a31c468d40a4df",
          "id": "669ff424-7290-4218-bd82-5b9bf6acb7eb",
          "timestamp": 1767711621212,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 5,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 15,
              "native": false
            }
          ]
        },
        "at": "assertion:4 in test-script",
        "source": {
          "id": "149a4441-c945-45a3-a539-b046aa7e9949",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
              }
            }
          ]
        },
        "parent": {
          "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
          "name": "우리BC카드",
          "item": [
            {
              "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "3307c1c8-6296-4f04-883e-62107464c402",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                  }
                }
              ]
            },
            {
              "id": "149a4441-c945-45a3-a539-b046aa7e9949",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "6f4f0024-6883-45b7-b35d-3ccc1f9f415a",
          "length": 21,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "e9811c6d-e498-4da4-8f2d-e4994b5fe595",
          "scriptId": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
          "execution": "ca7fd499-1345-4931-929d-e6ab2f61218a"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 5,
          "test": "승인 발생시간(TRANTIME) 정상출력",
          "message": "expected undefined to deeply equal null",
          "stack": "AssertionError: expected undefined to deeply equal null\n   at Object.eval sandbox-script.js:6:15)",
          "checksum": "f1c8f2be7f2b2372b4eaf8e5af1690a0",
          "id": "4883aeb4-b601-4908-9828-aaa6d79abe43",
          "timestamp": 1767711621212,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 6,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 15,
              "native": false
            }
          ]
        },
        "at": "assertion:5 in test-script",
        "source": {
          "id": "149a4441-c945-45a3-a539-b046aa7e9949",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
              }
            }
          ]
        },
        "parent": {
          "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
          "name": "우리BC카드",
          "item": [
            {
              "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "3307c1c8-6296-4f04-883e-62107464c402",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                  }
                }
              ]
            },
            {
              "id": "149a4441-c945-45a3-a539-b046aa7e9949",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "6f4f0024-6883-45b7-b35d-3ccc1f9f415a",
          "length": 21,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "e9811c6d-e498-4da4-8f2d-e4994b5fe595",
          "scriptId": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
          "execution": "ca7fd499-1345-4931-929d-e6ab2f61218a"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 6,
          "test": "승인 발생일자(TRANDATE)",
          "message": "expected undefined to deeply equal '20260107'",
          "stack": "AssertionError: expected undefined to deeply equal '20260107'\n   at Object.eval sandbox-script.js:7:15)",
          "checksum": "9743480fbf386dfe12658b090a2c8b7f",
          "id": "4b3e7816-2e66-463a-9982-296b25342045",
          "timestamp": 1767711621213,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 7,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 15,
              "native": false
            }
          ]
        },
        "at": "assertion:6 in test-script",
        "source": {
          "id": "149a4441-c945-45a3-a539-b046aa7e9949",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
              }
            }
          ]
        },
        "parent": {
          "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
          "name": "우리BC카드",
          "item": [
            {
              "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "3307c1c8-6296-4f04-883e-62107464c402",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                  }
                }
              ]
            },
            {
              "id": "149a4441-c945-45a3-a539-b046aa7e9949",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "6f4f0024-6883-45b7-b35d-3ccc1f9f415a",
          "length": 21,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "e9811c6d-e498-4da4-8f2d-e4994b5fe595",
          "scriptId": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
          "execution": "ca7fd499-1345-4931-929d-e6ab2f61218a"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 7,
          "test": "승인 취소 금액(AMOUNT) 정상출력",
          "message": "expected undefined to deeply equal '301'",
          "stack": "AssertionError: expected undefined to deeply equal '301'\n   at Object.eval sandbox-script.js:8:15)",
          "checksum": "125a393a7dac12722dc3072ef4839e5a",
          "id": "2836cff3-cb1d-4008-8a29-cdc2d797e8e6",
          "timestamp": 1767711621213,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 8,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 15,
              "native": false
            }
          ]
        },
        "at": "assertion:7 in test-script",
        "source": {
          "id": "149a4441-c945-45a3-a539-b046aa7e9949",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
              }
            }
          ]
        },
        "parent": {
          "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
          "name": "우리BC카드",
          "item": [
            {
              "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "3307c1c8-6296-4f04-883e-62107464c402",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                  }
                }
              ]
            },
            {
              "id": "149a4441-c945-45a3-a539-b046aa7e9949",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "6f4f0024-6883-45b7-b35d-3ccc1f9f415a",
          "length": 21,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "e9811c6d-e498-4da4-8f2d-e4994b5fe595",
          "scriptId": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
          "execution": "ca7fd499-1345-4931-929d-e6ab2f61218a"
        }
      },
      {
        "error": {
          "name": "AssertionError",
          "index": 8,
          "test": "컵 보증금(DEPOSIT_AMT) 정상출력",
          "message": "expected undefined to deeply equal '0'",
          "stack": "AssertionError: expected undefined to deeply equal '0'\n   at Object.eval sandbox-script.js:9:15)",
          "checksum": "bb01c28131fc1efd90a0a0f322fda70a",
          "id": "f9d6b9dc-3207-4acd-af96-2dd2d06a6fd6",
          "timestamp": 1767711621214,
          "stacktrace": [
            {
              "fileName": "sandbox-script.js",
              "lineNumber": 9,
              "functionName": "Object.eval",
              "typeName": "Object",
              "methodName": "eval",
              "columnNumber": 15,
              "native": false
            }
          ]
        },
        "at": "assertion:8 in test-script",
        "source": {
          "id": "149a4441-c945-45a3-a539-b046aa7e9949",
          "name": "카드 승인 취소 (BILLCANCEL)",
          "request": {
            "url": {
              "host": [
                "{{tx-credit}}"
              ],
              "query": [
                {
                  "key": "CPID",
                  "value": "A010037544"
                },
                {
                  "key": "DATA",
                  "value": "{{encryptedData}}"
                }
              ],
              "variable": []
            },
            "method": "POST"
          },
          "response": [],
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// 암호화 대상 데이터 (CPID 제외)\r",
                  "let params = {\r",
                  "    AMOUNT: '301',\r",
                  "    TID: pm.environment.get(\"TID\"),\r",
                  "    CANCELTYPE: 'C',\r",
                  "    TXTYPE: 'CANCEL',\r",
                  "    SERVICETYPE: 'DANALCARD'\r",
                  "};\r",
                  "\r",
                  "// Step 1: URL 인코딩 (key 제외, value만)\r",
                  "let encodedParams = [];\r",
                  "for (let key in params) {\r",
                  "    let value = encodeURIComponent(params[key]);\r",
                  "    encodedParams.push(`${key}=${value}`);\r",
                  "}\r",
                  "\r",
                  "// Step 2: QueryString 구성\r",
                  "let queryString = encodedParams.join('&');\r",
                  "\r",
                  "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                  "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 4: Base64 → URLEncoded\r",
                  "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                  "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                  "\r",
                  "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                  "pm.environment.set(\"encryptedData\", finalEncoded);"
                ],
                "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
              }
            },
            {
              "listen": "test",
              "script": {
                "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                "type": "text/javascript",
                "packages": {},
                "exec": [
                  "// Step 1: 응답을 텍스트로 가져옴\r",
                  "let rawText = pm.response.text();\r",
                  "\r",
                  "// Step 2: DATA= 뒤의 암호문만 추출\r",
                  "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                  "\r",
                  "// Step 3: URI 디코딩\r",
                  "let base64Cipher = decodeURIComponent(encryptedData);\r",
                  "\r",
                  "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                  "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                  "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                  "\r",
                  "// Step 5: AES 복호화\r",
                  "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                  "    iv: iv,\r",
                  "    mode: CryptoJS.mode.CBC,\r",
                  "    padding: CryptoJS.pad.Pkcs7\r",
                  "});\r",
                  "\r",
                  "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                  "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                  "console.log(\"복호화 결과 : \", result);\r",
                  "\r",
                  "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                  "pm.environment.set(\"decryptedResponse\", result);\r",
                  "\r",
                  "\r",
                  "/********************     Assertion     **********************/\r",
                  "\r",
                  "// Key-Value 파싱 함수\r",
                  "function parseQueryString(str) {\r",
                  "    return str.split(\"&\").reduce((acc, pair) => {\r",
                  "        const [key, value] = pair.split(\"=\");\r",
                  "        acc[key] = value || \"\";\r",
                  "        return acc;\r",
                  "    }, {});\r",
                  "}\r",
                  "\r",
                  "// 안전 디코딩 함수\r",
                  "function safeDecodeURIComponent(str) {\r",
                  "    try {\r",
                  "        return decodeURIComponent(str);\r",
                  "    } catch (e) {\r",
                  "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                  "        return str;\r",
                  "    }\r",
                  "}\r",
                  "\r",
                  "const parsed = parseQueryString(result);\r",
                  "\r",
                  "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                  "});\r",
                  "\r",
                  "// \"성공\" 검증\r",
                  "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                  "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                  "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                  "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                  "    pm.expect(parsed.TID).to.not.be.empty;\r",
                  "    pm.expect(parsed.TID).to.not.be.null;\r",
                  "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                  "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                  "});\r",
                  "\r",
                  "// 매출 발생시간과 비교 검증\r",
                  "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                  "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                  "});\r",
                  "\r",
                  "// 현재 날짜 구하기 (yyyyMMdd)\r",
                  "function getYYYYMMDD() {\r",
                  "  const today = new Date();\r",
                  "  const yyyy = today.getFullYear();\r",
                  "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                  "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                  "\r",
                  "  return `${yyyy}${mm}${dd}`;\r",
                  "}\r",
                  "\r",
                  "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                  "\r",
                  "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                  "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                  "});\r",
                  "\r",
                  "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                  "});\r",
                  "\r",
                  "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                  "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                  "});"
                ],
                "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
              }
            }
          ]
        },
        "parent": {
          "id": "8939461c-42ea-44ef-b6b0-6a93fc6afdf5",
          "name": "우리BC카드",
          "item": [
            {
              "id": "54300f57-1929-4e41-8e46-f135e57b4aef",
              "name": "정기결제 요청 (OTBILL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "4ebd3824-1c15-4eba-b810-65b70d40035a",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    ITEMNAME: 'apiautotest',\r",
                      "    AMOUNT: '301',\r",
                      "    CURRENCY: '410',\r",
                      "    USERID: 'hnkim',\r",
                      "    USERAGENT: 'ONLINE',\r",
                      "    TXTYPE: 'OTBILL',\r",
                      "    SERVICETYPE: 'BATCH',\r",
                      "    ISREBILL: 'Y',\r",
                      "    BILLINFO: 'DC25080416595836B04B'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "b7297939-08fc-41c7-8061-b8a55d85da76"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "3307c1c8-6296-4f04-883e-62107464c402",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드사 코드(CARDCODE 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDCODE).to.eql(\"0202\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 전화번호(USERPHONE) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.USERPHONE).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"할부 개월 수(QUOTA) 정상출력\", function () {\r",
                      "    pm.expect(parsed.QUOTA).to.eql(\"00\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"매출 발생시간(TRANTIME) ±5초 이내 검증\", function () {\r",
                      "  // 현재 시간 선언\r",
                      "  const now = new Date();\r",
                      "  // 현재 시각을 초(second) 단위로 변환 (HH*3600 + MM*60 + SS)\r",
                      "  const nowSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();\r",
                      "  // 응답으로 받은 거래 시간 (형식: HHmmss)\r",
                      "  const t = parsed.TRANTIME;\r",
                      "  // TRANTIME(HHmmss)을 초(second) 단위로 변환\r",
                      "  const tranSec = (+t.slice(0,2)) * 3600 + (+t.slice(2,4)) * 60 + (+t.slice(4,6));\r",
                      "\r",
                      "  // 현재 시각과 거래 시각의 차이가 5초 이내인지 검증\r",
                      "  pm.expect(Math.abs(nowSec - tranSec)).to.be.at.most(5);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TRANTIME 저장\r",
                      "pm.environment.set(\"TRANTIME\", parsed.TRANTIME);\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"매출 발생일자(TRANDATE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"상품명(ITEMNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.ITEMNAME).to.eql(\"apiautotest\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"보증금 금액(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "});\r",
                      "\r",
                      "// Environments에 TID 저장\r",
                      "pm.environment.set(\"TID\", parsed.TID);\r",
                      "\r",
                      "pm.test(\"가맹점 주문번호(ORDERID) 빈값 확인\", function () {\r",
                      "    pm.expect(parsed.ORDERID).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"카드번호(CARDNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNO).to.eql(\"538920******1226\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"거래 승인 번호(CARDAUTHNO) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.exist;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.not.be.empty;\r",
                      "    pm.expect(parsed.CARDAUTHNO).to.match(/^\\d{8}$/);\r",
                      "});\r",
                      "\r",
                      "// \"삼성카드\" 검증\r",
                      "pm.test(\"카드사 명(CARDNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.CARDNAME).to.eql(\"%BF%EC%B8%AEBC%C4%AB%B5%E5\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 이름(USERNAME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERNAME).to.be.empty;\r",
                      "});\r",
                      "\r",
                      "pm.test(\"구매자 ID(USERID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.USERID).to.eql(\"hnkim\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "f2f884e9-2485-4b39-a99b-de9faa410bd5"
                  }
                }
              ]
            },
            {
              "id": "149a4441-c945-45a3-a539-b046aa7e9949",
              "name": "카드 승인 취소 (BILLCANCEL)",
              "request": {
                "url": {
                  "host": [
                    "{{tx-credit}}"
                  ],
                  "query": [
                    {
                      "key": "CPID",
                      "value": "A010037544"
                    },
                    {
                      "key": "DATA",
                      "value": "{{encryptedData}}"
                    }
                  ],
                  "variable": []
                },
                "method": "POST"
              },
              "response": [],
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "id": "1f16329d-f9ad-4e36-849c-8fe7b1176a9f",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// 암호화 대상 데이터 (CPID 제외)\r",
                      "let params = {\r",
                      "    AMOUNT: '301',\r",
                      "    TID: pm.environment.get(\"TID\"),\r",
                      "    CANCELTYPE: 'C',\r",
                      "    TXTYPE: 'CANCEL',\r",
                      "    SERVICETYPE: 'DANALCARD'\r",
                      "};\r",
                      "\r",
                      "// Step 1: URL 인코딩 (key 제외, value만)\r",
                      "let encodedParams = [];\r",
                      "for (let key in params) {\r",
                      "    let value = encodeURIComponent(params[key]);\r",
                      "    encodedParams.push(`${key}=${value}`);\r",
                      "}\r",
                      "\r",
                      "// Step 2: QueryString 구성\r",
                      "let queryString = encodedParams.join('&');\r",
                      "\r",
                      "// Step 3: AES256 암호화 (CBC + PKCS7)\r",
                      "let encrypted = CryptoJS.AES.encrypt(queryString, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 4: Base64 → URLEncoded\r",
                      "const base64Cipher = encrypted.ciphertext.toString(CryptoJS.enc.Base64);\r",
                      "const finalEncoded = encodeURIComponent(base64Cipher);\r",
                      "\r",
                      "// Step 5: 암호화된 데이터 환경 변수 저장\r",
                      "pm.environment.set(\"encryptedData\", finalEncoded);"
                    ],
                    "_lastExecutionId": "6f01f8d2-d255-4ada-b286-9c714ec40197"
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "id": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
                    "type": "text/javascript",
                    "packages": {},
                    "exec": [
                      "// Step 1: 응답을 텍스트로 가져옴\r",
                      "let rawText = pm.response.text();\r",
                      "\r",
                      "// Step 2: DATA= 뒤의 암호문만 추출\r",
                      "let encryptedData = rawText.split(\"DATA=\")[1];\r",
                      "\r",
                      "// Step 3: URI 디코딩\r",
                      "let base64Cipher = decodeURIComponent(encryptedData);\r",
                      "\r",
                      "// Step 4: 복호화 Key / IV 설정 (Hex 형태 사용!)\r",
                      "const key = CryptoJS.enc.Hex.parse(\"20ad459ab1ad2f6e541929d50d24765abb05850094a9629041bebb726814625d\");\r",
                      "const iv = CryptoJS.enc.Hex.parse(\"d7d02c92cb930b661f107cb92690fc83\");\r",
                      "\r",
                      "// Step 5: AES 복호화\r",
                      "let decrypted = CryptoJS.AES.decrypt(base64Cipher, key, {\r",
                      "    iv: iv,\r",
                      "    mode: CryptoJS.mode.CBC,\r",
                      "    padding: CryptoJS.pad.Pkcs7\r",
                      "});\r",
                      "\r",
                      "// Step 6: 결과를 UTF-8 문자열로 변환\r",
                      "let result = decrypted.toString(CryptoJS.enc.Utf8);\r",
                      "console.log(\"복호화 결과 : \", result);\r",
                      "\r",
                      "// Step 7: 복호화된 데이터 환경 변수에 저장\r",
                      "pm.environment.set(\"decryptedResponse\", result);\r",
                      "\r",
                      "\r",
                      "/********************     Assertion     **********************/\r",
                      "\r",
                      "// Key-Value 파싱 함수\r",
                      "function parseQueryString(str) {\r",
                      "    return str.split(\"&\").reduce((acc, pair) => {\r",
                      "        const [key, value] = pair.split(\"=\");\r",
                      "        acc[key] = value || \"\";\r",
                      "        return acc;\r",
                      "    }, {});\r",
                      "}\r",
                      "\r",
                      "// 안전 디코딩 함수\r",
                      "function safeDecodeURIComponent(str) {\r",
                      "    try {\r",
                      "        return decodeURIComponent(str);\r",
                      "    } catch (e) {\r",
                      "        console.warn(\"decodeURIComponent 실패:\", e.message);\r",
                      "        return str;\r",
                      "    }\r",
                      "}\r",
                      "\r",
                      "const parsed = parseQueryString(result);\r",
                      "\r",
                      "pm.test(\"결과코드(RETURNCODE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNCODE).to.eql(\"0000\")\r",
                      "});\r",
                      "\r",
                      "// \"성공\" 검증\r",
                      "pm.test(\"결과메세지(RETURNMSG) 정상출력\", function () {\r",
                      "    pm.expect(parsed.RETURNMSG).to.eql(\"%BC%BA%B0%F8\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"취소 후 잔액(BALANCE) 정상출력\", function () {\r",
                      "    pm.expect(parsed.BALANCE).to.eql(\"0\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 원 거래 키(O_TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.O_TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.O_TID).to.not.be.null;\r",
                      "    pm.expect(parsed.O_TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.O_TID).to.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "pm.test(\"다날 거래 키(TID) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TID).to.not.be.undefined;\r",
                      "    pm.expect(parsed.TID).to.not.be.empty;\r",
                      "    pm.expect(parsed.TID).to.not.be.null;\r",
                      "    pm.expect(parsed.TID).to.have.lengthOf(24);\r",
                      "    pm.expect(parsed.TID).to.not.eql(pm.environment.get(\"TID\"))\r",
                      "});\r",
                      "\r",
                      "// 매출 발생시간과 비교 검증\r",
                      "pm.test(\"승인 발생시간(TRANTIME) 정상출력\", function () {\r",
                      "    pm.expect(parsed.TRANTIME).to.eql(pm.environment.get(\"TRANTIME\"))\r",
                      "});\r",
                      "\r",
                      "// 현재 날짜 구하기 (yyyyMMdd)\r",
                      "function getYYYYMMDD() {\r",
                      "  const today = new Date();\r",
                      "  const yyyy = today.getFullYear();\r",
                      "  const mm = String(today.getMonth() + 1).padStart(2, \"0\"); // 월은 0부터 시작하므로 1을 더하고 2자리로 만듦\r",
                      "  const dd = String(today.getDate()).padStart(2, \"0\");   // 2자리로 만듦\r",
                      "\r",
                      "  return `${yyyy}${mm}${dd}`;\r",
                      "}\r",
                      "\r",
                      "const formattedDate = getYYYYMMDD(); // 출력: 20230730 (예시) \r",
                      "\r",
                      "pm.test(\"승인 발생일자(TRANDATE)\", function () {\r",
                      "    pm.expect(parsed.TRANDATE).to.eql(formattedDate)\r",
                      "});\r",
                      "\r",
                      "pm.test(\"승인 취소 금액(AMOUNT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.AMOUNT).to.eql(\"301\")\r",
                      "});\r",
                      "\r",
                      "pm.test(\"컵 보증금(DEPOSIT_AMT) 정상출력\", function () {\r",
                      "    pm.expect(parsed.DEPOSIT_AMT).to.eql(\"0\")\r",
                      "});"
                    ],
                    "_lastExecutionId": "ca7fd499-1345-4931-929d-e6ab2f61218a"
                  }
                }
              ]
            }
          ],
          "event": []
        },
        "cursor": {
          "ref": "6f4f0024-6883-45b7-b35d-3ccc1f9f415a",
          "length": 21,
          "cycles": 1,
          "position": 14,
          "iteration": 0,
          "httpRequestId": "e9811c6d-e498-4da4-8f2d-e4994b5fe595",
          "scriptId": "19d008ab-aa07-48d3-b7a4-3efd5186c7d3",
          "execution": "ca7fd499-1345-4931-929d-e6ab2f61218a"
        }
      }
    ],
    "error": null
  }
}